!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CoveoHeadless={})}(this,(function(e){"use strict";function t(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function r(e){return!!e&&!!e[z]}function n(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[N]||!!e.constructor[N]||u(e)||l(e))}function i(e,t,r){void 0===r&&(r=!1),0===a(e)?(r?Object.keys:Q)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function a(e){var t=e[z];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:u(e)?2:l(e)?3:0}function o(e,t){return 2===a(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function s(e,t,r){var n=a(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function c(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function u(e){return D&&e instanceof Map}function l(e){return _&&e instanceof Set}function d(e){return e.o||e.t}function f(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=U(e);delete t[z];for(var r=Q(t),n=0;n<r.length;n++){var i=r[n],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function p(e,t){return void 0===t&&(t=!1),h(e)||r(e)||!n(e)||(a(e)>1&&(e.set=e.add=e.clear=e.delete=g),Object.freeze(e),t&&i(e,(function(e,t){return p(t,!0)}),!0)),e}function g(){t(2)}function h(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function y(e){var r=B[e];return r||t(18,e),r}function m(){return V}function v(e,t){t&&(y("Patches"),e.u=[],e.s=[],e.v=t)}function b(e){S(e),e.p.forEach(O),e.p=null}function S(e){e===V&&(V=e.l)}function w(e){return V={p:[],l:V,h:e,m:!0,_:0}}function O(e){var t=e[z];0===t.i||1===t.i?t.j():t.g=!0}function C(e,r){r._=r.p.length;var i=r.p[0],a=void 0!==e&&e!==i;return r.h.O||y("ES5").S(r,e,a),a?(i[z].P&&(b(r),t(4)),n(e)&&(e=q(r,e),r.l||x(r,e)),r.u&&y("Patches").M(i[z],e,r.u,r.s)):e=q(r,i,[]),b(r),r.u&&r.v(r.u,r.s),e!==L?e:void 0}function q(e,t,r){if(h(t))return t;var n=t[z];if(!n)return i(t,(function(i,a){return I(e,n,t,i,a,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return x(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var a=4===n.i||5===n.i?n.o=f(n.k):n.o;i(3===n.i?new Set(a):a,(function(t,i){return I(e,n,a,t,i,r)})),x(e,a,!1),r&&e.u&&y("Patches").R(n,r,e.u,e.s)}return n.o}function I(e,t,i,a,c,u){if(r(c)){var l=q(e,c,u&&t&&3!==t.i&&!o(t.D,a)?u.concat(a):void 0);if(s(i,a,l),!r(l))return;e.m=!1}if(n(c)&&!h(c)){if(!e.h.N&&e._<1)return;q(e,c),t&&t.A.l||x(e,c)}}function x(e,t,r){void 0===r&&(r=!1),e.h.N&&e.m&&p(t,r)}function R(e,t){var r=e[z];return(r?d(r):e)[t]}function A(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function E(e){e.P||(e.P=!0,e.l&&E(e.l))}function F(e){e.o||(e.o=f(e.t))}function j(e,t,r){var n=u(t)?y("MapSet").T(t,r):l(t)?y("MapSet").F(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:m(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,a=H;r&&(i=[n],a=Y);var o=Proxy.revocable(i,a),s=o.revoke,c=o.proxy;return n.k=c,n.j=s,c}(t,r):y("ES5").J(t,r);return(r?r.A:m()).p.push(n),n}function k(e){return r(e)||t(22,e),function e(t){if(!n(t))return t;var r,o=t[z],c=a(t);if(o){if(!o.P&&(o.i<4||!y("ES5").K(o)))return o.t;o.I=!0,r=P(t,c),o.I=!1}else r=P(t,c);return i(r,(function(t,n){o&&function(e,t){return 2===a(e)?e.get(t):e[t]}(o.t,t)===n||s(r,t,e(n))})),3===c?new Set(r):r}(e)}function P(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return f(e)}var T,V,M="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),D="undefined"!=typeof Map,_="undefined"!=typeof Set,$="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,L=M?Symbol.for("immer-nothing"):((T={})["immer-nothing"]=!0,T),N=M?Symbol.for("immer-draftable"):"__$immer_draftable",z=M?Symbol.for("immer-state"):"__$immer_state",Q="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,U=Object.getOwnPropertyDescriptors||function(e){var t={};return Q(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},B={},H={get:function(e,t){if(t===z)return e;var r=d(e);if(!o(r,t))return function(e,t,r){var n,i=A(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.k):void 0}(e,r,t);var i=r[t];return e.I||!n(i)?i:i===R(e.t,t)?(F(e),e.o[t]=j(e.A.h,i,e)):i},has:function(e,t){return t in d(e)},ownKeys:function(e){return Reflect.ownKeys(d(e))},set:function(e,t,r){var n=A(d(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=R(d(e),t),a=null==i?void 0:i[z];if(a&&a.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(c(r,i)&&(void 0!==r||o(e.t,t)))return!0;F(e),E(e)}return e.o[t]=r,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==R(e.t,t)||t in e.t?(e.D[t]=!1,F(e),E(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=d(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){t(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){t(12)}},Y={};i(H,(function(e,t){Y[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Y.deleteProperty=function(e,t){return H.deleteProperty.call(this,e[0],t)},Y.set=function(e,t,r){return H.set.call(this,e[0],t,r,e[0])};var W=new(function(){function e(e){this.O=$,this.N=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var i=e.prototype;return i.produce=function(e,r,i){if("function"==typeof e&&"function"!=typeof r){var a=r;r=e;var o=this;return function(e){var t=this;void 0===e&&(e=a);for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return o.produce(e,(function(e){var n;return(n=r).call.apply(n,[t,e].concat(i))}))}}var s;if("function"!=typeof r&&t(6),void 0!==i&&"function"!=typeof i&&t(7),n(e)){var c=w(this),u=j(this,e,void 0),l=!0;try{s=r(u),l=!1}finally{l?b(c):S(c)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return v(c,i),C(e,c)}),(function(e){throw b(c),e})):(v(c,i),C(s,c))}if(!e||"object"!=typeof e){if((s=r(e))===L)return;return void 0===s&&(s=e),this.N&&p(s,!0),s}t(21,e)},i.produceWithPatches=function(e,t){var r,n,i=this;return"function"==typeof e?function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return i.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(n))}))}:[this.produce(e,t,(function(e,t){r=e,n=t})),r,n]},i.createDraft=function(e){n(e)||t(8),r(e)&&(e=k(e));var i=w(this),a=j(this,e,void 0);return a[z].C=!0,S(i),a},i.finishDraft=function(e,t){var r=(e&&e[z]).A;return v(r,t),C(void 0,r)},i.setAutoFreeze=function(e){this.N=e},i.setUseProxies=function(e){e&&!$&&t(20),this.O=e},i.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}var a=y("Patches").$;return r(e)?a(e,t):this.produce(e,(function(e){return a(e,t.slice(n+1))}))},e}()),J=W.produce;W.produceWithPatches.bind(W),W.setAutoFreeze.bind(W),W.setUseProxies.bind(W),W.applyPatches.bind(W),W.createDraft.bind(W),W.finishDraft.bind(W);var K=function(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),Z=function(){return Math.random().toString(36).substring(7).split("").join(".")},X={INIT:"@@redux/INIT"+Z(),REPLACE:"@@redux/REPLACE"+Z(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Z()}};function G(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function ee(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(ee)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,a=t,o=[],s=o,c=!1;function u(){s===o&&(s=o.slice())}function l(){if(c)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function d(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(c)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return u(),s.push(e),function(){if(t){if(c)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,u();var r=s.indexOf(e);s.splice(r,1),o=null}}}function f(e){if(!G(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,a=i(a,e)}finally{c=!1}for(var t=o=s,r=0;r<t.length;r++){(0,t[r])()}return e}function p(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,f({type:X.REPLACE})}function g(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(l())}return r(),{unsubscribe:t(r)}}})[K]=function(){return this},e}return f({type:X.INIT}),(n={dispatch:f,subscribe:d,getState:l,replaceReducer:p})[K]=g,n}function te(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function re(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];"function"==typeof e[i]&&(r[i]=e[i])}var a,o=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:X.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:X.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+X.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,i={},s=0;s<o.length;s++){var c=o[s],u=r[c],l=e[c],d=u(l,t);if(void 0===d){var f=te(c,t);throw new Error(f)}i[c]=d,n=n||d!==l}return(n=n||o.length!==Object.keys(e).length)?i:e}}function ne(e,t){return function(){return t(e.apply(this,arguments))}}function ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ae(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(r,!0).forEach((function(t){ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function se(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function ce(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},a=t.map((function(e){return e(i)}));return oe({},r,{dispatch:n=se.apply(void 0,a)(r.dispatch)})}}}var ue=Object.freeze({__proto__:null,__DO_NOT_USE__ActionTypes:X,applyMiddleware:ce,bindActionCreators:function(e,t){if("function"==typeof e)return ne(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var i=e[n];"function"==typeof i&&(r[n]=ne(i,t))}return r},combineReducers:re,compose:se,createStore:ee});function le(e,t){return e===t}function de(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,i=0;i<n;i++)if(!e(t[i],r[i]))return!1;return!0}function fe(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var r=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}var pe=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=0,o=n.pop(),s=fe(n),c=e.apply(void 0,[function(){return a++,o.apply(null,arguments)}].concat(r)),u=e((function(){for(var e=[],t=s.length,r=0;r<t;r++)e.push(s[r].apply(null,arguments));return c.apply(null,e)}));return u.resultFunc=o,u.dependencies=s,u.recomputations=function(){return a},u.resetRecomputations=function(){return a=0},u}}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,r=null,n=null;return function(){return de(t,r,arguments)||(n=e.apply(null,arguments)),r=arguments,n}}));function ge(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(i){return"function"==typeof i?i(r,n,e):t(i)}}}}var he=ge();function ye(){return(ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Se(e,t,r){return(Se=be()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&ve(i,r.prototype),i}).apply(null,arguments)}function we(e){var t="function"==typeof Map?new Map:void 0;return(we=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Se(e,arguments,me(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ve(n,e)})(e)}he.withExtraArgument=ge;var Oe="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?se:se.apply(null,arguments)};var Ce=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=n.prototype;return i.concat=function(){for(var t,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return Se(n,(t=e.prototype.concat).call.apply(t,[this].concat(i)))},i.prepend=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 1===t.length&&Array.isArray(t[0])?Se(n,t[0].concat(this)):Se(n,t.concat(this))},n}(we(Array));function qe(e){void 0===e&&(e={});var t=e,r=t.thunk,n=void 0===r||r;t.immutableCheck,t.serializableCheck;var i=new Ce;return n&&(!function(e){return"boolean"==typeof e}(n)?i.push(he.withExtraArgument(n.extraArgument)):i.push(he)),i}function Ie(e){var t,r=function(e){return qe(e)},n=e||{},i=n.reducer,a=void 0===i?void 0:i,o=n.middleware,s=void 0===o?r():o,c=n.devTools,u=void 0===c||c,l=n.preloadedState,d=void 0===l?void 0:l,f=n.enhancers,p=void 0===f?void 0:f;if("function"==typeof a)t=a;else{if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(a))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=re(a)}var g=ce.apply(void 0,"function"==typeof s?s(r):s),h=se;u&&(h=Oe(ye({trace:!1},"object"==typeof u&&u)));var y=[g];return Array.isArray(p)?y=[g].concat(p):"function"==typeof p&&(y=p(y)),ee(t,d,h.apply(void 0,y))}function xe(e,t){function r(){if(t){var r=t.apply(void 0,arguments);if(!r)throw new Error("prepareAction did not return an object");return ye({type:e,payload:r.payload},"meta"in r&&{meta:r.meta},{},"error"in r&&{error:r.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(t){return t.type===e},r}function Re(e,t,i,a){void 0===i&&(i=[]);var o="function"==typeof t?function(e){var t,r={},n=[],i={addCase:function(e,t){var n="string"==typeof e?e:e.type;if(n in r)throw new Error("addCase cannot be called with two reducers for the same action type");return r[n]=t,i},addMatcher:function(e,t){return n.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[r,n,t]}(t):[t,i,a],s=o[0],c=o[1],u=o[2];return function(t,i){void 0===t&&(t=e);var a=[s[i.type]].concat(c.filter((function(e){return(0,e.matcher)(i)})).map((function(e){return e.reducer})));return 0===a.filter((function(e){return!!e})).length&&(a=[u]),a.reduce((function(e,t){if(t){if(r(e)){var a=t(e,i);return void 0===a?e:a}if(n(e))return J(e,(function(e){return t(e,i)}));var o=t(e,i);if(void 0===o){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return o}return e}),t)}}"undefined"==typeof Symbol||(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"==typeof Symbol||(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var Ae=["name","message","stack","code"],Ee=function(e){this.payload=e,this.name="RejectWithValue",this.message="Rejected"},Fe=function(e){if("object"==typeof e&&null!==e){var t={},r=Ae,n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}var o=a;"string"==typeof e[o]&&(t[o]=e[o])}return t}return{message:String(e)}};function je(e,t,r){var n=xe(e+"/fulfilled",(function(e,t,r){return{payload:e,meta:{arg:r,requestId:t,requestStatus:"fulfilled"}}})),i=xe(e+"/pending",(function(e,t){return{payload:void 0,meta:{arg:t,requestId:e,requestStatus:"pending"}}})),a=xe(e+"/rejected",(function(e,t,n){var i=e instanceof Ee,a=!!e&&"AbortError"===e.name,o=!!e&&"ConditionError"===e.name;return{payload:e instanceof Ee?e.payload:void 0,error:(r&&r.serializeError||Fe)(e||"Rejected"),meta:{arg:n,requestId:t,rejectedWithValue:i,requestStatus:"rejected",aborted:a,condition:o}}})),o="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(s,c,u){var l,d=function(e){void 0===e&&(e=21);for(var t="",r=e;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),f=new o,p=new Promise((function(e,t){return f.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:l||"Aborted"})}))})),g=!1;var h=function(){try{var o,l=function(e){return h?e:(r&&!r.dispatchConditionRejection&&a.match(o)&&o.meta.condition||s(o),o)},h=!1,y=function(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}((function(){if(r&&r.condition&&!1===r.condition(e,{getState:c,extra:u}))throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return g=!0,s(i(d,e)),Promise.resolve(Promise.race([p,Promise.resolve(t(e,{dispatch:s,getState:c,extra:u,requestId:d,signal:f.signal,rejectWithValue:function(e){return new Ee(e)}})).then((function(t){return t instanceof Ee?a(t,d,e):n(t,d,e)}))])).then((function(e){o=e}))}),(function(t){o=a(t,d,e)}));return Promise.resolve(y&&y.then?y.then(l):l(y))}catch(e){return Promise.reject(e)}}();return Object.assign(h,{abort:function(e){g&&(l=e,f.abort())},requestId:d,arg:e})}}),{pending:i,rejected:a,fulfilled:n,typePrefix:e})}!function(){function e(e,t){var r=s[e];return r?r.enumerable=t:s[e]=r={configurable:!0,enumerable:t,get:function(){var t=this[z];return H.get(t,e)},set:function(t){var r=this[z];H.set(r,e,t)}},r}function t(e){for(var t=e.length-1;t>=0;t--){var r=e[t][z];if(!r.P)switch(r.i){case 5:a(r)&&E(r);break;case 4:n(r)&&E(r)}}}function n(e){for(var t=e.t,r=e.k,n=Q(r),i=n.length-1;i>=0;i--){var a=n[i];if(a!==z){var s=t[a];if(void 0===s&&!o(t,a))return!0;var u=r[a],l=u&&u[z];if(l?l.t!==s:!c(u,s))return!0}}var d=!!t[z];return n.length!==Q(t).length+(d?0:1)}function a(e){var t=e.k;if(t.length!==e.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}var s={};!function(e,t){B[e]||(B[e]=t)}("ES5",{J:function(t,r){var n=Array.isArray(t),i=function(t,r){if(t){for(var n=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(n,""+i,e(i,!0));return n}var a=U(r);delete a[z];for(var o=Q(a),s=0;s<o.length;s++){var c=o[s];a[c]=e(c,t||!!a[c].enumerable)}return Object.create(Object.getPrototypeOf(r),a)}(n,t),a={i:n?5:4,A:r?r.A:m(),P:!1,I:!1,D:{},l:r,t:t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,z,{value:a,writable:!0}),i},S:function(e,n,s){s?r(n)&&n[z].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var r=t[z];if(r){var n=r.t,s=r.k,c=r.D,u=r.i;if(4===u)i(s,(function(t){t!==z&&(void 0!==n[t]||o(n,t)?c[t]||e(s[t]):(c[t]=!0,E(r)))})),i(n,(function(e){void 0!==s[e]||o(s,e)||(c[e]=!1,E(r))}));else if(5===u){if(a(r)&&(E(r),c.length=!0),s.length<n.length)for(var l=s.length;l<n.length;l++)c[l]=!1;else for(var d=n.length;d<s.length;d++)c[d]=!0;for(var f=Math.min(s.length,n.length),p=0;p<f;p++)void 0===c[p]&&e(s[p])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):a(e)}})}();var ke=fetch,Pe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Te(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}function Ve(e){var t={exports:{}};return e(t,t.exports),t.exports}var Me=Pe&&Pe.__assign||function(){return(Me=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},De={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};var _e=function(e){var t=Me(Me({},De),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t},$e=Object.defineProperty({getSanitizedOptions:_e},"__esModule",{value:!0});var Le=function(e){var t=Math.random()*e;return Math.round(t)},Ne=Object.defineProperty({fullJitter:Le},"__esModule",{value:!0});var ze=function(e){return e},Qe=Object.defineProperty({noJitter:ze},"__esModule",{value:!0});var Ue,Be=function(e){switch(e.jitter){case"full":return Ne.fullJitter;case"none":default:return Qe.noJitter}},He=Object.defineProperty({JitterFactory:Be},"__esModule",{value:!0}),Ye=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return He.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}(),We=Object.defineProperty({Delay:Ye},"__esModule",{value:!0}),Je=Pe&&Pe.__extends||(Ue=function(e,t){return(Ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}Ue(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Ke=Pe&&Pe.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))},Ze=Pe&&Pe.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Je(t,e),t.prototype.apply=function(){return Ke(this,void 0,void 0,(function(){return Ze(this,(function(t){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(We.Delay),Ge=Object.defineProperty({SkipFirstDelay:Xe},"__esModule",{value:!0}),et=Pe&&Pe.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return et(t,e),t}(We.Delay),rt=Object.defineProperty({AlwaysDelay:tt},"__esModule",{value:!0});var nt=function(e,t){var r=function(e){if(!e.delayFirstAttempt)return new Ge.SkipFirstDelay(e);return new rt.AlwaysDelay(e)}(e);return r.setAttemptNumber(t),r};var it=Object.defineProperty({DelayFactory:nt},"__esModule",{value:!0}),at=Pe&&Pe.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))},ot=Pe&&Pe.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};var st=function(e,t){return void 0===t&&(t={}),at(this,void 0,void 0,(function(){var r;return ot(this,(function(n){switch(n.label){case 0:return r=$e.getSanitizedOptions(t),[4,new ct(e,r).execute()];case 1:return[2,n.sent()]}}))}))},ct=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return at(this,void 0,void 0,(function(){var e;return ot(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return at(this,void 0,void 0,(function(){return ot(this,(function(e){switch(e.label){case 0:return[4,it.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}();class ut extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}}class lt extends Error{constructor(){super(),this.name="Disconnected",this.message="Client is not connected to the internet."}}function dt(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function ft(e){return 429===e}class pt{static async call(e){const t=function(e){const{url:t,method:r,requestParams:n,contentType:i,accessToken:a,signal:o}=e,s=function(e,t){if("application/x-www-form-urlencoded"===t)return"object"==typeof(r=e)&&r&&Object.values(r).every(dt)?function(e){const t=[];for(const r in e){const n=encodeURIComponent(r),i=encodeURIComponent(e[r]);t.push(`${n}=${i}`)}return t.join("&")}(e):"";var r;return JSON.stringify(e)}(n,i);return{url:t,method:r,headers:{"Content-Type":i,Authorization:"Bearer "+a,...e.headers},body:s,signal:o}}(e),{preprocessRequest:r,logger:n}=e,i={...t,...r?await r(t,"searchApiFetch"):{}};n.info(i,"Platform request");const{url:a,...o}=i,s=async()=>{const e=await ke(a,o);if(ft(e.status))throw e;return e};try{const e=await st(s,{retry:e=>{const t=e&&ft(e.status);return t&&n.info("Platform retrying request"),t}});if(419===e.status)throw n.info("Platform renewing token"),new ut;return n.info({response:e,requestInfo:i},"Platform response"),e}catch(e){return"Failed to fetch"===e.message?new lt:e}}}function gt(e){return`https://platform${e&&e.environment&&"prod"!==e.environment?e.environment:""}${e&&e.region&&"us-east-1"!==e.region?"-"+e.region:""}.cloud.coveo.com`}function ht(e){if(e instanceof lt)return{error:{statusCode:0,type:"Disconnected",message:"Could not connect"}};throw e}const yt=(e,t,r,n)=>({accessToken:e.accessToken,method:t,contentType:r,url:`${e.url}${n}?${mt(e)}`}),mt=e=>"organizationId="+e.organizationId;const vt=TextDecoder;class bt extends Error{constructor(e){super(e),this.name="SchemaValidationError"}}class St{constructor(e){this.definition=e}validate(e={},t=""){const r={...this.default,...e},n=[];for(const e in this.definition){const t=this.definition[e].validate(r[e]);t&&n.push(`${e}: ${t}`)}if(n.length)throw function(e,t){const r=`\n  The following properties are invalid:\n\n    ${e.join("\n\t")}\n  \n  ${t}\n  `;return new bt(r)}(n,t);return r}get default(){const e={};for(const t in this.definition){const r=this.definition[t].default;void 0!==r&&(e[t]=r)}return e}}class wt{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&Ct(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return!0===this.baseConfig.required}}function Ot(e){return void 0===e}function Ct(e){return Ot(e)||function(e){return null===e}(e)}class qt{constructor(e={}){this.config=e,this.value=new wt(e)}validate(e){return this.value.validate(e)||(function(e){return Ot(e)||It(e)}(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}}function It(e){return"number"==typeof e&&!isNaN(e)}class xt{constructor(e={}){this.value=new wt(e)}validate(e){return this.value.validate(e)||(function(e){return Ot(e)||Rt(e)}(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}}function Rt(e){return"boolean"==typeof e}const At=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;class Et{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new wt(this.config)}validate(e){const{emptyAllowed:t,url:r,regex:n,constrainTo:i}=this.config,a=this.value.validate(e);return a||(Ot(e)?null:Ft(e)?t||e.length?r&&!At.test(e)?"value is not a valid URL.":n&&!n.test(e)?"value did not match provided regex "+n:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is an empty string.":"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}}function Ft(e){return"[object String]"===Object.prototype.toString.call(e)}class jt{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(Ot(e))return this.config.options.required?"value is required and is currently undefined":null;if(!kt(e))return"value is not an object";for(const[t,r]of Object.entries(this.config.values))if(r.required&&Ct(e[t]))return"value does not contain "+t;let t="";for(const[r,n]of Object.entries(this.config.values)){const i=e[r],a=n.validate(i);null!==a&&(t+=" "+a)}return""===t?null:t}get default(){}get required(){return!!this.config.options.required}}function kt(e){return void 0!==e&&"object"==typeof e}class Pt{constructor(e={}){this.config=e,this.value=new wt(this.config)}validate(e){if(!Ct(e)&&!Array.isArray(e))return"value is not an array";const t=this.value.validate(e);if(null!==t)return t;if(Ct(e))return null;if(void 0!==this.config.max&&e.length>this.config.max)return"value contains more than "+this.config.max;if(void 0!==this.config.min&&e.length<this.config.min)return"value contains less than "+this.config.min;if(void 0!==this.config.each){let t="";return e.forEach((r=>{this.config.each.required&&Ct(r)&&(t="value is null or undefined: "+e.join(","));const n=this.validatePrimitiveValue(r,this.config.each);null!==n&&(t+=" "+n)})),""===t?null:t}return null}validatePrimitiveValue(e,t){return Rt(e)||Ft(e)||It(e)||kt(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}}function Tt(e){return Array.isArray(e)}class Vt{constructor(e){this.config=e,this.value=new wt(e)}validate(e){const t=this.value.validate(e);return null!==t?t:Ot(e)||Object.values(this.config.enum).find((t=>t===e))?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}}class Mt{constructor(e){this.options=e,this.searchAbortController=null}async plan(e){const t=await pt.call({...yt(e,"POST","application/json","/plan"),requestParams:Qt(e),...this.options});if(t instanceof Error)return ht(t);const r=await t.json();return function(e){return void 0!==e.preprocessingOutput}(r)?{success:r}:{error:Dt({response:t,body:r})}}async querySuggest(e){const t=await pt.call({...yt(e,"POST","application/json","/querySuggest"),requestParams:Qt(e),...this.options});if(t instanceof Error)return ht(t);const r=await t.json(),n={response:t,body:r};if(function(e){return void 0!==e.completions}(r)){return{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}}return{error:Dt(n)}}async search(e){var t;this.searchAbortController&&(this.options.logger.warn("Cancelling current pending search query"),this.searchAbortController.abort()),this.searchAbortController=this.getAbortControllerInstanceIfAvailable();const r=await pt.call({...yt(e,"POST","application/json",""),requestParams:Qt(e),...this.options,signal:null===(t=this.searchAbortController)||void 0===t?void 0:t.signal});if(r instanceof Error)return ht(r);this.searchAbortController=null;const n=await r.json(),i={response:r,body:n};if(zt(n)){i.body=function(e){const t={answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0};if(Ct(e.questionAnswer))return e.questionAnswer=t,e;return e.questionAnswer={...t,...e.questionAnswer},e}(n);return{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}}return{error:Dt(i)}}async facetSearch(e){const t=await pt.call({...yt(e,"POST","application/json","/facet"),requestParams:Qt(e),...this.options});if(t instanceof Error)throw t;const r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){const t=await pt.call({...yt(e,"POST","application/json",""),requestParams:Qt(e),...this.options});if(t instanceof Error)throw t;const r=await t.json();return zt(r)?{success:r}:{error:Dt({response:t,body:r})}}async html(e){const t=await pt.call({...yt(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:Qt(e),...this.options});if(t instanceof Error)throw t;const r=function(e){return((e.headers.get("content-type")||"").split(";").find((e=>-1!==e.indexOf("charset=")))||"").split("=")[1]||"UTF-8"}(t),n=await t.arrayBuffer(),i=new vt(r).decode(n);return function(e){return"string"==typeof e}(i)?{success:i}:{error:Dt({response:t,body:i})}}async productRecommendations(e){const t=await pt.call({...yt(e,"POST","application/json",""),requestParams:Qt(e),...this.options});if(t instanceof Error)throw t;const r=await t.json();return zt(r)?{success:r}:{error:Dt({response:t,body:r})}}getAbortControllerInstanceIfAvailable(){if("undefined"==typeof window){return new(require("node-abort-controller"))}return"undefined"==typeof AbortController?null:new AbortController}}const Dt=e=>{const{response:t}=e;return t.body?_t(e):$t(t)},_t=e=>function(e){return void 0!==e.body.exception}(e)?Lt(e):function(e){return void 0!==e.body.statusCode}(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},$t=e=>{const t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:"Client side error: "+(t.message||""),statusCode:400,type:"ClientError"}},Lt=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),Nt=e=>void 0!==e.error;function zt(e){return void 0!==e.results}function Qt(e){const{url:t,accessToken:r,organizationId:n,...i}=e;return i}const Ut=e=>e,Bt=e=>e,Ht=e=>e,Yt=new Et({required:!0,emptyAllowed:!1}),Wt=new Et({required:!0,emptyAllowed:!0}),Jt=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),Kt=(e,t)=>"required"in t?{payload:new St({value:t}).validate({value:e}).value}:{payload:new St(t).validate(e)},Zt=(e,t)=>{try{return Kt(e,t)}catch(t){return{payload:e,error:Jt(t)}}},Xt=(e,t,r,n)=>er(e,t,r,"Check the initialState of "+n,"Controller initialization error"),Gt=(e,t,r,n)=>er(e,t,r,"Check the options of "+n,"Controller initialization error"),er=(e,t,r,n,i)=>{try{return t.validate(r,n)}catch(t){throw e.logger.error(t,i),t}},tr=new Et({emptyAllowed:!1,required:!1}),rr=()=>new Et({emptyAllowed:!1,required:!1}),nr=()=>new Et({emptyAllowed:!1,required:!0}),ir=xe("configuration/updateBasicConfiguration",(e=>Zt(e,{accessToken:new Et({emptyAllowed:!1}),organizationId:new Et({emptyAllowed:!1}),platformUrl:new Et({url:!0,emptyAllowed:!1})}))),ar=xe("configuration/updateSearchConfiguration",(e=>Zt(e,{apiBaseUrl:new Et({url:!0,emptyAllowed:!1}),pipeline:new Et({emptyAllowed:!1}),searchHub:new Et({emptyAllowed:!1}),locale:tr}))),or=xe("configuration/updateAnalyticsConfiguration",(e=>Zt(e,{enabled:new xt({default:!0}),originLevel2:rr(),originLevel3:rr(),apiBaseUrl:new Et({url:!0,emptyAllowed:!1}),runtimeEnvironment:new wt}))),sr=xe("configuration/analytics/disable"),cr=xe("configuration/analytics/enable"),ur=xe("configuration/analytics/originlevel2",(e=>Zt(e,{originLevel2:nr()}))),lr=xe("configuration/analytics/originlevel3",(e=>Zt(e,{originLevel3:nr()})));const dr=e=>()=>t=>r=>{if(!r.error)return t(r);const n=r.error;return e.error(n.stack||n.message||n.name||"Error","Action dispatch error "+r.type,r),"SchemaValidationError"!==r.error.name?t(r):void 0},fr=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},"Action dispatched: "+n.type),r(n));const pr=xe("history/undo"),gr=xe("history/redo"),hr=xe("history/snapshot"),yr=je("history/back",(async(e,{dispatch:t})=>{t(pr()),await t(vr())})),mr=je("history/forward",(async(e,{dispatch:t})=>{t(gr()),await t(vr())})),vr=je("history/change",(async(e,{getState:t})=>t().history.present)),br=xe("advancedSearchQueries/update",(e=>Zt(e,{aq:new Et({required:!1,emptyAllowed:!0}),cq:new Et({required:!1,emptyAllowed:!0})}))),Sr=xe("advancedSearchQueries/register",(e=>Zt(e,{aq:new Et({required:!1,emptyAllowed:!0}),cq:new Et({required:!1,emptyAllowed:!0})}))),wr={q:new Et,enableQuerySyntax:new xt,aq:new Et,cq:new Et,firstResult:new qt({min:0}),numberOfResults:new qt({min:0}),sortCriteria:new Et,f:new jt,cf:new jt,nf:new jt,df:new jt,debug:new xt},Or=xe("searchParameters/restore",(e=>Zt(e,wr))),Cr=Re({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},(e=>{e.addCase(br,((e,t)=>{const{aq:r,cq:n}=t.payload;Ot(r)||(e.aq=r,e.aqWasSet=!0),Ot(n)||(e.cq=n,e.cqWasSet=!0)})).addCase(Sr,((e,t)=>{const{aq:r,cq:n}=t.payload;Ot(r)||(e.defaultFilters.aq=r,e.aqWasSet||(e.aq=r)),Ot(n)||(e.defaultFilters.cq=n,e.cqWasSet||(e.cq=n))})).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.advancedSearchQueries)&&void 0!==n?n:e})).addCase(Or,((e,t)=>{const{aq:r,cq:n}=t.payload;Ot(r)||(e.aq=r,e.aqWasSet=!0),Ot(n)||(e.cq=n,e.cqWasSet=!0)}))})),qr=()=>({organizationId:"",accessToken:"",platformUrl:gt(),search:{apiBaseUrl:gt()+"/rest/search/v2",locale:"en-US"},analytics:{enabled:!0,apiBaseUrl:gt()+"/rest/ua",originLevel2:"default",originLevel3:"default"}}),Ir=Re(qr(),(e=>e.addCase(ir,((e,t)=>{t.payload.accessToken&&(e.accessToken=t.payload.accessToken),t.payload.organizationId&&(e.organizationId=t.payload.organizationId),t.payload.platformUrl&&(e.platformUrl=t.payload.platformUrl,e.search.apiBaseUrl=t.payload.platformUrl+"/rest/search/v2",e.analytics.apiBaseUrl=t.payload.platformUrl+"/rest/ua")})).addCase(ar,((e,t)=>{t.payload.apiBaseUrl&&(e.search.apiBaseUrl=t.payload.apiBaseUrl),t.payload.locale&&(e.search.locale=t.payload.locale)})).addCase(or,((e,t)=>{void 0!==t.payload.enabled&&(e.analytics.enabled=t.payload.enabled),void 0!==t.payload.originLevel2&&(e.analytics.originLevel2=t.payload.originLevel2),void 0!==t.payload.originLevel3&&(e.analytics.originLevel3=t.payload.originLevel3),void 0!==t.payload.apiBaseUrl&&(e.analytics.apiBaseUrl=t.payload.apiBaseUrl),void 0!==t.payload.runtimeEnvironment&&(e.analytics.runtimeEnvironment=t.payload.runtimeEnvironment)})).addCase(sr,(e=>{e.analytics.enabled=!1})).addCase(cr,(e=>{e.analytics.enabled=!0})).addCase(ur,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(lr,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})))),xr=new Pt({each:Yt,required:!0}),Rr=(e,t)=>(Zt(e,Yt),Ft(t)?Zt(t,Yt):Zt(t,xr),{payload:{contextKey:e,contextValue:t}}),Ar=xe("context/set",(e=>{for(const[t,r]of Object.entries(e))Rr(t,r);return{payload:e}})),Er=xe("context/add",(e=>Rr(e.contextKey,e.contextValue))),Fr=xe("context/remove",(e=>Zt(e,Yt)));const jr=Re({contextValues:{}},(e=>{e.addCase(Ar,((e,t)=>{e.contextValues=t.payload})).addCase(Er,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase(Fr,((e,t)=>{delete e.contextValues[t.payload]})).addCase(vr.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.context.contextValues)}))})),kr=xe("debug/enable"),Pr=xe("debug/disable"),Tr=Re(!1,(e=>{e.addCase(kr,(()=>!0)).addCase(Pr,(()=>!1)).addCase(Or,((e,t)=>{var r;return null!==(r=t.payload.debug)&&void 0!==r?r:e}))})),Vr="1.7.0",Mr=Re(Vr,(e=>e)),Dr=xe("didYouMean/enable"),_r=xe("didYouMean/disable"),$r=xe("didYouMean/correction",(e=>Zt(e,Yt)));
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */
function Lr(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function Nr(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))}var zr;!function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"}(zr||(zr={}));const Qr=window.fetch;class Ur{constructor(e){this.opts=e}sendEvent(e,t){return Nr(this,void 0,void 0,(function*(){const{baseUrl:r,visitorIdProvider:n,preprocessRequest:i}=this.opts,a=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",o={url:`${r}/analytics/${e}${a}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},s=Object.assign(Object.assign({},o),i?yield i(o,"analyticsFetch"):{}),{url:c}=s,u=Lr(s,["url"]),l=yield Qr(c,u);if(l.ok){const e=yield l.json();return e.visitorId&&n.setCurrentVisitorId(e.visitorId),e}try{l.json()}catch(e){}throw console.error(`An error has occured when sending the "${e}" event.`,l,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}))}shouldAppendVisitorId(e){return-1!==[zr.click,zr.custom,zr.search,zr.view].indexOf(e)}getVisitorIdParam(){return Nr(this,void 0,void 0,(function*(){const{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?"?visitor="+t:""}))}getHeaders(){const{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:"Bearer "+e}:{}),{"Content-Type":"application/json"})}}function Br(){return"undefined"!=typeof navigator}function Hr(){return"undefined"!=typeof document}function Yr(){return"undefined"!=typeof localStorage}function Wr(){return Br()&&navigator.cookieEnabled}function Jr(){return"undefined"!=typeof crypto&&void 0!==crypto.getRandomValues}const Kr=[zr.click,zr.custom,zr.search,zr.view],Zr=(e,t)=>-1!==Kr.indexOf(e)?Object.assign({language:Hr()?document.documentElement.lang:"unknown",userAgent:Br()?navigator.userAgent:"unknown"},t):t;class Xr{static set(e,t,r){var n,i,a,o;r?((i=new Date).setTime(i.getTime()+r),a="; expires="+i.toGMTString()):a="",-1===(o=location.hostname).indexOf(".")?document.cookie=e+"="+t+a+"; path=/":((n=o.split(".")).shift(),Gr({name:e,value:t,expires:a,domain:"."+n.join(".")}),null!=Xr.get(e)&&Xr.get(e)==t||Gr({name:e,value:t,expires:a,domain:"."+o}))}static get(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var i=r[n];if(0==(i=i.replace(/^\s+/,"")).indexOf(t))return i.substring(t.length,i.length)}return null}static erase(e){Xr.set(e,"",-1)}}function Gr(e){const{name:t,value:r,expires:n,domain:i}=e;document.cookie=`${t}=${r}${n}; path=/; domain=${i}; SameSite=Lax`}function en(){return Yr()?localStorage:Wr()?new tn:"undefined"!=typeof sessionStorage?sessionStorage:new nn}class tn{getItem(e){return Xr.get(`${tn.prefix}${e}`)}removeItem(e){Xr.erase(`${tn.prefix}${e}`)}setItem(e,t){Xr.set(`${tn.prefix}${e}`,t)}}tn.prefix="coveo_";class rn{constructor(){this.cookieStorage=new tn}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t)}}class nn{getItem(e){return null}removeItem(e){}setItem(e,t){}}const an="__coveo.analytics.history";class on{constructor(e){this.store=e||en()}addElement(e){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=this.getHistoryWithInternalTime();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return Nr(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=yield this.getHistoryWithInternalTimeAsync();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){const e=this.getHistoryWithInternalTime();return this.stripInternalTime(e)}getHistoryAsync(){return Nr(this,void 0,void 0,(function*(){const e=yield this.getHistoryWithInternalTimeAsync();return this.stripInternalTime(e)}))}getHistoryWithInternalTime(){try{const e=this.store.getItem(an);return e&&"string"==typeof e?JSON.parse(e):[]}catch(e){return[]}}getHistoryWithInternalTimeAsync(){return Nr(this,void 0,void 0,(function*(){try{const e=yield this.store.getItem(an);return e?JSON.parse(e):[]}catch(e){return[]}}))}setHistory(e){try{this.store.setItem(an,JSON.stringify(e.slice(0,20)))}catch(e){}}clear(){try{this.store.removeItem(an)}catch(e){}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();if(null!=e){return e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]}return null}cropQueryElement(e){e.name&&"query"==e.name.toLowerCase()&&null!=e.value&&(e.value=e.value.slice(0,75))}isValidEntry(e){let t=this.getMostRecentElement();return!t||t.value!=e.value||(e.internalTime||0)-(t.internalTime||0)>6e4}stripInternalTime(e){return e.map((e=>{const{name:t,time:r,value:n}=e;return{name:t,time:r,value:n}}))}}var sn=Object.freeze({__proto__:null,STORE_KEY:an,MAX_NUMBER_OF_HISTORY_ELEMENTS:20,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:6e4,MAX_VALUE_SIZE:75,HistoryStore:on,default:on});const cn=(e,t)=>Nr(void 0,void 0,void 0,(function*(){return e===zr.view?(yield un(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),un=e=>Nr(void 0,void 0,void 0,(function*(){const t=new on,r={name:"PageView",value:e,time:JSON.stringify(new Date)};yield t.addElementAsync(r)})),ln=e=>e?(Number(e)^dn(new Uint8Array(1))[0]%16>>Number(e)/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,ln),dn=e=>{if(Jr())return crypto.getRandomValues(e);for(var t=0,r=0;t<e.length;t++)0==(3&t)&&(r=4294967296*Math.random()),e[t]=r>>>((3&t)<<3)&255;return e},fn=Object.keys,pn={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},gn=[...fn(pn).map((e=>pn[e]))].join("|"),hn=new RegExp(`^(${gn}$)`),yn=[e=>hn.test(e)],mn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},vn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr"},bn={action:"pa",list:"pal",listSource:"pls"},Sn={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},wn={id:"quoteId",affiliation:"quoteAffiliation"},On={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},Cn={add:bn,bookmark_add:bn,bookmark_remove:bn,click:bn,checkout:bn,checkout_option:bn,detail:bn,impression:bn,remove:bn,refund:Object.assign(Object.assign({},bn),Sn),purchase:Object.assign(Object.assign({},bn),Sn),quickview:bn,quote:Object.assign(Object.assign({},bn),wn),review:Object.assign(Object.assign({},bn),On)},qn=fn(mn).map((e=>mn[e])),In=fn(vn).map((e=>vn[e])),xn=fn(bn).map((e=>bn[e])),Rn=fn(Sn).map((e=>Sn[e])),An=fn(On).map((e=>On[e])),En=fn(wn).map((e=>wn[e])),Fn=[...qn,"custom"].join("|"),jn=[...In,"custom"].join("|"),kn=new RegExp(`^(pr[0-9]+)(${Fn})$`),Pn=new RegExp(`^((il[0-9]+pi[0-9]+)(${jn}))|(il[0-9]+nm)$`),Tn=new RegExp(`^(${xn.join("|")})$`),Vn=new RegExp(`^(${Rn.join("|")})$`),Mn=new RegExp("^(pr[0-9]+)custom$"),Dn=new RegExp("^(il[0-9]+pi[0-9]+)custom$"),_n=new RegExp(`^(${["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit",...An,...En].join("|")})$`),$n=[e=>Pn.test(e),e=>kn.test(e),e=>Tn.test(e),e=>Vn.test(e),e=>_n.test(e)],Ln=[Mn,Dn],Nn=Object.assign(Object.assign(Object.assign({},{anonymizeIp:"aip"}),{eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"}),{hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"}),zn=Object.assign(Object.assign({},Nn),{svcAction:"svc_action",svcActionData:"svc_action_data"}),Qn=fn(zn).map((e=>zn[e])),Un=e=>-1!==Qn.indexOf(e),Bn=e=>"custom"===e,Hn=e=>{let t=void 0;return[...Ln].every((r=>{var n;return t=null===(n=r.exec(e))||void 0===n?void 0:n[1],!Boolean(t)})),t},Yn=(e,t)=>fn(t).reduce(((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]})),{});class Wn{constructor(e){this.opts=e}sendEvent(e,t){return Nr(this,void 0,void 0,(function*(){if(!navigator.sendBeacon)throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');const{baseUrl:r,preprocessRequest:n}=this.opts,i=this.encodeForEventType(e,t),a=yield this.getQueryParamsForEventType(e),o={url:`${r}/analytics/${e}?${a}`,body:new Blob([i],{type:"application/x-www-form-urlencoded"})},{url:s,body:c}=Object.assign(Object.assign({},o),n?yield n(o,"analyticsBeacon"):{});console.log(`Sending beacon for "${e}" with: `,JSON.stringify(t)),navigator.sendBeacon(s,c)}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeForLegacyType(e,t):this.encodeForFormUrlEncoded(Object.assign({access_token:this.opts.token},t))}getQueryParamsForEventType(e){return Nr(this,void 0,void 0,(function*(){const{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?"access_token="+t:"",n?"visitorId="+n:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return-1!==[zr.click,zr.custom,zr.search,zr.view].indexOf(e)}encodeForLegacyType(e,t){return`${e}Event=${encodeURIComponent(JSON.stringify(t))}`}encodeForFormUrlEncoded(e){return Object.keys(e).filter((t=>!!e[t])).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(this.encodeValue(e[t]))}`)).join("&")}encodeValue(e){return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e:JSON.stringify(e)}}class Jn{sendEvent(e,t){return Nr(this,void 0,void 0,(function*(){return Promise.resolve()}))}}class Kn{constructor(e,t){Yr()&&Wr()?this.storage=new rn:Yr()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new nn),this.beaconClient=new Wn(e),window.addEventListener("beforeunload",(()=>t()))}}class Zn{constructor(e,t){this.storage=t||new nn,this.beaconClient=new Ur(e)}}class Xn{constructor(){this.storage=new nn,this.beaconClient=new Jn}}const Gn="https://analytics.cloud.coveo.com/rest/ua";class ei{constructor(e){if(!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[cn,Zr].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};const t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.analyticsFetchClient=new Ur(t)}get defaultOptions(){return{endpoint:Gn,token:"",version:"v15",beforeSendHooks:[],afterSendHooks:[]}}initRuntime(e){return"undefined"!=typeof window&&Hr()?new Kn(e,(()=>this.flushBufferWithBeacon())):("undefined"!=typeof navigator&&"ReactNative"==navigator.product&&console.warn("\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please install @react-native-async-storage/async-storage and instantiate \n        your analytics client as follows:\n        \n        import {ReactNativeRuntime} from 'coveo.analytics/react-native';\n        \n        const analytics = new CoveoAnalytics({\n            ...your options,\n            runtimeEnvironment: new ReactNativeRuntime();\n        })\n    "),new Zn(e))}get analyticsBeaconClient(){return this.runtime.beaconClient}get storage(){return this.runtime.storage}determineVisitorId(){return Nr(this,void 0,void 0,(function*(){try{return(yield this.storage.getItem("visitorId"))||ln()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),ln()}}))}getCurrentVisitorId(){return Nr(this,void 0,void 0,(function*(){if(!this.visitorId){const e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return Nr(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}getParameters(e,...t){return Nr(this,void 0,void 0,(function*(){return yield this.resolveParameters(e,...t)}))}getPayload(e,...t){return Nr(this,void 0,void 0,(function*(){const r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)}))}get currentVisitorId(){return"string"!=typeof(this.visitorId||this.storage.getItem("visitorId"))&&this.setCurrentVisitorId(ln()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}resolveParameters(e,...t){return Nr(this,void 0,void 0,(function*(){const{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:i=!1}=this.eventTypeMapping[e]||{};return yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>Nr(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{visitorId:n?yield this.getCurrentVisitorId():""})})),e=>i?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,r)=>Nr(this,void 0,void 0,(function*(){const n=yield t;return yield r(e,n)}))),t)].reduce(((e,t)=>Nr(this,void 0,void 0,(function*(){const r=yield e;return yield t(r)}))),Promise.resolve(t))}))}resolvePayloadForParameters(e,t){return Nr(this,void 0,void 0,(function*(){const{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[t=>this.removeEmptyPayloadValues(t,e),e=>this.validateParams(e),e=>r?(e=>{const t=!!e.action&&Cn[e.action]||{};return fn(e).reduce(((r,n)=>{const i=t[n]||zn[n]||n;return Object.assign(Object.assign({},r),{[i]:e[n]})}),{})})(e):e,e=>r?this.removeUnknownParameters(e):e,e=>r?this.processCustomParameters(e):e].reduce(((e,t)=>Nr(this,void 0,void 0,(function*(){const r=yield e;return yield t(r)}))),Promise.resolve(t))}))}sendEvent(e,...t){return Nr(this,void 0,void 0,(function*(){const{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),i=yield this.resolvePayloadForParameters(e,n);return this.bufferedRequests.push({eventType:r,payload:i,handled:!1}),yield Promise.all(this.afterSendHooks.map((t=>t(e,n)))),yield this.deferExecution(),yield this.sendFromBufferWithFetch()}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}flushBufferWithBeacon(){for(;this.hasPendingRequests();){const{eventType:e,payload:t}=this.bufferedRequests.pop();this.analyticsBeaconClient.sendEvent(e,t)}}sendFromBufferWithFetch(){return Nr(this,void 0,void 0,(function*(){const e=this.bufferedRequests.shift();if(e){const{eventType:t,payload:r}=e;return this.analyticsFetchClient.sendEvent(t,r)}}))}hasPendingRequests(){return this.bufferedRequests.length>0}clear(){this.storage.removeItem("visitorId");(new on).clear()}sendSearchEvent(e){return Nr(this,void 0,void 0,(function*(){return this.sendEvent(zr.search,e)}))}sendClickEvent(e){return Nr(this,void 0,void 0,(function*(){return this.sendEvent(zr.click,e)}))}sendCustomEvent(e){return Nr(this,void 0,void 0,(function*(){return this.sendEvent(zr.custom,e)}))}sendViewEvent(e){return Nr(this,void 0,void 0,(function*(){return this.sendEvent(zr.view,e)}))}getVisit(){return Nr(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/visit"),t=yield e.json();return this.visitorId=t.visitorId,t}))}getHealth(){return Nr(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/monitoring/health");return yield e.json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}parseVariableArgumentsPayload(e,t){const r={};for(let n=0,i=t.length;n<i;n++){const i=t[n];if("string"==typeof i)r[e[n]]=i;else if("object"==typeof i)return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return-1!==({[zr.search]:["queryText"]}[e]||[]).indexOf(t)}removeEmptyPayloadValues(e,t){return Object.keys(e).filter((r=>{return this.isKeyAllowedEmpty(t,r)||null!=(n=e[r])&&""!==n;var n})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if((e=>[...$n,...yn,Un,Bn].some((t=>t(e))))(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}processCustomParameters(e){const{custom:t}=e,r=Lr(e,["custom"]),n=this.lowercaseKeys(t),i=fn(a=r).reduce(((e,t)=>{const r=Hn(t);return r?Object.assign(Object.assign({},e),Yn(r,a[t])):Object.assign(Object.assign({},e),{[t]:a[t]})}),{});var a;return Object.assign(Object.assign({},n),i)}lowercaseKeys(e){return Object.keys(e||{}).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r.toLowerCase()]:e[r]})),{})}validateParams(e){const{anonymizeIp:t}=e,r=Lr(e,["anonymizeIp"]);return void 0!==t&&-1==["0","false","undefined","null","{}","[]",""].indexOf((""+t).toLowerCase())&&(r.anonymizeIp=1),r}ensureAnonymousUserWhenUsingApiKey(e){const{userId:t}=e,r=Lr(e,["userId"]);return(null==(n=this.options.token)?void 0:n.startsWith("xx"))&&!t?(r.userId="anonymous",r):e;var n}get baseUrl(){const{version:e,endpoint:t}=this.options,r=-1!==t.indexOf(".cloud.coveo.com");return`${t}${r?"":"/rest"}/${e}`}}var ti;!function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion"}(ti||(ti={}));const ri={[ti.triggerNotify]:"queryPipelineTriggers",[ti.triggerExecute]:"queryPipelineTriggers",[ti.triggerQuery]:"queryPipelineTriggers",[ti.triggerRedirect]:"queryPipelineTriggers",[ti.queryError]:"errors",[ti.queryErrorBack]:"errors",[ti.queryErrorClear]:"errors",[ti.queryErrorRetry]:"errors",[ti.pagerNext]:"getMoreResults",[ti.pagerPrevious]:"getMoreResults",[ti.pagerNumber]:"getMoreResults",[ti.pagerResize]:"getMoreResults",[ti.pagerScrolling]:"getMoreResults",[ti.facetSearch]:"facet",[ti.facetShowLess]:"facet",[ti.facetShowMore]:"facet",[ti.recommendation]:"recommendation",[ti.likeSmartSnippet]:"smartSnippet",[ti.dislikeSmartSnippet]:"smartSnippet",[ti.expandSmartSnippet]:"smartSnippet",[ti.collapseSmartSnippet]:"smartSnippet",[ti.openSmartSnippetFeedbackModal]:"smartSnippet",[ti.closeSmartSnippetFeedbackModal]:"smartSnippet",[ti.sendSmartSnippetReason]:"smartSnippet",[ti.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[ti.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions"};var ni;!function(e){e.DoesNotAnswer="does_not_answer",e.PartiallyAnswers="partially_answers",e.WasNotAQuestion="was_not_a_question",e.Other="other"}(ni||(ni={}));class ii{constructor(){this.runtime=new Xn,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}sendEvent(){return Promise.resolve()}sendSearchEvent(){return Promise.resolve()}sendClickEvent(){return Promise.resolve()}sendCustomEvent(){return Promise.resolve()}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}}function ai(e){const t=e.join(";");return t.length<=256?t:ai(e.slice(1))}const oi=e=>ai(function(e){let t="";return e.filter((e=>{const r=e!==t;return t=e,r}))}(function(e){return e.map((e=>e.replace(/;/g,"")))}(e)));function si(e){const t="string"==typeof e.partialQueries?e.partialQueries:oi(e.partialQueries),r="string"==typeof e.suggestions?e.suggestions:oi(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}class ci{constructor(e,t){this.opts=e,this.provider=t,this.coveoAnalyticsClient=!1===e.enableAnalytics?new ii:new ei(e)}disable(){this.coveoAnalyticsClient instanceof ei&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new ii}enable(){this.coveoAnalyticsClient=new ei(this.opts)}logInterfaceLoad(){return this.logSearchEvent(ti.interfaceLoad)}logRecommendationInterfaceLoad(){return this.logSearchEvent(ti.recommendationInterfaceLoad)}logRecommendation(){return this.logCustomEvent(ti.recommendation)}logRecommendationOpen(e,t){return this.logClickEvent(ti.recommendationOpen,e,t)}logFetchMoreResults(){return this.logCustomEvent(ti.pagerScrolling,{type:"getMoreResults"})}logInterfaceChange(e){return this.logSearchEvent(ti.interfaceChange,e)}logDidYouMeanAutomatic(){return this.logSearchEvent(ti.didyoumeanAutomatic)}logDidYouMeanClick(){return this.logSearchEvent(ti.didyoumeanClick)}logResultsSort(e){return this.logSearchEvent(ti.resultsSort,e)}logSearchboxSubmit(){return this.logSearchEvent(ti.searchboxSubmit)}logSearchboxClear(){return this.logSearchEvent(ti.searchboxClear)}logSearchboxAsYouType(){return this.logSearchEvent(ti.searchboxAsYouType)}logBreadcrumbFacet(e){return this.logSearchEvent(ti.breadcrumbFacet,e)}logBreadcrumbResetAll(){return this.logSearchEvent(ti.breadcrumbResetAll)}logDocumentQuickview(e,t){return this.logClickEvent(ti.documentQuickview,e,t)}logDocumentOpen(e,t){return this.logClickEvent(ti.documentOpen,e,t)}logOmniboxAnalytics(e){return this.logSearchEvent(ti.omniboxAnalytics,si(e))}logOmniboxFromLink(e){return this.logSearchEvent(ti.omniboxFromLink,si(e))}logSearchFromLink(){return this.logSearchEvent(ti.searchFromLink)}logTriggerNotify(e){return this.logCustomEvent(ti.triggerNotify,e)}logTriggerExecute(e){return this.logCustomEvent(ti.triggerExecute,e)}logTriggerQuery(){const e={query:this.provider.getSearchEventRequestPayload().queryText};return this.logCustomEvent(ti.triggerQuery,e)}logTriggerRedirect(e){const t=Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText});return this.logCustomEvent(ti.triggerRedirect,t)}logPagerResize(e){return this.logCustomEvent(ti.pagerResize,e)}logPagerNumber(e){return this.logCustomEvent(ti.pagerNumber,e)}logPagerNext(e){return this.logCustomEvent(ti.pagerNext,e)}logPagerPrevious(e){return this.logCustomEvent(ti.pagerPrevious,e)}logPagerScrolling(){return this.logCustomEvent(ti.pagerScrolling)}logFacetClearAll(e){return this.logSearchEvent(ti.facetClearAll,e)}logFacetSearch(e){return this.logSearchEvent(ti.facetSearch,e)}logFacetSelect(e){return this.logSearchEvent(ti.facetSelect,e)}logFacetDeselect(e){return this.logSearchEvent(ti.facetDeselect,e)}logFacetExclude(e){return this.logSearchEvent(ti.facetExclude,e)}logFacetUnexclude(e){return this.logSearchEvent(ti.facetUnexclude,e)}logFacetSelectAll(e){return this.logSearchEvent(ti.facetSelectAll,e)}logFacetUpdateSort(e){return this.logSearchEvent(ti.facetUpdateSort,e)}logFacetShowMore(e){return this.logCustomEvent(ti.facetShowMore,e)}logFacetShowLess(e){return this.logCustomEvent(ti.facetShowLess,e)}logQueryError(e){return this.logCustomEvent(ti.queryError,e)}logQueryErrorBack(){return Nr(this,void 0,void 0,(function*(){return yield this.logCustomEvent(ti.queryErrorBack),this.logSearchEvent(ti.queryErrorBack)}))}logQueryErrorRetry(){return Nr(this,void 0,void 0,(function*(){return yield this.logCustomEvent(ti.queryErrorRetry),this.logSearchEvent(ti.queryErrorRetry)}))}logQueryErrorClear(){return Nr(this,void 0,void 0,(function*(){return yield this.logCustomEvent(ti.queryErrorClear),this.logSearchEvent(ti.queryErrorClear)}))}logLikeSmartSnippet(){return this.logCustomEvent(ti.likeSmartSnippet)}logDislikeSmartSnippet(){return this.logCustomEvent(ti.dislikeSmartSnippet)}logExpandSmartSnippet(){return this.logCustomEvent(ti.expandSmartSnippet)}logCollapseSmartSnippet(){return this.logCustomEvent(ti.collapseSmartSnippet)}logOpenSmartSnippetFeedbackModal(){return this.logCustomEvent(ti.openSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return this.logCustomEvent(ti.closeSmartSnippetFeedbackModal)}logSmartSnippetFeedbackReason(e,t){return this.logCustomEvent(ti.sendSmartSnippetReason,{reason:e,details:t})}logExpandSmartSnippetSuggestion(e){return this.logCustomEvent(ti.expandSmartSnippetSuggestion,{documentId:e})}logCollapseSmartSnippetSuggestion(e){return this.logCustomEvent(ti.collapseSmartSnippetSuggestion,{documentId:e})}logCustomEvent(e,t){const r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),n=Object.assign(Object.assign({},this.getBaseCustomEventRequest(r)),{eventType:ri[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(n)}logCustomEventWithType(e,t,r){const n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},this.getBaseCustomEventRequest(n)),{eventType:t,eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(i)}logSearchEvent(e,t){return this.coveoAnalyticsClient.sendSearchEvent(this.getBaseSearchEventRequest(e,t))}logClickEvent(e,t,r,n){const i=Object.assign(Object.assign(Object.assign({},t),this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(i)}getBaseSearchEventRequest(e,t){return Object.assign(Object.assign(Object.assign({},this.getBaseEventRequest(t)),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})}getBaseCustomEventRequest(e){return Object.assign(Object.assign({},this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})}getBaseEventRequest(e){const t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[]})}getOrigins(){return{originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}}const ui=e=>{const t=e.configuration.search.locale.split("-")[0];return t&&2===t.length?t:"en"};const li=(e,t)=>e.search.response.facets.find((e=>e.facetId===t)),di=(e,t)=>e.facetSet[t];const fi=(e,t)=>{const r=li(e,t);if(function(e,t){return!!t&&t.facetId in e.facetSet}(e,r))return r},pi=(e,t)=>{const r=fi(e,t);return r?r.values.filter((e=>"selected"===e.state)):[]};function gi(e){if(!e)return{parents:[],values:[]};let t=[],r=e;for(;r.length&&r[0].children.length;)t=[...t,...r],r=r[0].children;const n=r.find((e=>"selected"===e.state));return n&&(t=[...t,n],r=[]),{parents:t,values:r}}const hi=(e,t)=>{const r=li(e,t);if(function(e,t){return!!t&&t.facetId in e.categoryFacetSet}(e,r))return r},yi=(e,t)=>{const r=hi(e,t);return gi(null==r?void 0:r.values).parents},mi=(e,t)=>{const r=xi(t,e),n=r?r.field:"";return{facetId:e,facetField:n,facetTitle:`${n}_${e}`}};function vi(e,t){const{facetId:r,facetValue:n}=e;return{...mi(r,t),facetValue:"hierarchical"===Ri(t,r)?Ci(t,r):n}}function bi(e){return{facetSet:e.facetSet||{},categoryFacetSet:e.categoryFacetSet||{},dateFacetSet:e.dateFacetSet||{},numericFacetSet:e.numericFacetSet||{},search:e.search||{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]}}}const Si=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),wi=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Oi=e=>({displayValue:e.value,value:e.value}),Ci=(e,t)=>yi(e,t).map((e=>e.value)).join(";"),qi=(e,t)=>{const r=Ci(e,t);return{value:r,valuePosition:1,displayValue:r}},Ii=(e,t)=>({title:`${e.field}_${e.facetId}`,field:e.field,id:e.facetId,facetPosition:t}),xi=(e,t)=>{var r;return e.facetSet[t]||(null===(r=e.categoryFacetSet[t])||void 0===r?void 0:r.request)||e.dateFacetSet[t]||e.numericFacetSet[t]},Ri=(e,t)=>{const r=xi(e,t);return r?r.type:"specific"};class Ai{constructor(e){this.state=e}getLanguage(){return ui(this.state)}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults,getBaseMetadata:this.getBaseMetadata()}}getBaseMetadata(){const{context:e}=this.state,t=(null==e?void 0:e.contextValues)||{},r={};for(const[e,n]of Object.entries(t)){r["context_"+e]=n}return r}getSearchUID(){var e,t;return(null===(e=this.state.search)||void 0===e?void 0:e.response.searchUid)||(null===(t=this.state.recommendation)||void 0===t?void 0:t.searchUid)||""}getPipeline(){return this.state.pipeline||"default"}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}getFacetState(){return(e=>{const t=[];return e.search.response.facets.forEach(((r,n)=>{const i=Ri(e,r.facetId),a=Ii(r,n+1);if("hierarchical"!==i)r.values.forEach(((e,r)=>{if("idle"===e.state)return;const n=Si(e,r+1,i),o="specific"===i?Oi(e):wi(e);t.push({...a,...n,...o})}));else{if(!yi(e,r.facetId).length)return;t.push({...a,...qi(e,r.facetId),facetType:i,state:"selected"})}})),t})(bi(this.state))}mapResultsToAnalyticsDocument(){var e;return null===(e=this.state.search)||void 0===e?void 0:e.response.results.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get queryText(){var e;return(null===(e=this.state.query)||void 0===e?void 0:e.q)||""}get responseTime(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.duration)||0}get numberOfResults(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.response.results.length)||[].length}}const Ei=()=>new ei({}).currentVisitorId,Fi=new sn.HistoryStore;var ji;!function(e){e[e.Search=0]="Search",e[e.Custom=1]="Custom",e[e.Click=2]="Click"}(ji||(ji={}));const ki=(e,t,r,n=(e=>new Ai(e)))=>je(e,(async(e,{getState:i,extra:{analyticsClientMiddleware:a,preprocessRequest:o,logger:s}})=>{const c=(e=>e())(i),u=(({logger:e,state:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new Ai(t)})=>{const a=t.configuration.accessToken,o=t.configuration.analytics.apiBaseUrl,s=t.configuration.analytics.runtimeEnvironment,c=new ci({token:a,endpoint:o,runtimeEnvironment:s,preprocessRequest:n,beforeSendHooks:[r,(t,r)=>(e.info({...r,type:t,endpoint:o,token:a},"Analytics request"),r)]},i);return!1===t.configuration.analytics.enabled&&c.disable(),c})({state:c,logger:s,analyticsClientMiddleware:a,preprocessRequest:o,provider:n(c)}),l=await r(u,c);return s.info({client:u.coveoAnalyticsClient,response:l},"Analytics response"),{analyticsType:t}})),Pi=(e,t)=>{var r;const n=(null===(r=t.search)||void 0===r?void 0:r.response.results.findIndex((({uniqueId:t})=>e.uniqueId===t)))||0;return function(e,t,r){const n=e.raw.collection;return{collectionName:"string"==typeof n?n:"default",documentAuthor:Di(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:_i(e),queryPipeline:r.pipeline||"default"}}(e,n,t)};const Ti=e=>({contentIDKey:"@permanentid",contentIDValue:e.raw.permanentid||""}),Vi={urihash:new Et,sourcetype:new Et,permanentid:new Et},Mi={uniqueId:Yt,raw:new jt({values:Vi}),title:Yt,uri:Yt,clickUri:Yt,rankingModifier:new Et({required:!1,emptyAllowed:!0})};function Di(e){const t=e.raw.author;return Ct(t)?"unknown":Array.isArray(t)?t.join(";"):""+t}function _i(e){const t=e.raw.source;return Ct(t)?"unknown":t}const $i=e=>new St(Mi).validate(function(e){return Object.assign({},...Object.keys(Mi).map((t=>({[t]:e[t]}))),{raw:(t=e.raw,Object.assign({},...Object.keys(Vi).map((e=>({[e]:t[e]})))))});var t}(e)),Li=ki("analytics/didyoumean/click",ji.Search,(e=>e.logDidYouMeanClick())),Ni=ki("analytics/didyoumean/automatic",ji.Search,(e=>e.logDidYouMeanAutomatic())),zi=xe("query/updateQuery",(e=>Zt(e,{q:new Et,enableQuerySyntax:new xt})));var Qi,Ui;e.SortOrder=void 0,(Qi=e.SortOrder||(e.SortOrder={})).Ascending="ascending",Qi.Descending="descending",e.SortBy=void 0,(Ui=e.SortBy||(e.SortBy={})).Relevancy="relevancy",Ui.QRE="qre",Ui.Date="date",Ui.Field="field",Ui.NoSort="nosort";const Bi=t=>{if(Tt(t))return t.map((e=>Bi(e))).join(",");switch(t.by){case e.SortBy.Relevancy:case e.SortBy.QRE:case e.SortBy.NoSort:return t.by;case e.SortBy.Date:return"date "+t.order;case e.SortBy.Field:return`@${t.field} ${t.order}`;default:return""}},Hi=()=>({by:e.SortBy.Relevancy}),Yi=t=>({by:e.SortBy.Date,order:t}),Wi=(t,r)=>({by:e.SortBy.Field,order:r,field:t}),Ji=()=>({by:e.SortBy.QRE}),Ki=()=>({by:e.SortBy.NoSort}),Zi=new jt({values:{by:new Vt({enum:e.SortBy,required:!0}),order:new Vt({enum:e.SortOrder}),field:new Et}});function Xi(){return Bi(Hi())}function Gi(){return ea({})}function ea(e){var t,r;return{context:e.context||{contextValues:{}},facetSet:e.facetSet||{},numericFacetSet:e.numericFacetSet||{},dateFacetSet:e.dateFacetSet||{},categoryFacetSet:e.categoryFacetSet||{},pagination:e.pagination||{firstResult:0,numberOfResults:10,totalCountFiltered:0},query:e.query||{q:"",enableQuerySyntax:!1},advancedSearchQueries:e.advancedSearchQueries||{cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},querySet:e.querySet||{},sortCriteria:e.sortCriteria||Xi(),pipeline:e.pipeline||"default",searchHub:e.searchHub||"default",facetOptions:e.facetOptions||{freezeFacetOrder:!1},facetOrder:null!==(t=e.facetOrder)&&void 0!==t?t:[],debug:null!==(r=e.debug)&&void 0!==r&&r}}function ta(e,t){const r={};e.forEach((e=>r[e.facetId]=e));const n=[];t.forEach((e=>{e in r&&(n.push(r[e]),delete r[e])}));const i=Object.values(r);return[...n,...i]}const ra=ki("search/logFetchMoreResults",ji.Search,(e=>e.logFetchMoreResults())),na=e=>ki("search/queryError",ji.Search,((t,r)=>{var n,i,a;return t.logQueryError({query:(null===(n=r.query)||void 0===n?void 0:n.q)||"",aq:(null===(i=r.advancedSearchQueries)||void 0===i?void 0:i.aq)||"",cq:(null===(a=r.advancedSearchQueries)||void 0===a?void 0:a.cq)||"",dq:"",errorType:e.type,errorMessage:e.message})}))(),ia=async(e,t,r)=>{var n;const i=(new Date).getTime();return{response:await e.search(r),duration:(new Date).getTime()-i,queryExecuted:(null===(n=t.query)||void 0===n?void 0:n.q)||"",requestExecuted:r}},aa=je("search/executeSearch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{const a=t();ga(a);const o=await ia(i.searchAPIClient,a,la(a));if(Nt(o.response))return r(na(o.response.error)),n(o.response.error);if(!ua(a,o.response.success))return r(hr(ea(a))),{...o,response:o.response.success,automaticallyCorrected:!1,originalQuery:ha(a),analyticsAction:e};const{correctedQuery:s}=o.response.success.queryCorrections[0],c=await ca(i.searchAPIClient,s,t,r);if(Nt(c.response))return r(na(c.response.error)),n(c.response.error);const u=o.response.success;return e(r,(()=>sa(o.queryExecuted,o.duration,a,u)),i),r(hr(ea(t()))),{...c,response:{...c.response.success,queryCorrections:o.response.success.queryCorrections},automaticallyCorrected:!0,originalQuery:ha(a),analyticsAction:Ni()}})),oa=je("search/fetchMoreResults",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:{searchAPIClient:i}})=>{const a=t(),o=await ia(i,a,da(a));return Nt(o.response)?(r(na(o.response.error)),n(o.response.error)):(r(hr(ea(a))),{...o,response:o.response.success,automaticallyCorrected:!1,originalQuery:ha(a),analyticsAction:ra()})})),sa=(e,t,r,n)=>{var i,a;return{...r,query:{q:e,enableQuerySyntax:null!==(a=null===(i=r.query)||void 0===i?void 0:i.enableQuerySyntax)&&void 0!==a&&a},search:{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],duration:t,response:n,results:n.results}}},ca=async(e,t,r,n)=>{n(zi({q:t}));const i=await ia(e,r(),la(r()));return n($r(t)),i},ua=(e,t)=>{var r;return!0===(null===(r=e.didYouMean)||void 0===r?void 0:r.enableDidYouMean)&&0===t.results.length&&0!==t.queryCorrections.length},la=e=>{var t;const r=function(e){var t;return ta(function(e){return[...pa(e.facetSet),...pa(e.numericFacetSet),...pa(e.dateFacetSet),...fa(e.categoryFacetSet)]}(e),null!==(t=e.facetOrder)&&void 0!==t?t:[])}(e);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,...e.configuration.analytics.enabled&&{visitorId:Ei()},...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.context&&{context:e.context.contextValues},...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},...r.length&&{facets:r},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.pagination&&{numberOfResults:e.pagination.numberOfResults,firstResult:e.pagination.firstResult},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.facetOptions&&{facetOptions:e.facetOptions},...(null===(t=e.folding)||void 0===t?void 0:t.enabled)&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange}}},da=e=>{var t,r,n,i;return{...la(e),firstResult:(null!==(r=null===(t=e.pagination)||void 0===t?void 0:t.firstResult)&&void 0!==r?r:0)+(null!==(i=null===(n=e.search)||void 0===n?void 0:n.results.length)&&void 0!==i?i:0)}};function fa(e){return Object.values(e||{}).map((e=>e.request))}function pa(e={}){return Object.keys(e).map((t=>e[t]))}const ga=e=>{var t;e.configuration.analytics.enabled&&Fi.addElement({name:"Query",value:(null===(t=e.query)||void 0===t?void 0:t.q)||"",time:JSON.stringify(new Date)})},ha=e=>{var t;return void 0!==(null===(t=e.query)||void 0===t?void 0:t.q)?e.query.q:""};const ya=Re({enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:{correctedQuery:"",wordCorrections:[],originalQuery:""},originalQuery:""},(e=>{e.addCase(Dr,(e=>{e.enableDidYouMean=!0})).addCase(_r,(e=>{e.enableDidYouMean=!1})).addCase(aa.pending,(e=>{e.queryCorrection={correctedQuery:"",wordCorrections:[],originalQuery:""},e.wasAutomaticallyCorrected=!1,e.wasCorrectedTo=""})).addCase(aa.fulfilled,((e,t)=>{e.queryCorrection=t.payload.response.queryCorrections[0]||{correctedQuery:"",wordCorrections:[],originalQuery:""},e.originalQuery=t.payload.originalQuery,e.wasAutomaticallyCorrected=t.payload.automaticallyCorrected})).addCase($r,((e,t)=>{e.wasCorrectedTo=t.payload}))})),ma=xe("facetOptions/update",(e=>Zt(e,{freezeFacetOrder:new xt({required:!1})}))),va=Re({freezeFacetOrder:!1},(e=>{e.addCase(ma,((e,t)=>({...e,...t.payload}))).addCase(aa.fulfilled,(e=>{e.freezeFacetOrder=!1})).addCase(aa.rejected,(e=>{e.freezeFacetOrder=!1})).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.facetOptions)&&void 0!==n?n:e}))})),ba=Yt,Sa={state:new wt({required:!0}),numberOfResults:new qt({required:!0,min:0}),value:new Et({required:!0,emptyAllowed:!0}),path:new Pt({required:!0,each:Yt}),moreValuesAvailable:new xt({required:!1})};function wa(e){e.children.forEach((e=>{wa(e)})),Kt({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},Sa)}const Oa={facetId:ba,field:Yt,delimitingCharacter:new Et({required:!1,emptyAllowed:!0}),filterFacetCount:new xt({required:!1}),injectionDepth:new qt({required:!1,min:0}),numberOfValues:new qt({required:!1,min:1}),sortCriteria:new wt({required:!1}),basePath:new Pt({required:!1,each:Yt}),filterByBasePath:new xt({required:!1})},Ca=xe("categoryFacet/register",(e=>Zt(e,Oa))),qa=xe("categoryFacet/toggleSelectValue",(e=>{try{return Kt(e.facetId,Yt),wa(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Jt(t)}}})),Ia=xe("categoryFacet/deselectAll",(e=>Zt(e,ba))),xa=xe("categoryFacet/updateNumberOfValues",(e=>Zt(e,{facetId:ba,numberOfValues:new qt({required:!0,min:1})}))),Ra=xe("categoryFacet/updateSortCriterion",(e=>Zt(e,{facetId:ba,criterion:new wt})));function Aa(e,t){const{facetId:r,criterion:n}=t,i=e[r];i&&(i.sortCriteria=n)}function Ea(e){e&&(e.currentValues=e.currentValues.map((e=>({...e,state:"idle"}))),e.preventAutoSelect=!0)}function Fa(e,t){e&&(e.numberOfValues=t)}const ja={facetId:ba,captions:new jt({options:{required:!1}}),numberOfValues:new qt({required:!1,min:1}),query:new Et({required:!1,emptyAllowed:!0})},ka={path:new Pt({required:!0,each:Yt}),displayValue:Wt,rawValue:Wt,count:new qt({required:!0,min:0})},Pa=xe("categoryFacet/selectSearchResult",(e=>Zt(e,{facetId:ba,value:new jt({values:ka})}))),Ta=xe("categoryFacetSearch/register",(e=>Zt(e,ja))),Va=xe("facet/deselectAllFacets");function Ma(e,t,r){e.currentValues=function(e,t){if(!e.length)return[];const r=Da(e[0],t);let n=r;for(const r of e.splice(1)){const e=Da(r,t);n.children.push(e),n=e}return n.state="selected",n.retrieveChildren=!0,[r]}(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function Da(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}const _a=Re({},(e=>{e.addCase(Ca,((e,t)=>{const r=t.payload,{facetId:n}=r;if(n in e)return;const i=(a=r,{...$a,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...a});var a;const o=i.numberOfValues;e[n]={request:i,initialNumberOfValues:o}})).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.categoryFacetSet)&&void 0!==n?n:e})).addCase(Or,((e,t)=>{const r=t.payload.cf||{};Object.keys(e).forEach((t=>{Ma(e[t].request,r[t]||[],e[t].initialNumberOfValues)}))})).addCase(Ra,((e,t)=>{var r;const{facetId:n,criterion:i}=t.payload,a=null===(r=e[n])||void 0===r?void 0:r.request;a&&(a.sortCriteria=i)})).addCase(qa,((e,t)=>{var r;const{facetId:n,selection:i,retrieveCount:a}=t.payload,o=null===(r=e[n])||void 0===r?void 0:r.request;if(!o)return;let s=o.currentValues;const{path:c}=i,u=c.slice(0,c.length-1);for(const e of u){const t=s[0];if(e!==t.value)return;t.retrieveChildren=!1,t.state="idle",s=t.children}if(s.length){const e=s[0];return e.retrieveChildren=!0,e.state="selected",void(e.children=[])}const l=function(e,t){const{value:r}=e;return{value:r,state:"selected",children:[],retrieveChildren:!0,retrieveCount:t}}(i,a);s.push(l),o.numberOfValues=1})).addCase(Ia,((e,t)=>{La(e,t.payload)})).addCase(Va,(e=>{Object.keys(e).forEach((t=>La(e,t)))})).addCase(xa,((e,t)=>{var r;const{facetId:n,numberOfValues:i}=t.payload,a=null===(r=e[n])||void 0===r?void 0:r.request;if(a)return a.currentValues.length?void function(e,t){var r;const{facetId:n,numberOfValues:i}=t;let a=null===(r=e[n])||void 0===r?void 0:r.request.currentValues[0];if(!a)return;for(;a.children.length&&"selected"!==(null==a?void 0:a.state);)a=a.children[0];a.retrieveCount=i}(e,t.payload):Fa(a,i)})).addCase(Pa,((e,t)=>{const{facetId:r,value:n}=t.payload,i=e[r];if(!i)return;const a=[...n.path,n.rawValue];Ma(i.request,a,i.initialNumberOfValues)})).addCase(aa.fulfilled,((e,t)=>{const{facets:r}=t.payload.response;r.forEach((t=>{var r;if(!function(e,t){return t.facetId in e}(e,t))return;const n=t.facetId,i=null===(r=e[n])||void 0===r?void 0:r.request;if(!i)return;const a=function(e,t){const r=gi(e.currentValues).parents,n=gi(t.values).parents;return r.length!==n.length}(i,t);i.currentValues=a?[]:i.currentValues,i.preventAutoSelect=!1}))}))})),$a={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0};function La(e,t){const r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}const Na=Re([],(e=>{e.addCase(aa.fulfilled,((e,t)=>t.payload.response.facets.map((e=>e.facetId)))).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.facetOrder)&&void 0!==n?n:e}))}));function za(e,t,r){const{facetId:n}=t;if(e[n])return;const i={...Ja,...t},a=r();e[n]={options:i,isLoading:!1,response:a,initialNumberOfValues:i.numberOfValues,requestId:""}}function Qa(e,t){const{facetId:r,...n}=t,i=e[r];i&&(i.options={...i.options,...n})}function Ua(e,t,r){const n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function Ba(e,t){const r=e[t];r&&(r.isLoading=!1)}function Ha(e,t,r){const{facetId:n,response:i}=t,a=e[n];a&&a.requestId===r&&(a.isLoading=!1,a.response=i)}function Ya(e,t,r){const{facetId:n}=t,i=e[n];i&&(i.requestId="",i.isLoading=!1,i.response=r(),i.options.numberOfValues=i.initialNumberOfValues,i.options.query=Ja.query)}function Wa(e,t){Object.keys(e).forEach((r=>Ya(e,{facetId:r},t)))}const Ja={captions:{},numberOfValues:10,query:""},Ka={facetId:ba,value:new jt({values:{displayValue:Wt,rawValue:Wt,count:new qt({required:!0,min:0})}})},Za=xe("facetSearch/register",(e=>Zt(e,ja))),Xa=xe("facetSearch/update",(e=>Zt(e,ja))),Ga=xe("facetSearch/toggleSelectValue",(e=>Zt(e,Ka)));const eo=e=>ki("analytics/facet/showMore",ji.Search,((t,r)=>{Zt(e,ba);const n=mi(e,bi(r));return t.logFacetShowMore(n)}))(),to=e=>ki("analytics/facet/showLess",ji.Search,((t,r)=>{Zt(e,ba);const n=mi(e,bi(r));return t.logFacetShowLess(n)}))(),ro=e=>ki("analytics/facet/search",ji.Search,((t,r)=>{Zt(e,ba);const n=bi(r),i=mi(e,n);return t.logFacetSearch(i)}))(),no=e=>ki("analytics/facet/sortChange",ji.Search,((t,r)=>{Zt(e,{facetId:ba,criterion:new wt({required:!0})});const{facetId:n,criterion:i}=e,a=bi(r),o={...mi(n,a),criteria:i};return t.logFacetUpdateSort(o)}))(),io=e=>ki("analytics/facet/reset",ji.Search,((t,r)=>{Zt(e,ba);const n=bi(r),i=mi(e,n);return t.logFacetClearAll(i)}))(),ao=e=>ki("analytics/facet/select",ji.Search,((t,r)=>{Zt(e,{facetId:ba,facetValue:Yt});const n=bi(r),i=vi(e,n);return t.logFacetSelect(i)}))(),oo=e=>ki("analytics/facet/deselect",ji.Search,((t,r)=>{Zt(e,{facetId:ba,facetValue:Yt});const n=bi(r),i=vi(e,n);return t.logFacetDeselect(i)}))(),so=e=>ki("analytics/facet/breadcrumb",ji.Search,((t,r)=>{Zt(e,{facetId:ba,facetValue:Yt});const n=vi(e,bi(r));return t.logBreadcrumbFacet(n)}))(),co=e=>{const t=[];let r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t},uo=je("facetSearch/executeSearch",(async(e,{dispatch:t,getState:r,extra:{searchAPIClient:n,validatePayload:i}})=>{const a=r();let o;i(e,Yt),o=fo(a,e)?((e,t)=>{const{captions:r,query:n,numberOfValues:i}=t.facetSearchSet[e].options,{field:a,delimitingCharacter:o,currentValues:s}=t.facetSet[e],c=la(t),u=s.filter((e=>"idle"!==e.state)).map((e=>e.value)),l=`*${n}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,captions:r,numberOfValues:i,query:l,field:a,delimitingCharacter:o,ignoreValues:u,searchContext:c,type:"specific"}})(e,a):((e,t)=>{const r=t.categoryFacetSearchSet[e].options,n=t.categoryFacetSet[e].request,{captions:i,query:a,numberOfValues:o}=r,{field:s,delimitingCharacter:c,basePath:u}=n,l=la(t),d=co(n),f=d.length?[d]:[],p=`*${a}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,basePath:u,captions:i,numberOfValues:o,query:p,field:s,delimitingCharacter:c,ignorePaths:f,searchContext:l,type:"hierarchical"}})(e,a);const s=await n.facetSearch(o);return t(ro(e)),{facetId:e,response:s}})),lo=xe("facetSearch/clearResults",(e=>Zt(e,{facetId:ba}))),fo=(e,t)=>void 0!==e.facetSearchSet&&void 0!==e.facetSet&&void 0!==e.facetSet[t],po=Re({},(e=>{e.addCase(Ta,((e,t)=>{za(e,t.payload,go)})).addCase(Xa,((e,t)=>{Qa(e,t.payload)})).addCase(uo.pending,((e,t)=>{Ua(e,t.meta.arg,t.meta.requestId)})).addCase(uo.rejected,((e,t)=>{Ba(e,t.meta.arg)})).addCase(uo.fulfilled,((e,t)=>{Ha(e,t.payload,t.meta.requestId)})).addCase(lo,((e,{payload:{facetId:t}})=>{Ya(e,{facetId:t},go)})).addCase(aa.fulfilled,(e=>{Wa(e,go)}))}));function go(){return{moreValuesAvailable:!1,values:[]}}const ho=Re({},(e=>{e.addCase(Za,((e,t)=>{za(e,t.payload,yo)})).addCase(Xa,((e,t)=>{Qa(e,t.payload)})).addCase(uo.pending,((e,t)=>{Ua(e,t.meta.arg,t.meta.requestId)})).addCase(uo.rejected,((e,t)=>{Ba(e,t.meta.arg)})).addCase(uo.fulfilled,((e,t)=>{Ha(e,t.payload,t.meta.requestId)})).addCase(lo,((e,{payload:t})=>{Ya(e,t,yo)})).addCase(aa.fulfilled,(e=>{Wa(e,yo)}))}));function yo(){return{moreValuesAvailable:!1,values:[]}}const mo={value:Yt,numberOfResults:new qt({min:0}),state:Yt},vo={facetId:ba,field:new Et({required:!0,emptyAllowed:!0}),delimitingCharacter:new Et({required:!1,emptyAllowed:!0}),filterFacetCount:new xt({required:!1}),injectionDepth:new qt({required:!1,min:0}),numberOfValues:new qt({required:!1,min:1}),sortCriteria:new wt({required:!1})},bo=xe("facet/register",(e=>Zt(e,vo))),So=xe("facet/toggleSelectValue",(e=>Zt(e,{facetId:ba,selection:new jt({values:mo})}))),wo=xe("facet/deselectAll",(e=>Zt(e,ba))),Oo=xe("facet/updateSortCriterion",(e=>Zt(e,{facetId:ba,criterion:new wt({required:!0})}))),Co=xe("facet/updateNumberOfValues",(e=>Zt(e,{facetId:ba,numberOfValues:new qt({required:!0,min:1})}))),qo=xe("facet/updateIsFieldExpanded",(e=>Zt(e,{facetId:ba,isFieldExpanded:new xt({required:!0})}))),Io=xe("facet/updateFreezeCurrentValues",(e=>Zt(e,{facetId:ba,freezeCurrentValues:new xt({required:!0})}))),xo=Re({},(e=>{e.addCase(bo,((e,t)=>{const{facetId:r}=t.payload;var n;r in e||(e[r]=(n=t.payload,{...Ro,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...n}))})).addCase(vr.fulfilled,((e,t)=>{if(t.payload&&0!==Object.keys(t.payload.facetSet).length)return t.payload.facetSet})).addCase(Or,((e,t)=>{const r=t.payload.f||{};Object.keys(e).forEach((t=>{const n=e[t],i=r[t]||[];n.currentValues=i.map(Eo),n.preventAutoSelect=!0,n.numberOfValues=Math.max(i.length,n.numberOfValues)}))})).addCase(So,((e,t)=>{const{facetId:r,selection:n}=t.payload,i=e[r];if(!i)return;const a=i.currentValues.find((e=>e.value===n.value));if(!a)return;const o="selected"===a.state;a.state=o?"idle":"selected",i.freezeCurrentValues=!0,i.preventAutoSelect=!0})).addCase(Io,((e,t)=>{const{facetId:r,freezeCurrentValues:n}=t.payload,i=e[r];i&&(i.freezeCurrentValues=n)})).addCase(wo,((e,t)=>{Ea(e[t.payload])})).addCase(Va,(e=>{Object.keys(e).forEach((t=>{Ea(e[t])}))})).addCase(Oo,((e,t)=>{Aa(e,t.payload)})).addCase(Co,((e,t)=>{const{facetId:r,numberOfValues:n}=t.payload;Fa(e[r],n)})).addCase(qo,((e,t)=>{const{facetId:r,isFieldExpanded:n}=t.payload,i=e[r];i&&(i.isFieldExpanded=n)})).addCase(aa.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>{const r=t.facetId,n=e[r];n&&(n.currentValues=t.values.map(Ao),n.freezeCurrentValues=!1,n.preventAutoSelect=!1)}))})).addCase(Ga,((e,t)=>{const{facetId:r,value:n}=t.payload,i=e[r];if(!i)return;const{rawValue:a}=n,{currentValues:o}=i,s=o.find((e=>e.value===a));if(s)return void(s.state="selected");const c=Eo(a),u=o.findIndex((e=>"idle"===e.state)),l=-1===u?o.length:u,d=o.slice(0,l),f=o.slice(l+1);i.currentValues=[...d,c,...f],i.numberOfValues=i.currentValues.length,i.freezeCurrentValues=!0,i.preventAutoSelect=!0}))})),Ro={delimitingCharacter:">",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic"};function Ao(e){const{value:t,state:r}=e;return{value:t,state:r}}function Eo(e){return{value:e,state:"selected"}}var Fo=Ve((function(e,t){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",a="minute",o="hour",s="day",c="week",u="month",l="quarter",d="year",f="date",p="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},v={s:m,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+m(n,2,"0")+":"+m(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,u),a=r-i<0,o=t.clone().add(n+(a?-1:1),u);return+(-(n+(r-i)/(a?i-o:o-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:c,d:s,D:f,h:o,m:a,s:i,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",S={};S[b]=y;var w=function(e){return e instanceof I},O=function(e,t,r){var n;if(!e)return b;if("string"==typeof e)S[e]&&(n=e),t&&(S[e]=t,n=e);else{var i=e.name;S[i]=e,n=i}return!r&&n&&(b=n),n||!r&&b},C=function(e,t){if(w(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new I(r)},q=v;q.l=O,q.i=w,q.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var I=function(){function y(e){this.$L=O(e.locale,null,!0),this.parse(e)}var m=y.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(q.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(g);if(n){var i=n[2]-1||0,a=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return q},m.isValid=function(){return!(this.$d.toString()===p)},m.isSame=function(e,t){var r=C(e);return this.startOf(t)<=r&&r<=this.endOf(t)},m.isAfter=function(e,t){return C(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<C(e)},m.$g=function(e,t,r){return q.u(e)?this[t]:this.set(r,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var r=this,n=!!q.u(t)||t,l=q.p(e),p=function(e,t){var i=q.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(s)},g=function(e,t){return q.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},h=this.$W,y=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(l){case d:return n?p(1,0):p(31,11);case u:return n?p(1,y):p(0,y+1);case c:var b=this.$locale().weekStart||0,S=(h<b?h+7:h)-b;return p(n?m-S:m+(6-S),y);case s:case f:return g(v+"Hours",0);case o:return g(v+"Minutes",1);case a:return g(v+"Seconds",2);case i:return g(v+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var r,c=q.p(e),l="set"+(this.$u?"UTC":""),p=(r={},r[s]=l+"Date",r[f]=l+"Date",r[u]=l+"Month",r[d]=l+"FullYear",r[o]=l+"Hours",r[a]=l+"Minutes",r[i]=l+"Seconds",r[n]=l+"Milliseconds",r)[c],g=c===s?this.$D+(t-this.$W):t;if(c===u||c===d){var h=this.clone().set(f,1);h.$d[p](g),h.init(),this.$d=h.set(f,Math.min(this.$D,h.daysInMonth())).$d}else p&&this.$d[p](g);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[q.p(e)]()},m.add=function(n,l){var f,p=this;n=Number(n);var g=q.p(l),h=function(e){var t=C(p);return q.w(t.date(t.date()+Math.round(e*n)),p)};if(g===u)return this.set(u,this.$M+n);if(g===d)return this.set(d,this.$y+n);if(g===s)return h(1);if(g===c)return h(7);var y=(f={},f[a]=t,f[o]=r,f[i]=e,f)[g]||1,m=this.$d.getTime()+n*y;return q.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this;if(!this.isValid())return p;var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=q.z(this),i=this.$locale(),a=this.$H,o=this.$m,s=this.$M,c=i.weekdays,u=i.months,l=function(e,n,i,a){return e&&(e[n]||e(t,r))||i[n].substr(0,a)},d=function(e){return q.s(a%12||12,e,"0")},f=i.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:q.s(s+1,2,"0"),MMM:l(i.monthsShort,s,u,3),MMMM:l(u,s),D:this.$D,DD:q.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,c,2),ddd:l(i.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(a),HH:q.s(a,2,"0"),h:d(1),hh:d(2),a:f(a,o,!0),A:f(a,o,!1),m:String(o),mm:q.s(o,2,"0"),s:String(this.$s),ss:q.s(this.$s,2,"0"),SSS:q.s(this.$ms,3,"0"),Z:n};return r.replace(h,(function(e,t){return t||g[e]||n.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(n,f,p){var g,h=q.p(f),y=C(n),m=(y.utcOffset()-this.utcOffset())*t,v=this-y,b=q.m(this,y);return b=(g={},g[d]=b/12,g[u]=b,g[l]=b/3,g[c]=(v-m)/6048e5,g[s]=(v-m)/864e5,g[o]=v/r,g[a]=v/t,g[i]=v/e,g)[h]||v,p?b:q.a(b)},m.daysInMonth=function(){return this.endOf(u).$D},m.$locale=function(){return S[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=O(e,t,!0);return n&&(r.$L=n),r},m.clone=function(){return q.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},y}(),x=I.prototype;return C.prototype=x,[["$ms",n],["$s",i],["$m",a],["$H",o],["$W",s],["$M",u],["$y",d],["$D",f]].forEach((function(e){x[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,I,C),e.$i=!0),C},C.locale=O,C.isDayjs=w,C.unix=function(e){return C(1e3*e)},C.en=S[b],C.Ls=S,C.p={},C}()}));const jo={state:Yt,start:new qt({required:!0}),end:new qt({required:!0}),endInclusive:new xt({required:!0}),numberOfResults:new qt({required:!0,min:0})},ko={start:Yt,end:Yt,endInclusive:new xt({required:!0}),state:Yt,numberOfResults:new qt({required:!0,min:0})},Po=e=>({facetId:ba,selection:"string"==typeof e.start?new jt({values:ko}):new jt({values:jo})});var To=Ve((function(e,t){e.exports=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,i,a){var o=i.prototype;a.utc=function(e){return new i({date:e,utc:!0,args:arguments})},o.utc=function(t){var r=a(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},o.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var s=o.parse;o.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var c=o.init;o.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else c.call(this)};var u=o.utcOffset;o.utcOffset=function(n,i){var a=this.$utils().u;if(a(n))return this.$u?0:a(this.$offset)?u.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var i=(""+n[0]).match(r)||["-",0,0],a=i[0],o=60*+i[1]+ +i[2];return 0===o?0:"+"===a?o:-o}(n)))return this;var o=Math.abs(n)<=16?60*n:n,s=this;if(i)return s.$offset=o,s.$u=0===n,s;if(0!==n){var c=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(o+c,e)).$offset=o,s.$x.$localOffset=c}else s=this.utc();return s};var l=o.format;o.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},o.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var d=o.toDate;o.toDate=function(e){return"s"===e&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=o.diff;o.diff=function(e,t,r){if(e&&this.$u===e.$u)return f.call(this,e,t,r);var n=this.local(),i=a(e).local();return f.call(n,i,t,r)}}}()})),Vo=Ve((function(e,t){e.exports=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^\s\d-_:/()]+/,a={},o=function(e){return function(t){this[e]=+t}},s=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],c=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var r,n=a.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},l={A:[i,function(e){this.afternoon=u(e,!1)}],a:[i,function(e){this.afternoon=u(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,o("seconds")],ss:[n,o("seconds")],m:[n,o("minutes")],mm:[n,o("minutes")],H:[n,o("hours")],h:[n,o("hours")],HH:[n,o("hours")],hh:[n,o("hours")],D:[n,o("day")],DD:[r,o("day")],Do:[i,function(e){var t=a.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,o("month")],MM:[r,o("month")],MMM:[i,function(e){var t=c("months"),r=(c("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,o("year")],YY:[r,function(e){e=+e,this.year=e+(e>68?1900:2e3)}],YYYY:[/\d{4}/,o("year")],Z:s,ZZ:s};function d(r){var n,i;n=r,i=a&&a.formats;for(var o=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var a=n&&n.toUpperCase();return r||i[n]||e[n]||i[a].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),s=o.length,c=0;c<s;c+=1){var u=o[c],d=l[u],f=d&&d[0],p=d&&d[1];o[c]=p?{regex:f,parser:p}:u.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<s;r+=1){var i=o[r];if("string"==typeof i)n+=i.length;else{var a=i.regex,c=i.parser,u=e.substr(n),l=a.exec(u)[0];c.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0;var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,o=e.args;this.$u=n;var s=o[1];if("string"==typeof s){var c=!0===o[2],u=!0===o[3],l=c||u,f=o[2];u&&(f=o[2]),a=this.$locale(),!c&&f&&(a=r.Ls[f]),this.$d=function(e,t,r){try{var n=d(t)(e),i=n.year,a=n.month,o=n.day,s=n.hours,c=n.minutes,u=n.seconds,l=n.milliseconds,f=n.zone,p=new Date,g=o||(i||a?1:p.getDate()),h=i||p.getFullYear(),y=0;i&&!a||(y=a>0?a-1:p.getMonth());var m=s||0,v=c||0,b=u||0,S=l||0;return f?new Date(Date.UTC(h,y,g,m,v,b,S+60*f.offset*1e3)):r?new Date(Date.UTC(h,y,g,m,v,b,S)):new Date(h,y,g,m,v,b,S)}catch(e){return new Date("")}}(t,s,n),this.init(),f&&!0!==f&&(this.$L=this.locale(f).$L),l&&t!==this.format(s)&&(this.$d=new Date("")),a={}}else if(s instanceof Array)for(var p=s.length,g=1;g<=p;g+=1){o[1]=s[g-1];var h=r.apply(this,o);if(h.isValid()){this.$d=h.$d,this.$L=h.$L,this.init();break}g===p&&(this.$d=new Date(""))}else i.call(this,e)}}}()}));function Mo(e){return $o(Fo(e))===e}function Do(e){var t,r;return{start:_o(e.start,e),end:_o(e.end,e),endInclusive:null!==(t=e.endInclusive)&&void 0!==t&&t,state:null!==(r=e.state)&&void 0!==r?r:"idle"}}function _o(e,t){const{dateFormat:r,useLocalTime:n}=t,i=Fo(e,r);if(!i.isValid())throw new Error(`Could not parse the provided date "${e}".\n      Please provide a dateFormat string in the configuration options.\n      See https://day.js.org/docs/en/parse/string-format for more information.\n       `);return $o(n?i:i.utc())}function $o(e){return e.format("YYYY/MM/DD@HH:mm:ss")}Fo.extend(To),Fo.extend(Vo);const Lo=xe("rangeFacet/updateSortCriterion",(e=>Zt(e,{facetId:ba,criterion:new wt({required:!0})}))),No={start:Yt,end:Yt,endInclusive:new xt({required:!0}),state:Yt},zo={facetId:ba,field:Yt,currentValues:new Pt({required:!1,each:new jt({values:No})}),generateAutomaticRanges:new xt({required:!0}),filterFacetCount:new xt({required:!1}),injectionDepth:new qt({required:!1,min:0}),numberOfValues:new qt({required:!1,min:1}),sortCriteria:new wt({required:!1}),rangeAlgorithm:new wt({required:!1})};function Qo(e){e.currentValues&&e.currentValues.forEach((e=>{const{start:t,end:r}=Do(e);if(Fo(t).isAfter(Fo(r)))throw new Error(`The start value is greater than the end value for the date range ${e.start} to ${e.end}`)}))}const Uo=xe("dateFacet/register",(e=>{try{return Kt(e,zo),Qo(e),{payload:e,error:null}}catch(t){return{payload:e,error:Jt(t)}}})),Bo=xe("dateFacet/toggleSelectValue",(e=>Zt(e,{facetId:ba,selection:new jt({values:ko})}))),Ho=xe("dateFacet/updateFacetValues",(e=>{try{return Kt(e,{facetId:ba,values:new Pt({each:new jt({values:ko})})}),Qo({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Jt(t)}}})),Yo=Lo,Wo=wo,Jo={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even"};function Ko(e,t){const{facetId:r}=t;if(r in e)return;const n=ns(t);e[r]={...t,numberOfValues:n}}function Zo(e,t,r){const n=e[t];n&&(n.currentValues=r,n.numberOfValues=ns(n))}function Xo(e,t,r){const n=e[t];if(!n)return;const i=rs(n.currentValues,r);if(!i)return;const a="selected"===i.state;i.state=a?"idle":"selected",n.preventAutoSelect=!0}function Go(e,t){const r=e[t];r&&r.currentValues.forEach((e=>e.state="idle"))}function es(e,t){Object.entries(e).forEach((([e,r])=>{const n=t[e]||[];r.currentValues.forEach((e=>{const t=!!rs(n,e);return e.state=t?"selected":"idle",e}));const i=n.filter((e=>!rs(r.currentValues,e))),a=r.currentValues;a.push(...i),r.numberOfValues=Math.max(r.numberOfValues,a.length)}))}function ts(e,t,r){t.forEach((t=>{const n=t.facetId,i=e[n];if(!i)return;const a=r(t.values);i.currentValues=a,i.preventAutoSelect=!1}))}function rs(e,t){const{start:r,end:n}=t;return e.find((e=>e.start===r&&e.end===n))}function ns(e){const{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}const is=Re({},(e=>{e.addCase(Uo,((e,t)=>{const{payload:r}=t;var n;Ko(e,(n=r,{...Jo,currentValues:[],preventAutoSelect:!1,type:"dateRange",...n}))})).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.dateFacetSet)&&void 0!==n?n:e})).addCase(Or,((e,t)=>{es(e,t.payload.df||{})})).addCase(Bo,((e,t)=>{const{facetId:r,selection:n}=t.payload;Xo(e,r,n)})).addCase(Ho,((e,t)=>{const{facetId:r,values:n}=t.payload;Zo(e,r,n)})).addCase(Wo,((e,t)=>{Go(e,t.payload)})).addCase(Va,(e=>{Object.keys(e).forEach((t=>{Go(e,t)}))})).addCase(Yo,((e,t)=>{Aa(e,t.payload)})).addCase(aa.fulfilled,((e,t)=>{ts(e,t.payload.response.facets,as)}))}));function as(e){return e.map((e=>{const{numberOfResults:t,...r}=e;return r}))}const os={state:Yt,start:new qt({required:!0}),end:new qt({required:!0}),endInclusive:new xt({required:!0})},ss={facetId:ba,field:Yt,currentValues:new Pt({required:!1,each:new jt({values:os})}),generateAutomaticRanges:new xt({required:!0}),filterFacetCount:new xt({required:!1}),injectionDepth:new qt({required:!1,min:0}),numberOfValues:new qt({required:!1,min:1}),sortCriteria:new wt({required:!1}),rangeAlgorithm:new wt({required:!1})};function cs(e){e.currentValues&&e.currentValues.forEach((({start:e,end:t})=>{if(e>t)throw new Error(`The start value is greater than the end value for the numeric range ${e} to ${t}`)}))}const us=xe("numericFacet/register",(e=>{try{return Zt(e,ss),cs(e),{payload:e,error:null}}catch(t){return{payload:e,error:Jt(t)}}})),ls=xe("numericFacet/toggleSelectValue",(e=>Zt(e,{facetId:ba,selection:new jt({values:jo})}))),ds=xe("numericFacet/updateFacetValues",(e=>{try{return Kt(e,{facetId:ba,values:new Pt({each:new jt({values:jo})})}),cs({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Jt(t)}}})),fs=Lo,ps=wo,gs=Re({},(e=>{e.addCase(us,((e,t)=>{const{payload:r}=t;var n;Ko(e,(n=r,{...Jo,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...n}))})).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.numericFacetSet)&&void 0!==n?n:e})).addCase(Or,((e,t)=>{es(e,t.payload.nf||{})})).addCase(ls,((e,t)=>{const{facetId:r,selection:n}=t.payload;Xo(e,r,n)})).addCase(ds,((e,t)=>{const{facetId:r,values:n}=t.payload;Zo(e,r,n)})).addCase(ps,((e,t)=>{Go(e,t.payload)})).addCase(Va,(e=>{Object.keys(e).forEach((t=>{Go(e,t)}))})).addCase(fs,((e,t)=>{Aa(e,t.payload)})).addCase(aa.fulfilled,((e,t)=>{ts(e,t.payload.response.facets,hs)}))}));function hs(e){return e.map((e=>{const{numberOfResults:t,...r}=e;return r}))}const ys=new Pt({each:Yt,required:!0}),ms=xe("fields/registerFieldsToInclude",(e=>Zt(e,ys))),vs={collectionField:new Et,parentField:new Et,childField:new Et,numberOfFoldedResults:new qt({min:0})},bs=xe("folding/register",(e=>Zt(e,vs))),Ss=je("folding/loadCollection",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const{folding:{fields:i},configuration:{accessToken:a,organizationId:o,search:{apiBaseUrl:s}}}=t(),c=await n.search({tab:"",referrer:"",accessToken:a,organizationId:o,url:s,aq:`@${i.collection} = ${e}`,numberOfResults:100});return Nt(c)?r(c.error):{collectionId:e,results:c.success.results}})),ws=Re({fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},(e=>e.addCase(ms,((e,t)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(t.payload))]})).addCase(bs,((e,{payload:t})=>{var r,n,i;const a={collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"};e.fieldsToInclude.push(null!==(r=t.collectionField)&&void 0!==r?r:a.collection,null!==(n=t.parentField)&&void 0!==n?n:a.parent,null!==(i=t.childField)&&void 0!==i?i:a.child)})))),Os=(e,t=5)=>e+Math.random().toString(36).substr(2,2+t);function Cs(e){return Array.isArray(e)}function qs(e){return""===e.trim()}function Is(e,t){return e.raw[t.parent]}function xs(e,t){const r=e.raw[t.child];return Cs(r)?r[0]:r}function Rs(e){return e.childResults?e.childResults.flatMap((e=>[e,...Rs(e)])):[]}function As(e,t,r,n=[]){const i=xs(e,r);return i?-1!==n.indexOf(i)?[]:t.filter((t=>{const n=xs(t,r)===xs(e,r);return Is(t,r)===i&&!n})).map((e=>({result:e,children:As(e,t,r,[...n,i])}))):[]}function Es(e,t){return e.find((e=>{const r=void 0===Is(e,t),n=(i=Is(e,t),a=xs(e,t),void 0!==(i||a)&&i===a);var i,a;return r||n}))}function Fs(e){const t=Rs(e),r=[e,...t].filter((e=>e.parentResult)).map((e=>e.parentResult));var n,i;return n=[e,...t,...r],i=e=>e.uniqueId,Object.values(n.reduce(((e,t,r)=>({...e,[i(t,r)]:t})),{}))}function js(e,t){const r={};return e.forEach((e=>{const n=function(e,t){return e.raw[t.collection]}(e,t);n&&xs(e,t)&&(r[n]=function(e,t){var r;const n=Fs(e),i=null!==(r=Es(n,t))&&void 0!==r?r:e;return{result:i,children:As(i,n,t),moreResultsAvailable:!0,isLoadingMoreResults:!1}}(e,t))})),r}const ks=Re({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}},(e=>e.addCase(aa.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?js(t.response.results,e.fields):{}})).addCase(oa.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?{...e.collections,...js(t.response.results,e.fields)}:{}})).addCase(bs,((e,{payload:t})=>{var r,n,i,a;return e.enabled?e:{enabled:!0,collections:{},fields:{collection:null!==(r=t.collectionField)&&void 0!==r?r:e.fields.collection,parent:null!==(n=t.parentField)&&void 0!==n?n:e.fields.parent,child:null!==(i=t.childField)&&void 0!==i?i:e.fields.child},filterFieldRange:null!==(a=t.numberOfFoldedResults)&&void 0!==a?a:e.filterFieldRange}})).addCase(Ss.pending,((e,{meta:t})=>{const r=t.arg;e.collections[r].isLoadingMoreResults=!0})).addCase(Ss.rejected,((e,{meta:t})=>{const r=t.arg;e.collections[r].isLoadingMoreResults=!1})).addCase(Ss.fulfilled,((e,{payload:{collectionId:t,results:r}})=>{const n=Es(r,e.fields);n&&(e.collections[t]={result:n,children:As(n,r,e.fields),moreResultsAvailable:!1,isLoadingMoreResults:!1})}))));const Ps=Ve((function(e,t){!function(e){var t="function"==typeof WeakSet,r=Object.keys;function n(e,t){return e===t||e!=e&&t!=t}function i(e){return e.constructor===Object||null==e.constructor}function a(e){return!!e&&"function"==typeof e.then}function o(e){return!(!e||!e.$$typeof)}function s(){var e=[];return{add:function(t){e.push(t)},has:function(t){return-1!==e.indexOf(t)}}}var c=t?function(){return new WeakSet}:s;function u(e){return function(t){var r=e||t;return function(e,t,n){void 0===n&&(n=c());var i=!!e&&"object"==typeof e,a=!!t&&"object"==typeof t;if(i||a){var o=i&&n.has(e),s=a&&n.has(t);if(o||s)return o&&s;i&&n.add(e),a&&n.add(t)}return r(e,t,n)}}}function l(e,t,r,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!r(e[i],t[i],n))return!1;return!0}function d(e,t,r,n){var i=e.size===t.size;return i&&e.size&&e.forEach((function(e,a){i&&(i=!1,t.forEach((function(t,o){!i&&r(a,o,n)&&(i=r(e,t,n))})))})),i}var f="_owner",p=Function.prototype.bind.call(Function.prototype.call,Object.prototype.hasOwnProperty);function g(e,t,n,i){var a=r(e),s=a.length;if(r(t).length!==s)return!1;if(s)for(var c=void 0;s-- >0;){if((c=a[s])===f){var u=o(e),l=o(t);if((u||l)&&u!==l)return!1}if(!p(t,c)||!n(e[c],t[c],i))return!1}return!0}function h(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex}function y(e,t,r,n){var i=e.size===t.size;return i&&e.size&&e.forEach((function(e){i&&(i=!1,t.forEach((function(t){i||(i=r(e,t,n))})))})),i}var m="function"==typeof Map,v="function"==typeof Set;function b(e){var t="function"==typeof e?e(r):r;function r(e,r,o){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(i(e)&&i(r))return g(e,r,t,o);var s=Array.isArray(e),c=Array.isArray(r);return s||c?s===c&&l(e,r,t,o):(s=e instanceof Date,c=r instanceof Date,s||c?s===c&&n(e.getTime(),r.getTime()):(s=e instanceof RegExp,c=r instanceof RegExp,s||c?s===c&&h(e,r):a(e)||a(r)?e===r:m&&(s=e instanceof Map,c=r instanceof Map,s||c)?s===c&&d(e,r,t,o):v&&(s=e instanceof Set,c=r instanceof Set,s||c)?s===c&&y(e,r,t,o):g(e,r,t,o)))}return e!=e&&r!=r}return r}var S=b(),w=b((function(){return n})),O=b(u()),C=b(u(n));e.circularDeepEqual=O,e.circularShallowEqual=C,e.createCustomEqual=b,e.deepEqual=S,e.sameValueZeroEqual=n,e.shallowEqual=w,Object.defineProperty(e,"__esModule",{value:!0})}(t)})).createCustomEqual((e=>(t,r)=>Array.isArray(t)&&Array.isArray(r)?t.length===r.length&&t.every((t=>-1!==r.findIndex((r=>e(t,r))))):e(t,r))),Ts=Re(Gi(),(e=>{e.addCase(hr,((e,t)=>Vs(e,t.payload)?void 0:t.payload))})),Vs=(e,t)=>Ms(e.context,t.context)&&Ns(e.advancedSearchQueries,t.advancedSearchQueries)&&Ds(e.facetSet,t.facetSet)&&Ds(e.dateFacetSet,t.dateFacetSet)&&Ds(e.numericFacetSet,t.numericFacetSet)&&_s(e.categoryFacetSet,t.categoryFacetSet)&&$s(e.pagination,t.pagination)&&Ls(e.query,t.query)&&zs(e,t)&&Qs(e.pipeline,t.pipeline)&&Us(e.searchHub,t.searchHub)&&Bs(e.facetOrder,t.facetOrder)&&Hs(e.debug,t.debug),Ms=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),Ds=(e,t)=>{for(const[r,n]of Object.entries(t)){if(!e[r])return!1;const t=e[r].currentValues.filter((e=>"selected"===e.state)),i=n.currentValues.filter((e=>"selected"===e.state));if(JSON.stringify(t)!==JSON.stringify(i))return!1}return!0},_s=(e,t)=>{var r;for(const[n,i]of Object.entries(t)){if(!e[n])return!1;const t=gi(null===(r=e[n])||void 0===r?void 0:r.request.currentValues).parents.map((({value:e})=>e)),a=gi(null==i?void 0:i.request.currentValues).parents.map((({value:e})=>e));if(JSON.stringify(t)!==JSON.stringify(a))return!1}return!0},$s=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,Ls=(e,t)=>JSON.stringify(e)===JSON.stringify(t),Ns=(e,t)=>JSON.stringify(e)===JSON.stringify(t),zs=(e,t)=>e.sortCriteria===t.sortCriteria,Qs=(e,t)=>e===t,Us=(e,t)=>e===t,Bs=(e,t)=>{return n=t,(r=e).length===n.length&&-1===r.findIndex(((e,t)=>n[t]!==e));var r,n},Hs=(e,t)=>e===t,Ys=new qt({required:!0,min:0}),Ws=xe("pagination/registerNumberOfResults",(e=>Zt(e,Ys))),Js=xe("pagination/updateNumberOfResults",(e=>Zt(e,Ys))),Ks=xe("pagination/registerPage",(e=>Zt(e,Ys))),Zs=xe("pagination/updatePage",(e=>Zt(e,Ys))),Xs=xe("pagination/nextPage"),Gs=xe("pagination/previousPage"),ec=Re({firstResult:0,numberOfResults:10,totalCountFiltered:0},(e=>{e.addCase(Ws,((e,t)=>{const r=rc(e),n=t.payload;e.numberOfResults=n,e.firstResult=nc(r,n)})).addCase(Js,((e,t)=>{e.numberOfResults=t.payload,e.firstResult=0})).addCase(Ks,((e,t)=>{const r=t.payload;e.firstResult=nc(r,e.numberOfResults)})).addCase(Zs,((e,t)=>{const r=t.payload;e.firstResult=nc(r,e.numberOfResults)})).addCase(Gs,(e=>{const t=rc(e),r=Math.max(t-1,1);e.firstResult=nc(r,e.numberOfResults)})).addCase(Xs,(e=>{const t=rc(e),r=function(e){const{totalCountFiltered:t,numberOfResults:r}=e;return ac(t,r)}(e),n=Math.min(t+1,r);e.firstResult=nc(n,e.numberOfResults)})).addCase(vr.fulfilled,((e,t)=>{t.payload&&(e.numberOfResults=t.payload.pagination.numberOfResults,e.firstResult=t.payload.pagination.firstResult)})).addCase(Or,((e,t)=>{var r,n;e.firstResult=null!==(r=t.payload.firstResult)&&void 0!==r?r:e.firstResult,e.numberOfResults=null!==(n=t.payload.numberOfResults)&&void 0!==n?n:e.numberOfResults})).addCase(aa.fulfilled,((e,t)=>{const{response:r}=t.payload;e.totalCountFiltered=r.totalCountFiltered})).addCase(wo,(e=>{tc(e)})).addCase(So,(e=>{tc(e)})).addCase(Ia,(e=>{tc(e)})).addCase(qa,(e=>{tc(e)})).addCase(Pa,(e=>{tc(e)})).addCase(Bo,(e=>{tc(e)})).addCase(ls,(e=>{tc(e)})).addCase(Va,(e=>{tc(e)})).addCase(Ho,(e=>{tc(e)})).addCase(ds,(e=>{tc(e)})).addCase(Ga,(e=>{tc(e)}))}));function tc(e){e.firstResult=0}function rc(e){const{firstResult:t,numberOfResults:r}=e;return ic(t,r)}function nc(e,t){return(e-1)*t}function ic(e,t){return e/t+1}function ac(e,t){const r=Math.min(e,1e3);return Math.ceil(r/t)}const oc=xe("pipeline/set",(e=>Zt(e,new Et({required:!0,emptyAllowed:!0})))),sc=Re("default",(e=>{e.addCase(oc,((e,t)=>t.payload)).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.pipeline)&&void 0!==n?n:e})).addCase(ar,((e,t)=>t.payload.pipeline||e))})),cc=["permanentid","ec_name","ec_brand","ec_category","ec_price","ec_promo_price","ec_shortdesc","ec_thumbnails","ec_images","ec_in_stock","ec_rating"];class uc{constructor(e){this.state=e,this.initialState={id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0}}getLanguage(){return ui(this.state)}getSearchEventRequestPayload(){return{queryText:"",responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getBaseMetadata(){var e;return{recommendation:(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.id)||this.initialState.id}}getSearchUID(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.searchUid)||this.initialState.searchUid}getPipeline(){return""}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2||"default"}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}mapResultsToAnalyticsDocument(){return[]}get responseTime(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.duration)||this.initialState.duration}get numberOfResults(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.recommendations.length)||this.initialState.recommendations.length}}const lc=ki("analytics/productrecommendations/load",ji.Search,(e=>e.logRecommendationInterfaceLoad()),(e=>new uc(e))),dc=xe("productrecommendations/setId",(e=>Zt(e,{id:Yt}))),fc=xe("productrecommendations/setSku",(e=>Zt(e,{skus:new Pt({required:!0,min:1,each:new Et({emptyAllowed:!1})})}))),pc=xe("productrecommendations/setBrand",(e=>Zt(e,{brand:new Et({required:!0,emptyAllowed:!0})}))),gc=xe("productrecommendations/setCategory",(e=>Zt(e,{category:new Et({required:!0,emptyAllowed:!0})}))),hc=xe("productrecommendations/setAdditionalFields",(e=>Zt(e,{additionalFields:new Pt({required:!0,each:new Et({emptyAllowed:!1})})}))),yc=xe("productrecommendations/setMaxNumberOfRecommendations",(e=>Zt(e,{number:new qt({required:!0,max:50,min:1})}))),mc=je("productrecommendations/get",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const i=t(),a=(new Date).getTime(),o=await n.productRecommendations(bc(i)),s=(new Date).getTime()-a;if(Nt(o))return r(o.error);const c=i.productRecommendations.additionalFields||[];return{recommendations:o.success.results.map((e=>vc(e,{additionalFields:c}))),analyticsAction:lc(),searchUid:o.success.searchUid,duration:s}})),vc=(e,{additionalFields:t})=>{const r=e.raw.ec_price,n=e.raw.ec_promo_price,i=e.raw.ec_in_stock;return{permanentid:e.raw.permanentid,clickUri:e.clickUri,ec_name:e.raw.ec_name,ec_brand:e.raw.ec_brand,ec_category:e.raw.ec_category,ec_price:r,ec_shortdesc:e.raw.ec_shortdesc,ec_thumbnails:e.raw.ec_thumbnails,ec_images:e.raw.ec_images,ec_promo_price:void 0===n||void 0!==r&&n>=r?void 0:n,ec_in_stock:void 0===i?void 0:"yes"===i.toLowerCase()||"true"===i.toLowerCase(),ec_rating:e.raw.ec_rating,additionalFields:t.reduce(((t,r)=>({...t,[r]:e.raw[r]})),{})}},bc=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,...e.configuration.analytics.enabled&&{visitorId:Ei()},recommendation:e.productRecommendations.id,numberOfResults:e.productRecommendations.maxNumberOfRecommendations,fieldsToInclude:[...cc,...e.productRecommendations.additionalFields||[]],mlParameters:{...e.productRecommendations.skus&&e.productRecommendations.skus.length>0&&{itemIds:e.productRecommendations.skus},...e.productRecommendations.filter.brand&&{brandFilter:e.productRecommendations.filter.brand},...e.productRecommendations.filter.category&&{categoryFilter:e.productRecommendations.filter.category}},actionsHistory:e.configuration.analytics.enabled?Fi.getHistory():[],...e.context&&{context:e.context.contextValues},...e.searchHub&&{searchHub:e.searchHub}});Re({id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0},(e=>{e.addCase(dc,((e,t)=>{e.id=t.payload.id})).addCase(fc,((e,t)=>{e.skus=t.payload.skus})).addCase(pc,((e,t)=>{e.filter.brand=t.payload.brand})).addCase(gc,((e,t)=>{e.filter.category=t.payload.category})).addCase(yc,((e,t)=>{e.maxNumberOfRecommendations=t.payload.number})).addCase(hc,((e,t)=>{e.additionalFields=t.payload.additionalFields})).addCase(mc.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(mc.fulfilled,((e,t)=>{e.error=null,e.searchUid=t.payload.searchUid,e.recommendations=t.payload.recommendations,e.isLoading=!1})).addCase(mc.pending,(e=>{e.isLoading=!0}))}));const Sc={id:Yt,query:Wt},wc=xe("querySet/register",(e=>Zt(e,Sc))),Oc=xe("querySet/update",(e=>Zt(e,Sc))),Cc={id:Yt},qc=xe("querySuggest/register",(e=>Zt(e,{...Cc,q:new Et,count:new qt({min:0})}))),Ic=xe("querySuggest/unregister",(e=>Zt(e,Cc))),xc=xe("querySuggest/selectSuggestion",(e=>Zt(e,{...Cc,expression:Wt}))),Rc=xe("querySuggest/clear",(e=>Zt(e,Cc))),Ac=je("querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n,validatePayload:i}})=>{i(e,Cc);const a=e.id,o=await n.querySuggest(Ec(a,t()));return Nt(o)?r({id:a,...o.error}):{id:a,...o.success}})),Ec=(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySuggest[e].q,locale:t.configuration.search.locale,actionsHistory:t.configuration.analytics.enabled?Fi.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub}}),Fc=Re({},(e=>{e.addCase(wc,((e,t)=>{const{id:r,query:n}=t.payload;r in e||(e[r]=n)})).addCase(Oc,((e,t)=>{const{id:r,query:n}=t.payload;jc(e,r,n)})).addCase(xc,((e,t)=>{const{id:r,expression:n}=t.payload;jc(e,r,n)})).addCase(aa.fulfilled,((e,t)=>{const{queryExecuted:r}=t.payload;Object.keys(e).forEach((t=>e[t]=r))})).addCase(vr.fulfilled,((e,t)=>{if(t.payload)for(const[r,n]of Object.entries(t.payload.querySet))jc(e,r,n)}))})),jc=(e,t,r)=>{t in e&&(e[t]=r)},kc=Re({},(e=>e.addCase(qc,((e,t)=>{e[t.payload.id]={id:"",completions:[],count:5,q:"",currentRequestId:"",error:null,partialQueries:[],...t.payload}})).addCase(Ic,((e,t)=>{delete e[t.payload.id]})).addCase(Ac.pending,((e,t)=>{e[t.meta.arg.id].currentRequestId=t.meta.requestId})).addCase(Ac.fulfilled,((e,t)=>{var r;const n=t.meta.arg.id;if(t.meta.requestId===(null===(r=e[n])||void 0===r?void 0:r.currentRequestId)){const{q:r}=e[n];r&&e[n].partialQueries.push(r.replace(/;/,encodeURIComponent(";"))),e[n].completions=t.payload.completions}})).addCase(Ac.rejected,((e,t)=>{e[t.payload.id].error=t.payload})).addCase(Oc,((e,t)=>{const{id:r,query:n}=t.payload;r in e&&(e[r].q=n)})).addCase(Rc,((e,t)=>{const{id:r}=t.payload;e[r].q="",e[r].completions=[],e[r].partialQueries=[]})).addCase(xc,((e,t)=>{const{id:r,expression:n}=t.payload;e[r].q=n})))),Pc=Re({q:"",enableQuerySyntax:!1},(e=>e.addCase(zi,((e,t)=>({...e,...t.payload}))).addCase($r,((e,t)=>{e.q=t.payload})).addCase(xc,((e,t)=>{e.q=t.payload.expression})).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.query)&&void 0!==n?n:e})).addCase(Or,((e,t)=>{var r,n;e.q=null!==(r=t.payload.q)&&void 0!==r?r:e.q,e.enableQuerySyntax=null!==(n=t.payload.enableQuerySyntax)&&void 0!==n?n:e.enableQuerySyntax})))),Tc=()=>new jt({values:{documentId:new jt({values:{contentIdKey:new Et({required:!0,emptyAllowed:!1}),contentIdValue:new Et({required:!0,emptyAllowed:!1})}})},options:{required:!0}}),Vc=xe("smartSnippet/expand"),Mc=xe("smartSnippet/collapse"),Dc=xe("smartSnippet/like"),_c=xe("smartSnippet/dislike"),$c=xe("smartSnippet/related/expand",(e=>Zt(e,Tc()))),Lc=xe("smartSnippet/related/collapse",(e=>Zt(e,Tc()))),Nc=(e,t)=>e.findIndex((e=>e.contentIdValue===t.contentIdValue&&e.contentIdKey===t.contentIdKey)),zc=Re({liked:!1,disliked:!1,expanded:!1,relatedQuestions:[]},(e=>e.addCase(Vc,(e=>{e.expanded=!0})).addCase(Mc,(e=>{e.expanded=!1})).addCase(Dc,(e=>{e.liked=!0,e.disliked=!1})).addCase(_c,(e=>{e.liked=!1,e.disliked=!0})).addCase(aa.fulfilled,((e,t)=>{e.relatedQuestions=t.payload.response.questionAnswer.relatedQuestions.map((e=>({contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1})))})).addCase($c,((e,t)=>{const r=Nc(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!0)})).addCase(Lc,((e,t)=>{const r=Nc(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!1)})))),Qc=ki("analytics/recommendation/update",ji.Search,(e=>e.logRecommendationInterfaceLoad())),Uc=xe("recommendation/set",(e=>Zt(e,{id:Yt}))),Bc=je("recommendation/get",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const i=t(),a=(new Date).getTime(),o=await n.recommendations(Hc(i)),s=(new Date).getTime()-a;return Nt(o)?r(o.error):{recommendations:o.success.results,analyticsAction:Qc(),duration:s,searchUid:o.success.searchUid}})),Hc=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,recommendation:e.recommendation.id,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,actionsHistory:e.configuration.analytics.enabled?Fi.getHistory():[],...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.context&&{context:e.context.contextValues},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude}});function Yc(e){return"notify"===e.type}function Wc(e){return"redirect"===e.type}function Jc(e){return"query"===e.type}function Kc(e){return"execute"===e.type}Re({duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[],searchUid:""},(e=>{e.addCase(Uc,((e,t)=>{e.id=t.payload.id})).addCase(Bc.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(Bc.fulfilled,((e,t)=>{e.error=null,e.recommendations=t.payload.recommendations,e.duration=t.payload.duration,e.isLoading=!1,e.searchUid=t.payload.searchUid})).addCase(Bc.pending,(e=>{e.isLoading=!0}))}));class Zc{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){const e=this.response.preprocessingOutput.triggers.filter(Wc);return e.length?e[0].content:null}}const Xc=ki("analytics/redirection",ji.Search,((e,t)=>{var r;if(null===(r=t.redirection)||void 0===r?void 0:r.redirectTo)return e.logTriggerRedirect({redirectedTo:t.redirection.redirectTo})})),Gc=je("redirection/check",(async(e,{dispatch:t,getState:r,rejectWithValue:n,extra:{searchAPIClient:i,validatePayload:a}})=>{a(e,{defaultRedirectionUrl:new Et({emptyAllowed:!1,url:!0})});const o=await i.plan(eu(r()));if(Nt(o))return n(o.error);const s=new Zc(o.success).redirectionUrl;return s&&t(Xc()),s||e.defaultRedirectionUrl})),eu=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub}}),tu=Re({redirectTo:null},(e=>e.addCase(Gc.fulfilled,((e,t)=>{e.redirectTo=t.payload}))));const ru=je("resultPreview/fetchResultContent",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{const i=function(e,t){var r;const{search:n,accessToken:i,organizationId:a}=e.configuration,o=(null===(r=e.query)||void 0===r?void 0:r.q)||"";return{url:n.apiBaseUrl,accessToken:i,organizationId:a,enableNavigation:!1,q:o,...t,requestedOutputSize:t.requestedOutputSize||0}}(r(),e),a=await t.searchAPIClient.html(i);return Nt(a)?n(a.error):{content:a.success,uniqueId:e.uniqueId}}));const nu=Re({uniqueId:"",content:"",isLoading:!1},(e=>{e.addCase(ru.pending,(e=>{e.isLoading=!0})).addCase(ru.fulfilled,((e,t)=>{const{content:r,uniqueId:n}=t.payload;e.content=r,e.uniqueId=n,e.isLoading=!1}))})),iu=xe("searchHub/set",(e=>Zt(e,new Et({required:!0,emptyAllowed:!0})))),au=Re("default",(e=>{e.addCase(iu,((e,t)=>t.payload)).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.searchHub)&&void 0!==n?n:e})).addCase(ar,((e,t)=>t.payload.searchHub||e))}));function ou(e,t){e.error=t.payload?t.payload:null,e.isLoading=!1}function su(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function cu(e){e.isLoading=!0}const uu=Re({response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]},(e=>{e.addCase(aa.rejected,ou),e.addCase(oa.rejected,ou),e.addCase(aa.fulfilled,((e,t)=>{su(e,t),e.results=t.payload.response.results})),e.addCase(oa.fulfilled,((e,t)=>{su(e,t),e.results=[...e.results,...t.payload.response.results]})),e.addCase(aa.pending,cu),e.addCase(oa.pending,cu)})),lu={by:new Vt({enum:e.SortBy,required:!0})},du=xe("sortCriteria/register",(e=>pu(e))),fu=xe("sortCriteria/update",(e=>pu(e))),pu=e=>Tt(e)?(e.forEach((e=>Zt(e,lu))),{payload:e}):Zt(e,lu),gu=Re(Xi(),(e=>{e.addCase(du,((e,t)=>Bi(t.payload))).addCase(fu,((e,t)=>Bi(t.payload))).addCase(vr.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.sortCriteria)&&void 0!==n?n:e})).addCase(Or,((e,t)=>{var r;return null!==(r=t.payload.sortCriteria)&&void 0!==r?r:e}))})),hu=Re({redirectTo:"",query:"",execute:{functionName:"",params:[]},notification:""},(e=>e.addCase(aa.fulfilled,((e,t)=>{const r=t.payload.response.triggers.filter(Wc);e.redirectTo=r.length?r[0].content:"";const n=t.payload.response.triggers.filter(Jc);e.query=n.length?n[0].content:"";const i=t.payload.response.triggers.filter(Kc);e.execute=i.length?{functionName:i[0].content.name,params:i[0].content.params}:{functionName:"",params:[]};const a=t.payload.response.triggers.filter(Yc);e.notification=a.length?a[0].content:""})))),yu=e=>({past:[],present:e,future:[]}),mu=Ir,vu=ec,bu=xo,Su=ho,wu=uu,Ou=ks,Cu=is,qu=Na,Iu=gs,xu=_a,Ru=va,Au=po,Eu=Pc,Fu=Cr,ju=Fc,ku=tu,Pu=kc,Tu=gu,Vu=jr,Mu=ya,Du=ws,_u=sc,$u=au,Lu=Tr,Nu=nu,zu=Mr,Qu=hu,Uu=zc,Bu=(e=>{const{actionTypes:t,reducer:r}=e,n=yu();return(e=n,i)=>{switch(i.type){case t.undo:return(e=>{const{past:t,present:r,future:n}=e;if(!r)return e;if(0===t.length)return e;const i=t[t.length-1];return{past:t.slice(0,t.length-1),present:i,future:[r,...n]}})(e);case t.redo:return(e=>{const{past:t,present:r,future:n}=e;return r?0===n.length?e:{past:[...t,r],present:n[0],future:n.slice(1)}:e})(e);case t.snapshot:return(e=>{const{action:t,state:r,reducer:n}=e,{past:i,present:a}=r,o=n(a,t);return a?a===o?r:{past:[...i,a],present:o,future:[]}:yu(o)})({state:e,reducer:r,action:i});default:return e}}})({actionTypes:{redo:gr.type,undo:pr.type,snapshot:hr.type},reducer:Ts});function Hu(e,t){let r=0;const n=function(e,t,r){var n,i,a;void 0===t&&(t=50),void 0===r&&(r={});var o=null!=(n=r.isImmediate)&&n,s=null!=(i=r.callback)&&i,c=r.maxWait,u=Date.now(),l=[];function d(){if(void 0!==c){var e=Date.now()-u;if(e+t>=c)return c-e}return t}var f=function(){var t=[].slice.call(arguments),r=this;return new Promise((function(n,i){var c=o&&void 0===a;if(void 0!==a&&clearTimeout(a),a=setTimeout((function(){if(a=void 0,u=Date.now(),!o){var n=e.apply(r,t);s&&s(n),l.forEach((function(e){return(0,e.resolve)(n)})),l=[]}}),d()),c){var f=e.apply(r,t);return s&&s(f),n(f)}l.push({resolve:n,reject:i})}))};return f.cancel=function(e){void 0!==a&&clearTimeout(a),l.forEach((function(t){return(0,t.reject)(e)})),l=[]},f}((()=>r=0),500);return i=>a=>async o=>{if(!("function"==typeof o))return a(o);const s=await a(o);if(!function(e){var t;return(null===(t=e.error)||void 0===t?void 0:t.name)===(new ut).name}(s))return s;if("function"!=typeof t)return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),s;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),s;r++,n();const c=await async function(e){try{return await e()}catch(e){return""}}(t);i.dispatch(ir({accessToken:c})),i.dispatch(o)}}const Yu=e=>t=>r=>{var n,i;const a=null===(n=r.payload)||void 0===n?void 0:n.analyticsAction;void 0!==a&&(null===(i=r.payload)||void 0===i||delete i.analyticsAction);const o=t(r);return r.type===aa.fulfilled.type&&void 0===a&&console.error("No analytics action associated with search:",r),r.type===Bc.fulfilled&&void 0===a&&console.error("No analytics action associated with recommendation:",r),r.type===mc.fulfilled&&void 0===a&&console.error("No analytics action associated with product recommendation:",r),void 0!==a&&e.dispatch(a),o},Wu={configuration:mu,version:zu};function Ju(e,t){const r=function(e,t){const{reducers:r}=e,n=function(e){const t={...e};return{get combinedReducer(){return re(t)},add(e){Object.keys(e).filter((e=>!(e in t))).forEach((r=>t[r]=e[r]))}}}({...Wu,...r}),i=t.logger,a=function(e,t,r){const{preloadedState:n,configuration:i}=e,a=i.name||"coveo-headless",o=function(e,t){const{renewAccessToken:r}=e.configuration;return[Hu(t,r),dr(t),Yu].concat(e.middlewares||[])}(e,t.logger);return function({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:i}){return Ie({reducer:e,preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e,name:i},middleware:e=>[...r,...e({thunk:{extraArgument:n}}),fr(n.logger)]})}({preloadedState:n,reducer:r.combinedReducer,middlewares:o,thunkExtraArguments:t,name:a})}(e,t,n);return{addReducers(e){n.add(e),a.replaceReducer(n.combinedReducer)},dispatch:a.dispatch,subscribe:a.subscribe,enableAnalytics(){a.dispatch(cr())},disableAnalytics(){a.dispatch(sr())},get state(){return a.getState()},logger:i,store:a}}(e,t),{accessToken:n,organizationId:i,platformUrl:a,analytics:o}=e.configuration;if(r.dispatch(ir({accessToken:n,organizationId:i,platformUrl:a})),o){const{analyticsClientMiddleware:e,...t}=o;r.dispatch(or(t))}return r}function Ku(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}var Zu=function(e,t,r){var n=r&&r.stringify||Ku;if("object"==typeof e&&null!==e){var i=t.length+1;if(1===i)return e;var a=new Array(i);a[0]=n(e);for(var o=1;o<i;o++)a[o]=n(t[o]);return a.join(" ")}if("string"!=typeof e)return e;var s=t.length;if(0===s)return e;for(var c="",u=0,l=-1,d=e&&e.length||0,f=0;f<d;){if(37===e.charCodeAt(f)&&f+1<d){switch(l=l>-1?l:0,e.charCodeAt(f+1)){case 100:case 102:if(u>=s)break;if(l<f&&(c+=e.slice(l,f)),null==t[u])break;c+=Number(t[u]),l=f+=2;break;case 105:if(u>=s)break;if(l<f&&(c+=e.slice(l,f)),null==t[u])break;c+=Math.floor(Number(t[u])),l=f+=2;break;case 79:case 111:case 106:if(u>=s)break;if(l<f&&(c+=e.slice(l,f)),void 0===t[u])break;var p=typeof t[u];if("string"===p){c+="'"+t[u]+"'",l=f+2,f++;break}if("function"===p){c+=t[u].name||"<anonymous>",l=f+2,f++;break}c+=n(t[u]),l=f+2,f++;break;case 115:if(u>=s)break;l<f&&(c+=e.slice(l,f)),c+=String(t[u]),l=f+2,f++;break;case 37:l<f&&(c+=e.slice(l,f)),c+="%",l=f+2,f++,u--}++u}++f}if(-1===l)return e;l<d&&(c+=e.slice(l));return c};var Xu=tl;const Gu=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},el={mapHttpRequest:ul,mapHttpResponse:ul,wrapRequestSerializer:ll,wrapResponseSerializer:ll,wrapErrorSerializer:ll,req:ul,res:ul,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}};function tl(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");const r=e.browser.write||Gu;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=function(e,t){if(Array.isArray(e))return e.filter((function(e){return"!stdSerializers.err"!==e}));return!0===e&&Object.keys(t)}(e.browser.serialize,n);let a=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);"function"==typeof r&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),!1===e.enabled&&(e.level="silent");const o=e.level||"info",s=Object.create(r);s.log||(s.log=dl),Object.defineProperty(s,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(s,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,rl(c,s,"error","log"),rl(c,s,"fatal","error"),rl(c,s,"warn","error"),rl(c,s,"info","log"),rl(c,s,"debug","log"),rl(c,s,"trace","log")}});const c={transmit:t,serialize:i,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:cl(e)};return s.levels=tl.levels,s.level=o,s.setMaxListeners=s.getMaxListeners=s.emit=s.addListener=s.on=s.prependListener=s.once=s.prependOnceListener=s.removeListener=s.removeAllListeners=s.listeners=s.listenerCount=s.eventNames=s.write=s.flush=dl,s.serializers=n,s._serialize=i,s._stdErrSerialize=a,s.child=function(r){if(!r)throw new Error("missing bindings for child Pino");const a=r.serializers;if(i&&a){var o=Object.assign({},n,a),s=!0===e.browser.serialize?Object.keys(o):i;delete r.serializers,il([r],s,o,this._stdErrSerialize)}function c(e){this._childLevel=1+(0|e._childLevel),this.error=al(e,r,"error"),this.fatal=al(e,r,"fatal"),this.warn=al(e,r,"warn"),this.info=al(e,r,"info"),this.debug=al(e,r,"debug"),this.trace=al(e,r,"trace"),o&&(this.serializers=o,this._serialize=s),t&&(this._logEvent=sl([].concat(e._logEvent.bindings,r)))}return c.prototype=this,new c(this)},t&&(s._logEvent=sl()),s}function rl(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?dl:i[r]?i[r]:Gu[r]||Gu[n]||dl,function(e,t,r){if(!e.transmit&&t[r]===dl)return;t[r]=(n=t[r],function(){const i=e.timestamp(),a=new Array(arguments.length),o=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Gu?Gu:this;for(var s=0;s<a.length;s++)a[s]=arguments[s];if(e.serialize&&!e.asObject&&il(a,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(o,nl(this,r,a,i)):n.apply(o,a),e.transmit){const n=e.transmit.level||t.level,o=tl.levels.values[n],s=tl.levels.values[r];if(s<o)return;ol(this,{ts:i,methodLevel:r,methodValue:s,transmitLevel:n,transmitValue:tl.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},a)}});var n}(e,t,r)}function nl(e,t,r,n){e._serialize&&il(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let a=i[0];const o={};n&&(o.time=n),o.level=tl.levels.values[t];let s=1+(0|e._childLevel);if(s<1&&(s=1),null!==a&&"object"==typeof a){for(;s--&&"object"==typeof i[0];)Object.assign(o,i.shift());a=i.length?Zu(i.shift(),i):void 0}else"string"==typeof a&&(a=Zu(i.shift(),i));return void 0!==a&&(o.msg=a),o}function il(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=tl.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(const n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function al(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function ol(e,t,r){const n=t.send,i=t.ts,a=t.methodLevel,o=t.methodValue,s=t.val,c=e._logEvent.bindings;il(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return-1===c.indexOf(e)})),e._logEvent.level.label=a,e._logEvent.level.value=o,n(a,e._logEvent,s),e._logEvent=sl(c)}function sl(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function cl(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?fl:pl}function ul(){return{}}function ll(e){return e}function dl(){}function fl(){return!1}function pl(){return Date.now()}tl.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},tl.stdSerializers=el,tl.stdTimeFunctions=Object.assign({},{nullTime:fl,epochTime:pl,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}});const gl=e=>e;function hl(e,t){return{analyticsClientMiddleware:function(e){const{analytics:t}=e,r=(e,t)=>t;return(null==t?void 0:t.analyticsClientMiddleware)||r}(e),validatePayload:Kt,preprocessRequest:function(e){return e.preprocessRequest||gl}(e),logger:t}}const yl={organizationId:Yt,accessToken:Yt,platformUrl:new Et({required:!1,emptyAllowed:!1}),name:new Et({required:!1,emptyAllowed:!1}),analytics:new jt({options:{required:!1},values:{enabled:new xt({required:!1}),originLevel2:new Et({required:!1}),originLevel3:new Et({required:!1})}})};const ml=new St({...yl,search:new jt({options:{required:!1},values:{pipeline:new Et({required:!1,emptyAllowed:!1}),searchHub:new Et({required:!1,emptyAllowed:!1}),locale:tr}})});const vl=e=>Zt(e,{evt:Yt,type:new Et({required:!1,emptyAllowed:!1})}),bl=e=>ki("analytics/generic/search",ji.Search,(t=>{vl(e);const{evt:r,meta:n}=e;return t.logSearchEvent(r,n)}))(),Sl=e=>ki("analytics/generic/click",ji.Click,((t,r)=>($i(e.result),vl(e),t.logClickEvent(e.evt,Pi(e.result,r),Ti(e.result)))))(),wl=e=>ki("analytics/generic/custom",ji.Custom,(t=>(vl(e),t.logCustomEventWithType(e.evt,e.type,e.meta))))(),Ol=ki("analytics/interface/load",ji.Search,(e=>e.logInterfaceLoad())),Cl=ki("analytics/interface/change",ji.Search,((e,t)=>{var r;return e.logInterfaceChange({interfaceChangeTo:(null===(r=t.advancedSearchQueries)||void 0===r?void 0:r.cq)||""})})),ql=ki("analytics/interface/searchFromLink",ji.Search,(e=>e.logSearchFromLink())),Il=e=>ki("analytics/interface/omniboxFromLink",ji.Search,(t=>t.logOmniboxFromLink(e)))();function xl(e){return""!==e.search.response.searchUid}const Rl={debug:Lu,pipeline:_u,searchHub:$u,search:wu};function Al(e){let t;return{subscribe(r){return r(),t=JSON.stringify(this.state),e.subscribe((()=>{(e=>{try{const r=JSON.stringify(e),n=t!==r;return t=r,n}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}})(this.state)&&r()}))},get state(){return{}}}}const El=e=>{const t=/^(\w+(?:\s\w+)*): ([-0-9]+)$/;if(!e)return null;const r=e.match(/(\w+(?:\s\w+)*): ([-0-9]+)/g);if(!r)return null;const n={};for(const e of r){const r=e.match(t);if(r){const e=r[1],t=r[2];n[e]=Number(t)}}return n},Fl=(e,t)=>{const r=[];let n;for(;null!==(n=t.exec(e));)r.push(n);return r},jl=e=>{const t=/([^:]+): ([0-9]+), ([0-9]+); /g;if(!e||!e[1])return null;const r=Fl(e[1],/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g);if(!r)return null;const n={};for(const e of r){const r=Fl(e[1],t),i={};for(const e of r)i[e[1]]={Correlation:Number(e[2]),"TF-IDF":Number(e[3])};const a=El(e[2]);n[Object.keys(i).join(", ")]={terms:i,Weights:a}}return n},kl=e=>{const t=/(Expression:\s".*")\sScore:\s(?!0)([0-9]+)\n+/g;let r=t.exec(e);const n=[];for(;r;)n.push({expression:r[1],score:parseInt(r[2],10)}),r=t.exec(e);return n};function Pl(e){return e.search.response.results.map((e=>({result:e,ranking:(e=>{if(!e)return null;const t=/Document weights:\n((?:.)*?)\n+/g.exec(e),r=/Terms weights:\n((?:.|\n)*)\n+/g.exec(e),n=/Total weight: ([0-9]+)/g.exec(e),i=kl(e);return{documentWeights:El(t?t[1]:null),termsWeight:jl(r),totalWeight:n?Number(n[1]):null,qreWeights:i}})(e.rankingInfo)})))}const Tl=new St({enabled:new xt({default:!1})});function Vl(e,t){const r=e.dispatch,{options:n,getFacetSearch:i}=t,{facetId:a}=n;return{updateText(e){r(Xa({facetId:a,query:e,numberOfValues:i().initialNumberOfValues}))},showMoreResults(){const{initialNumberOfValues:e,options:t}=i();r(Xa({facetId:a,numberOfValues:t.numberOfValues+e})),r(uo(a))},search(){r(uo(a))},select(e){const t=e.rawValue;r(ma({freezeFacetOrder:!0})),r(aa(ao({facetId:a,facetValue:t})))},clear(){r(lo({facetId:a}))},get state(){const{response:e,isLoading:t,options:r}=i(),{query:n}=r,a=e.values;return{...e,values:a,isLoading:t,query:n}}}}const Ml=je("categoryFacetController/executeToggleSelect",(({facetId:e,selection:t,retrieveCount:r},{dispatch:n,extra:{validatePayload:i}})=>{i(e,Yt),wa(t);const a=((e,t)=>{const r={facetId:e,facetValue:t.value};return"selected"===t.state?oo(r):ao(r)})(e,t);n(qa({facetId:e,selection:t,retrieveCount:r})),n(ma({freezeFacetOrder:!0})),n(aa(a))})),Dl=je("categoryFacetController/executeDeselectAll",(({facetId:e},{dispatch:t,extra:{validatePayload:r}})=>{r({facetId:e},{facetId:ba}),t(Ia(e)),t(ma({freezeFacetOrder:!0})),t(aa(io(e)))})),_l=new Et({regex:/^[a-zA-Z0-9-_]+$/}),$l=new Et({required:!0}),Ll=new Pt({each:new Et}),Nl=new Et,zl=new xt,Ql=new xt,Ul=new qt({min:0}),Bl=new qt({min:1}),Hl=new xt({required:!0}),Yl=new jt,Wl=new Et,Jl=new jt({values:{captions:Yl,numberOfValues:Bl,query:Wl}}),Kl=new St({field:$l,basePath:Ll,delimitingCharacter:Nl,facetId:_l,facetSearch:Jl,filterByBasePath:zl,filterFacetCount:Ql,injectionDepth:Ul,numberOfValues:Bl,sortCriteria:new Et({constrainTo:["alphanumeric","occurrences"]})});function Zl(e,t){const{field:r,state:n}=e;if(!function(e){const{field:t,state:r}=e;return Xl(r).some((e=>e&&t in e))}(e))return r;const i=r+"_",a=function(e,t){const r=Xl(t);return function(e,t){const r=0,n=e.map((e=>{const n=e.split(t)[1],i=parseInt(n,10);return Number.isNaN(i)?r:i})).sort().pop();return null!=n?n:r}(r.map((e=>Object.keys(e||{}))).reduce(((e,t)=>e.concat(t)),[]),e)+1}(i,n);return function(e,t){const r=`A facet with field "${e}" already exists.\n  To avoid unexpected behaviour, configure the #id option on the facet controller.`;t.warn(r)}(r,t),`${i}${a}`}function Xl(e){const{facetSet:t,numericFacetSet:r,dateFacetSet:n,categoryFacetSet:i}=e;return[t,r,n,i]}function Gl(e,t){const{state:r,logger:n}=e,{field:i,facetId:a}=t;return a||Zl({field:i,state:r},n)}const ed=e=>"selected"===e.state,td={facetId:ba,selection:new jt({values:mo})},rd=je("facet/executeToggleSelect",(({facetId:e,selection:t},{dispatch:r,extra:{validatePayload:n}})=>{const i=((e,t)=>{const r={facetId:e,facetValue:t.value};return ed(t)?oo(r):ao(r)})(e,t);n({facetId:e,selection:t},td),r(So({facetId:e,selection:t})),r(ma({freezeFacetOrder:!0})),r(aa(i))})),nd=new St({facetId:_l,field:$l,delimitingCharacter:Nl,filterFacetCount:Ql,injectionDepth:Ul,numberOfValues:Bl,sortCriteria:new Et({constrainTo:["score","alphanumeric","occurrences","automatic"]}),facetSearch:Jl});const id=e=>"selected"===e.state;function ad(e,t){const{facetId:r,getRequest:n}=t,i=Al(e),a=e.dispatch;return{...i,isValueSelected:id,deselectAll(){a(wo(r)),a(ma({freezeFacetOrder:!0})),a(aa(io(r)))},sortBy(e){a(Lo({facetId:r,criterion:e})),a(ma({freezeFacetOrder:!0})),a(aa(no({facetId:r,criterion:e})))},isSortedBy(e){return this.state.sortCriterion===e},get state(){const t=n(),i=li(e.state,r),a=t.sortCriteria,o=i?i.values:[],s=e.state.search.isLoading,c=o.some((e=>"idle"!==e.state));return{facetId:r,values:o,sortCriterion:a,hasActiveValues:c,isLoading:s}}}}function od(e,t){if(!e.generateAutomaticRanges&&void 0===e.currentValues){throw new Error(`currentValues should be specified for ${t} when generateAutomaticRanges is false.`)}}const sd=je("rangeFacet/executeToggleSelect",(({facetId:e,selection:t},{dispatch:r,extra:{validatePayload:n}})=>{n({facetId:e,selection:t},Po(t));const i=((e,t)=>{const r={facetId:e,facetValue:`${t.start}..${t.end}`};return id(t)?oo(r):ao(r)})(e,t);r(ma({freezeFacetOrder:!0})),r(aa(i))})),cd={facetId:ba,selection:new jt({values:ko})},ud=je("dateFacet/executeToggleSelect",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,cd),t(Bo(e)),t(sd(e))})),ld=["idle","selected"],dd=["ascending","descending"],fd=["even","equiprobable"],pd={start:new Et,end:new Et,endInclusive:new xt,state:new Et({constrainTo:ld})},gd=new St({facetId:_l,field:$l,generateAutomaticRanges:Hl,filterFacetCount:Ql,injectionDepth:Ul,numberOfValues:Bl,currentValues:new Pt({each:new jt({values:pd})}),sortCriteria:new Et({constrainTo:dd}),rangeAlgorithm:new Et({constrainTo:fd})});function hd(e,t){Gt(e,gd,t,"buildDateFacet"),Qo(t)}const yd={facetId:ba,selection:new jt({values:jo})},md=je("numericFacet/executeToggleSelect",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,yd),t(ls(e)),t(sd(e))})),vd={start:new qt,end:new qt,endInclusive:new xt,state:new Et({constrainTo:ld})},bd=new St({facetId:_l,field:$l,generateAutomaticRanges:Hl,filterFacetCount:Ql,injectionDepth:Ul,numberOfValues:Bl,currentValues:new Pt({each:new jt({values:vd})}),sortCriteria:new Et({constrainTo:dd}),rangeAlgorithm:new Et({constrainTo:fd})});function Sd(e,t){Gt(e,bd,t,"buildNumericFacet"),cs(t)}function wd(e){return{endInclusive:!1,state:"idle",...e}}const Od=(e,t)=>{const r=((e,t)=>{const r=li(e,t);if(function(e,t){return!!t&&t.facetId in e.numericFacetSet}(e,r))return r})(e,t);return r?r.values.filter((e=>"selected"===e.state)):[]};const Cd=(e,t)=>{const r=((e,t)=>{const r=li(e,t);if(function(e,t){return!!t&&t.facetId in e.dateFacetSet}(e,r))return r})(e,t);return r?r.values.filter((e=>"selected"===e.state)):[]};const qd=ki("history/analytics/forward",ji.Search,(e=>e.logSearchEvent("historyForward"))),Id=ki("history/analytics/backward",ji.Search,(e=>e.logSearchEvent("historyBackward")));function xd(e){return e.pagination.numberOfResults}const Rd=pe((function(e){return e.pagination.firstResult}),xd,ic),Ad=pe((function(e){return e.pagination.totalCountFiltered}),xd,ac),Ed=pe(Rd,Ad,((e,t)=>t),((e,t,r)=>{let n=function(e,t){const r=t%2==0,n=Math.floor(t/2);return{start:e-n,end:e+(r?n-1:n)}}(e,r);return n=function(e){const t=Math.max(1-e.start,0),r=e.start+t,n=e.end+t;return{start:r,end:n}}(n),n=function(e,t){const r=Math.max(e.end-t,0),n=Math.max(e.start-r,1),i=e.end-r;return{start:n,end:i}}(n,t),function(e){const t=[];for(let r=e.start;r<=e.end;++r)t.push(r);return t}(n)}));const Fd=ki("analytics/pager/resize",ji.Search,((e,t)=>{var r;return e.logPagerResize({currentResultsPerPage:(null===(r=t.pagination)||void 0===r?void 0:r.numberOfResults)||10})})),jd=ki("analytics/pager/number",ji.Search,((e,t)=>e.logPagerNumber({pagerNumber:Rd(t)}))),kd=ki("analytics/pager/next",ji.Search,((e,t)=>e.logPagerNext({pagerNumber:Rd(t)}))),Pd=ki("analytics/pager/previous",ji.Search,((e,t)=>e.logPagerPrevious({pagerNumber:Rd(t)}))),Td=new St({numberOfPages:new qt({default:5,min:0})}),Vd=new St({page:new qt({min:1})});function Md(e){!function(e){e.addReducers({search:wu})}(e);const t=Al(e);return{...t,get state(){const t=e.state;return{hasError:null!==t.search.error,isLoading:t.search.isLoading,hasResults:!!t.search.results.length,firstSearchExecuted:xl(t)}}}}const Dd=new St({fieldsToInclude:new Pt({required:!1,each:new Et({required:!0,emptyAllowed:!1})})});function _d(e,t){!function(e){e.addReducers({search:wu,configuration:mu,fields:Du})}(e);const r=Al(e),n=Md(e),{dispatch:i}=e,a=Gt(e,Dd,null==t?void 0:t.options,"buildResultList");a.fieldsToInclude&&i(ms(a.fieldsToInclude));const o=()=>e.state.search.results.length<e.state.search.response.totalCountFiltered;let s=0,c=0;let u=!1;return{...r,get state(){const t=e.state;return{...n.state,results:t.search.results,searchUid:t.search.response.searchUid,moreResultsAvailable:o()}},fetchMoreResults:()=>{if(e.state.search.isLoading)return;if(!o())return void e.logger.info("No more results are available for the result list to fetch.");if(Date.now()-s<200){if(c++,c>=5)return s=Date.now(),!u&&e.logger.error('The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively 5 times, with little delay. Please verify the conditions under which the function is called.'),void(u=!0)}else c=0;u=!1,i(oa()).then((()=>s=Date.now()))}}}const $d=e=>(e=>ki("analytics/result/open",ji.Click,((t,r)=>($i(e),t.logDocumentOpen(Pi(e,r),Ti(e))))))(e)();const Ld=new St({numberOfResults:new qt({min:0})});const Nd=ki("analytics/searchbox/submit",ji.Search,(e=>e.logSearchboxSubmit())),zd={enableQuerySyntax:!1,numberOfSuggestions:5},Qd={open:new Et,close:new Et},Ud={id:Yt,numberOfSuggestions:new qt({min:0}),enableQuerySyntax:new xt,highlightOptions:new jt({values:{notMatchDelimiters:new jt({values:Qd}),exactMatchDelimiters:new jt({values:Qd}),correctionDelimiters:new jt({values:Qd})}})},Bd=new St(Ud),Hd=e=>ki("analytics/querySuggest",ji.Search,((t,r)=>{const n=Yd(r,e);return t.logOmniboxAnalytics(n)}))();function Yd(e,t){const{id:r,suggestion:n}=t,i=e.querySuggest&&e.querySuggest[r];if(!i)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);const a=i.completions.map((e=>e.expression));return{suggestionRanking:a.indexOf(n),partialQuery:i.partialQueries[i.partialQueries.length-1],partialQueries:i.partialQueries,suggestions:a}}function Wd(e,t){return(e=Kd(e)).replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,((e,r,n,i)=>r?Jd(r,t.notMatchDelimiters):n?Jd(n,t.exactMatchDelimiters):i?Jd(i,t.correctionDelimiters):e))}function Jd(e,t){return t?t.open+e+t.close:e}function Kd(e){return e.replace(/&/g,"&amp").replace(/</g,"&lt").replace(/>/g,"&gt").replace(/"/g,"&quot").replace(/`/g,"&#96").replace(/'/g,"&#x27")}var Zd=Object.freeze({__proto__:null,highlightString:function(e){if(qs(e.openingDelimiter)||qs(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(Ct(e.content)||qs(e.content))return e.content;const t=e.content.length;let r="",n=0;for(let i=0;i<e.highlights.length;i++){const a=e.highlights[i],o=a.offset,s=o+a.length;if(s>t)break;r+=Kd(e.content.slice(n,o)),r+=e.openingDelimiter,r+=Kd(e.content.slice(o,s)),r+=e.closingDelimiter,n=s}return n!==t&&(r+=e.content.slice(n)),r},getHighlightedSuggestion:Wd,escape:Kd});function Xd(e,t={}){var r,n;!function(e){e.addReducers({query:Eu,querySuggest:Pu,configuration:mu,querySet:ju,search:wu})}(e);const i=Al(e),{dispatch:a}=e,o=(null===(r=t.options)||void 0===r?void 0:r.id)||Os("search_box"),s={id:o,highlightOptions:{...null===(n=t.options)||void 0===n?void 0:n.highlightOptions},...zd,...t.options};Gt(e,Bd,s,"buildSearchBox"),a(wc({id:o,query:""})),a(qc({id:o,q:e.state.query.q,count:s.numberOfSuggestions}));const c=()=>e.state.querySet[s.id],u=async e=>{const{enableQuerySyntax:t}=s;a(Va()),a(zi({q:c(),enableQuerySyntax:t})),a(Zs(1)),await a(aa(e))};return{...i,updateText(e){a(Oc({id:o,query:e})),this.showSuggestions()},clear(){a(Oc({id:o,query:""})),a(Rc({id:o}))},showSuggestions(){s.numberOfSuggestions&&a(Ac({id:o}))},selectSuggestion(e){a(xc({id:o,expression:e})),u(Hd({id:o,suggestion:e})).then((()=>{a(Rc({id:o}))}))},submit(){u(Nd()),a(Rc({id:o}))},get state(){const t=e.state,r=function(e,t){if(!e)return[];return e.completions.map((e=>({highlightedValue:Wd(e.highlighted,t),rawValue:e.expression})))}(t.querySuggest[s.id],s.highlightOptions);return{value:c(),suggestions:r,isLoading:t.search.isLoading}}}}const Gd=ki("analytics/sort/results",ji.Search,((e,t)=>e.logResultsSort({resultsSortBy:t.sortCriteria||Xi()})));function ef(e,t){if(!t)return;const r=new St({criterion:new Pt({each:Zi})}),n=function(e){if(!e.criterion)return[];return Tt(e.criterion)?e.criterion:[e.criterion]}(t),i={...t,criterion:n};Xt(e,r,i,"buildSort")}const tf=new St({expression:new Et({required:!0,emptyAllowed:!0}),id:new Et({required:!0,emptyAllowed:!1})}),rf=new St({isActive:new xt});const nf=()=>ki("analytics/facet/deselectAllFacets",ji.Search,(e=>e.logBreadcrumbResetAll()))(),af={categoryFacetId:ba,categoryFacetPath:new Pt({required:!0,each:Yt})},of=e=>ki("analytics/categoryFacet/breadcrumb",ji.Search,((t,r)=>(Zt(e,af),t.logBreadcrumbFacet(((e,{categoryFacetId:t,categoryFacetPath:r})=>{const n=e.categoryFacetSet[t],i=null==n?void 0:n.request.field;return{categoryFacetId:t,categoryFacetPath:r,categoryFacetField:i,categoryFacetTitle:`${i}_${t}`}})(r,e)))))(),sf=(e,{facetId:t,selection:r})=>{const n=e.dateFacetSet[t]||e.numericFacetSet[t];return{facetId:t,facetField:n.field,facetTitle:`${n.field}_${t}`,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:""+r.end,facetRangeStart:""+r.start}},cf=e=>ki("analytics/numericFacet/breadcrumb",ji.Search,((t,r)=>{Zt(e,Po(e.selection));const n=sf(r,e);return t.logBreadcrumbFacet(n)}))(),uf=e=>ki("analytics/dateFacet/breadcrumb",ji.Search,((t,r)=>{Zt(e,Po(e.selection));const n=sf(r,e);return t.logBreadcrumbFacet(n)}))();const lf=new St({...Ud,redirectionUrl:new Et({required:!0,emptyAllowed:!1,url:!0})});const df=new St({parameters:new jt({options:{required:!0},values:wr})});function ff(e,t){const{dispatch:r}=e,n=Al(e);return Xt(e,df,t.initialState,"buildSearchParameterManager"),r(Or(t.initialState.parameters)),{...n,get state(){const t=e.state;return{parameters:{...pf(t),...gf(t),...hf(t),...yf(t),...mf(t),...vf(t),...bf(t),...Sf(t),...wf(t),...Of(t),...Cf(t),...If(t)}}}}}function pf(e){if(void 0===e.query)return{};const t=e.query.q;return""!==t?{q:t}:{}}function gf(e){if(void 0===e.query)return{};const t=e.query.enableQuerySyntax;return!1!==t?{enableQuerySyntax:t}:{}}function hf(e){if(void 0===e.advancedSearchQueries)return{};const{aq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.aq?{aq:t}:{}}function yf(e){if(void 0===e.advancedSearchQueries)return{};const{cq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.cq?{cq:t}:{}}function mf(e){if(void 0===e.pagination)return{};const t=e.pagination.firstResult;return 0!==t?{firstResult:t}:{}}function vf(e){if(void 0===e.pagination)return{};const t=e.pagination.numberOfResults;return 10!==t?{numberOfResults:t}:{}}function bf(e){if(void 0===e.sortCriteria)return{};const t=e.sortCriteria;return t!==Xi()?{sortCriteria:t}:{}}function Sf(e){if(void 0===e.facetSet)return{};const t=Object.entries(e.facetSet).map((([e,t])=>{const r=t.currentValues.filter((e=>"selected"===e.state)).map((e=>e.value));return r.length?{[e]:r}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{f:t}:{}}function wf(e){if(void 0===e.categoryFacetSet)return{};const t=Object.entries(e.categoryFacetSet).map((([e,t])=>{const{parents:r}=gi(t.request.currentValues),n=r.map((e=>e.value));return n.length?{[e]:n}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{cf:t}:{}}function Of(e){if(void 0===e.numericFacetSet)return{};const t=Object.entries(e.numericFacetSet).map((([e,t])=>{const r=qf(t.currentValues);return r.length?{[e]:r}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{nf:t}:{}}function Cf(e){if(void 0===e.dateFacetSet)return{};const t=Object.entries(e.dateFacetSet).map((([e,t])=>{const r=qf(t.currentValues);return r.length?{[e]:r}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{df:t}:{}}function qf(e){return e.filter((e=>"selected"===e.state))}function If(e){if(void 0===e.debug)return{};const t=e.debug;return!1!==t?{debug:t}:{}}const xf="&",Rf="=",Af="..";function Ef(){return{serialize:Ff,deserialize:Tf}}function Ff(e){return Object.entries(e).map(jf).filter((e=>e)).join(xf)}function jf(e){const[t,r]=e;return Df(t)?"f"===t||"cf"===t?function(e){if(!kf(e))return!1;return Pf(e,(e=>"string"==typeof e))}(r)?function(e,t){return Object.entries(t).map((([t,r])=>`${e}[${t}]=${r.join(",")}`)).join(xf)}(t,r):"":"nf"===t||"df"===t?function(e){if(!kf(e))return!1;return Pf(e,(e=>kf(e)&&"start"in e&&"end"in e))}(r)?function(e,t){return Object.entries(t).map((([t,r])=>{const n=r.map((({start:e,end:t})=>`${e}..${t}`)).join(",");return`${e}[${t}]=${n}`})).join(xf)}(t,r):"":`${t}=${r}`:""}function kf(e){return!(!e||"object"!=typeof e)}function Pf(e,t){return 0===Object.entries(e).filter((e=>{const r=e[1];return!Array.isArray(r)||!r.every(t)})).length}function Tf(e){return e.split(xf).map((e=>function(e){const[t,...r]=e.split(Rf),n=r.join(Rf);return[t,n]}(e))).map(Vf).filter(Mf).map(_f).reduce(((e,t)=>{const[r,n]=t;if("f"===r||"cf"===r||"nf"===r||"df"===r){const t={...e[r],...n};return{...e,[r]:t}}return{...e,[r]:n}}),{})}function Vf(e){const[t,r]=e,n=/^(f|cf|nf|df)\[(.+)\]$/.exec(t);if(!n)return e;const i=n[1],a={[n[2]]:function(e,t){if("nf"===e)return t.map((e=>e.split(Af).map(parseFloat))).filter((e=>2===e.length&&e.every(Number.isFinite))).map((([e,t])=>wd({start:e,end:t,state:"selected"})));if("df"===e)return function(e){return e.map((e=>e.split(Af))).filter((e=>2===e.length&&e.every(Mo))).map((([e,t])=>Do({start:e,end:t,useLocalTime:!0,state:"selected"})))}(t);return t}(i,r.split(","))};return[i,JSON.stringify(a)]}function Mf(e){const t=Df(e[0]),r=2===e.length;return t&&r}function Df(e){return e in{q:!0,aq:!0,cq:!0,enableQuerySyntax:!0,firstResult:!0,numberOfResults:!0,sortCriteria:!0,f:!0,cf:!0,nf:!0,df:!0,debug:!0}}function _f(e){const[t,r]=e;return"enableQuerySyntax"===t||"debug"===t?[t,"true"===r]:"firstResult"===t||"numberOfResults"===t?[t,parseInt(r)]:"f"===t||"cf"===t||"nf"===t||"df"===t?[t,JSON.parse(r)]:e}function $f(e={},t={}){return JSON.stringify(e)!==JSON.stringify(t)}function Lf(e){const t={};return Object.keys(e).forEach((r=>t[r]=e[r].map((e=>`${e.start}..${e.end}`)))),t}function Nf(e={},t={}){const r=Object.keys(e),n=Object.keys(t),i=r.filter((e=>!n.includes(e)));if(i.length){const t=i[0];return e[t].length>1?io(t):oo({facetId:t,facetValue:e[t][0]})}const a=n.filter((e=>!r.includes(e)));if(a.length){const e=a[0];return ao({facetId:e,facetValue:t[e][0]})}const o=n.find((r=>t[r].filter((t=>e[r].includes(t)))));if(!o)return Cl();const s=e[o],c=t[o],u=c.filter((e=>!s.includes(e)));if(u.length)return ao({facetId:o,facetValue:u[0]});const l=s.filter((e=>!c.includes(e)));return l.length?oo({facetId:o,facetValue:l[0]}):Cl()}function zf(e={},t={}){return Nf(Lf(e),Lf(t))}const Qf=new St({fragment:new Et});function Uf(e,t){if(e===t)return!0;const r=Hf(e),n=Hf(t);return Ps(r,n)}function Bf(e){return decodeURIComponent(e)}function Hf(e){return Ef().deserialize(e)}const Yf=e=>ki("analytics/resultPreview/open",ji.Click,((t,r)=>{$i(e);const n=Pi(e,r),i=Ti(e);return t.logDocumentQuickview(n,i)}));const Wf=new St(vs);const Jf=ki("analytics/trigger/query",ji.Search,((e,t)=>{var r;if(null===(r=t.triggers)||void 0===r?void 0:r.query)return e.logTriggerQuery()})),Kf=ki("analytics/trigger/notify",ji.Search,((e,t)=>{var r;if(null===(r=t.triggers)||void 0===r?void 0:r.notification)return e.logTriggerNotify({notification:t.triggers.notification})})),Zf=ki("analytics/trigger/redirect",ji.Search,((e,t)=>{var r;if(null===(r=t.triggers)||void 0===r?void 0:r.redirectTo)return e.logTriggerRedirect({redirectedTo:t.triggers.redirectTo})})),Xf=ki("analytics/trigger/execute",ji.Search,((e,t)=>{var r;if(null===(r=t.triggers)||void 0===r?void 0:r.execute)return e.logTriggerExecute({executed:t.triggers.execute.functionName})}));const Gf=ki("analytics/smartSnippet/expand",ji.Custom,(e=>e.logExpandSmartSnippet())),ep=ki("analytics/smartSnippet/collapse",ji.Custom,(e=>e.logCollapseSmartSnippet())),tp=ki("analytics/smartSnippet/like",ji.Custom,(e=>e.logLikeSmartSnippet())),rp=ki("analytics/smartSnippet/dislike",ji.Custom,(e=>e.logDislikeSmartSnippet())),np=e=>ki("analytics/smartSnippetSuggestion/expand",ji.Custom,(t=>(Zt(e,Tc()),t.logExpandSmartSnippetSuggestion(e))))(),ip=e=>ki("analytics/smartSnippetSuggestion/expand",ji.Custom,(t=>(Zt(e,Tc()),t.logCollapseSmartSnippetSuggestion(e))))();const ap=new St({priority:new qt({required:!1,default:0,min:0}),fields:new Pt({required:!1,each:new Et({required:!0,emptyAllowed:!1})})});const op=(e,t)=>t in e?e[t]:t in e.raw?e.raw[t]:null,sp=e=>t=>e.every((e=>void 0!==t.raw[e])),cp=e=>t=>e.every((e=>void 0===t.raw[e])),up=(e,t)=>r=>{const n=dp(e,r);return t.some((e=>n.some((t=>(""+t).toLowerCase()===e.toLowerCase()))))},lp=(e,t)=>r=>{const n=dp(e,r);return t.every((e=>n.every((t=>(""+t).toLowerCase()!==e.toLowerCase()))))},dp=(e,t)=>{const r=t.raw[e];return Cs(r)?r:[r]};var fp;function pp(e={}){return{configuration:qr(),advancedSearchQueries:{cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},facetSet:{},dateFacetSet:{},numericFacetSet:{},categoryFacetSet:{},facetSearchSet:{},categoryFacetSearchSet:{},facetOptions:{freezeFacetOrder:!1},pagination:{firstResult:0,numberOfResults:10,totalCountFiltered:0},query:{q:"",enableQuerySyntax:!1},querySet:{},querySuggest:{},redirection:{redirectTo:null},search:{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]},sortCriteria:Xi(),context:{contextValues:{}},didYouMean:{enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:{correctedQuery:"",wordCorrections:[],originalQuery:""},originalQuery:""},fields:{fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},history:yu(Gi()),pipeline:"default",facetOrder:[],searchHub:"default",debug:!1,resultPreview:{uniqueId:"",content:"",isLoading:!1},version:"unit-testing-version",folding:{enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}},triggers:{redirectTo:"",query:"",execute:{functionName:"",params:[]},notification:""},questionAnswering:{liked:!1,disliked:!1,expanded:!1,relatedQuestions:[]},...e}}e.ResultTemplatesHelpers=void 0,(fp=e.ResultTemplatesHelpers||(e.ResultTemplatesHelpers={})).getResultProperty=op,fp.fieldsMustBeDefined=sp,fp.fieldsMustNotBeDefined=cp,fp.fieldMustMatch=up,fp.fieldMustNotMatch=lp;var gp,hp,yp=Function.prototype,mp=Object.prototype,vp=yp.toString,bp=mp.hasOwnProperty,Sp=vp.call(Object),wp=mp.toString,Op=(gp=Object.getPrototypeOf,hp=Object,function(e){return gp(hp(e))});var Cp,qp=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=wp.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=Op(e);if(null===t)return!0;var r=bp.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&vp.call(r)==Sp},Ip=Te(ue),xp=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function r(){var e=[],r=[];return{getState:function(){return Ep(t)?t(e):t},getActions:function(){return e},dispatch:function(t){if(!(0,Rp.default)(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant? Action: '+JSON.stringify(t));e.push(t);for(var n=0;n<r.length;n++)r[n]();return t},clearActions:function(){e=[]},subscribe:function(e){return Ep(e)&&r.push(e),function(){var t=r.indexOf(e);t<0||r.splice(t,1)}},replaceReducer:function(e){if(!Ep(e))throw new Error("Expected the nextReducer to be a function.")}}}var n=Ip.applyMiddleware.apply(void 0,Ap(e))(r);return n()}},Rp=(Cp=qp)&&Cp.__esModule?Cp:{default:Cp};function Ap(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var Ep=function(e){return"function"==typeof e};function Fp(e={}){return{configuration:qr(),advancedSearchQueries:{cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},context:{contextValues:{}},fields:{fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},searchHub:"default",pipeline:"default",recommendation:{duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[],searchUid:""},debug:!1,version:"unit-testing-version",...e}}function jp(e={}){return{configuration:qr(),context:{contextValues:{}},searchHub:"default",productRecommendations:{id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0},version:"unit-testing-version",...e}}function kp(e){return new Mt({logger:Xu({level:"silent"}),preprocessRequest:gl,postprocessSearchResponseMiddleware:Ut,postprocessFacetSearchResponseMiddleware:Bt,postprocessQuerySuggestResponseMiddleware:Ht,...e})}function Pp(e={},t){const r=Xu({level:"silent"}),n=Tp(r)(e.state||t()),i=()=>{};return{store:n,state:t(),subscribe:jest.fn((()=>i)),get dispatch(){return n.dispatch},get actions(){return n.getActions()},findAsyncAction(e){const t=this.actions.find((t=>t.type===e.type));return function(e){return!!e&&"meta"in e}(t)?t:void 0},logger:r,addReducers:jest.fn(),enableAnalytics:jest.fn(),disableAnalytics:jest.fn(),...e}}const Tp=e=>xp([dr(e),Yu,he.withExtraArgument({searchAPIClient:kp({logger:e}),validatePayload:Kt,logger:e}),...qe(),fr(e)]);function Vp(e={}){return{urihash:"",parents:"",sfid:"",sfparentid:"",sfinsertedbyid:"",documenttype:"",sfcreatedbyid:"",permanentid:"",date:0,objecttype:"",sourcetype:"",sftitle:"",size:0,sffeeditemid:"",clickableuri:"",sfcreatedby:"",source:"",collection:"",connectortype:"",filetype:"",sfcreatedbyname:"",sflikecount:0,language:[],...e}}var Mp=Object.freeze({__proto__:null,buildMockSearchAppEngine:function(e={}){return{...Pp(e,pp),executeFirstSearch:jest.fn()}},buildMockRecommendationAppEngine:function(e={}){return Pp(e,Fp)},buildMockProductRecommendationsAppEngine:function(e={}){return Pp(e,jp)},createMockState:pp,buildMockResult:function(e={}){return{title:"",uri:"",printableUri:"",clickUri:"",uniqueId:"",excerpt:"",firstSentences:"",summary:null,flags:"",hasHtmlVersion:!1,score:0,percentScore:0,rankingInfo:null,isTopResult:!1,isRecommendation:!1,titleHighlights:[],firstSentencesHighlights:[],excerptHighlights:[],printableUriHighlights:[],summaryHighlights:[],absentTerms:[],raw:Vp(),...e}},buildMockRaw:Vp});e.HighlightUtils=Zd,e.TestUtils=Mp,e.VERSION=Vr,e.baseFacetResponseSelector=li,e.buildBreadcrumbManager=function(e){!function(e){e.addReducers({configuration:mu,search:wu,facetSet:bu,numericFacetSet:Iu,dateFacetSet:Cu,categoryFacetSet:xu})}(e);const t=Al(e),{dispatch:r}=e,n=(t,r,n)=>Object.keys(t).map((i=>{const a=n(e.state,i).map((e=>({value:e,deselect:()=>r({facetId:i,selection:e})})));return{facetId:i,field:t[i].field,values:a}})).filter((e=>e.values.length)),i=()=>n(e.state.facetSet,(({facetId:e,selection:t})=>{const n=so({facetId:e,facetValue:t.value});r(So({facetId:e,selection:t})),r(Io({facetId:e,freezeCurrentValues:!1})),r(aa(n))}),pi),a=()=>n(e.state.numericFacetSet,(e=>{r(ls(e)),r(aa(cf(e)))}),Od),o=()=>n(e.state.dateFacetSet,(e=>{r(Bo(e)),r(aa(uf(e)))}),Cd),s=t=>{const n=yi(e.state,t);return{facetId:t,field:e.state.categoryFacetSet[t].request.field,path:n,deselect:()=>{r(Ia(t)),r(aa(of({categoryFacetPath:n.map((e=>e.value)),categoryFacetId:t})))}}},c=()=>Object.keys(e.state.categoryFacetSet).map(s).filter((e=>e.path.length));return{...t,get state(){return{facetBreadcrumbs:i(),categoryFacetBreadcrumbs:c(),numericFacetBreadcrumbs:a(),dateFacetBreadcrumbs:o(),hasBreadcrumbs:!![...i(),...a(),...o(),...c()].length}},deselectAll:()=>{r(Va()),r(aa(nf()))},deselectBreadcrumb(e){e.deselect()}}},e.buildCategoryFacet=function(e,t){!function(e){e.addReducers({categoryFacetSet:xu,categoryFacetSearchSet:Au,configuration:mu,search:wu})}(e);const r=Al(e),{dispatch:n}=e,i=Gl(e,t.options),a={facetSearch:{...Ja},...$a,...t.options,facetId:i};Gt(e,Kl,a,"buildCategoryFacet");const o=()=>((e,t)=>{var r;return null===(r=e.categoryFacetSet[t])||void 0===r?void 0:r.request})(e.state,i);n(Ca(a));const s=(()=>{const{facetId:t,facetSearch:r}=a,n={facetId:t,...r};return function(e,t){const{dispatch:r}=e,n={...Ja,...t.options},{facetId:i}=n;r(Ta(n));const a=Vl(e,{options:n,getFacetSearch:()=>e.state.categoryFacetSearchSet[i]});return{...a,select(e){r(Pa({facetId:i,value:e})),a.select(e)},get state(){return a.state}}}(e,{options:n})})(),{state:c,...u}=s;return{...r,facetSearch:u,toggleSelect:e=>n(Ml({facetId:i,selection:e,retrieveCount:a.numberOfValues})),deselectAll:()=>n(Dl({facetId:i})),sortBy(e){const t=a.facetId;n(Ra({facetId:t,criterion:e})),n(ma({freezeFacetOrder:!0})),n(aa(no({facetId:t,criterion:e})))},isSortedBy:e=>o().sortCriteria===e,showMoreValues(){const{facetId:e,numberOfValues:t}=a,{values:r}=this.state,i=r.length+t;n(xa({facetId:e,numberOfValues:i})),n(ma({freezeFacetOrder:!0})),n(aa(eo(e)))},showLessValues(){const{facetId:e,numberOfValues:t}=a;n(xa({facetId:e,numberOfValues:t})),n(ma({freezeFacetOrder:!0})),n(aa(to(e)))},get state(){const t=o(),r=hi(e.state,i),{parents:n,values:c}=gi(null==r?void 0:r.values),u=e.state.search.isLoading,l=0!==n.length,d=n.length>0?n[n.length-1].moreValuesAvailable:(null==r?void 0:r.moreValuesAvailable)||!1,f=c.length>a.numberOfValues;return{facetId:i,parents:n,values:c,isLoading:u,hasActiveValues:l,canShowMoreValues:d,canShowLessValues:f,sortCriteria:t.sortCriteria,facetSearch:s.state}}}},e.buildContext=function(e){!function(e){e.addReducers({context:Vu})}(e);const t=Al(e),{dispatch:r}=e;return{...t,get state(){return{values:e.state.context.contextValues}},set(e){r(Ar(e))},add(e,t){r(Er({contextKey:e,contextValue:t}))},remove(e){r(Fr(e))}}},e.buildController=Al,e.buildCriterionExpression=Bi,e.buildDateFacet=function(e,t){!function(e){e.addReducers({configuration:mu,search:wu,dateFacetSet:Cu})}(e),od(t.options,"buildDateFacet");const r=e.dispatch,n=Gl(e,t.options),i={currentValues:[],...t.options,facetId:n};hd(e,i),r(Uo(i));const a=ad(e,{facetId:n,getRequest:()=>e.state.dateFacetSet[n]}),o=e=>{r(ud({facetId:n,selection:e}))};return{...a,toggleSelect:e=>o(e),toggleSingleSelect:e=>{"idle"===e.state&&r(wo(n)),o(e)},get state(){return a.state}}},e.buildDateFilter=function(e,t){var r;!function(e){e.addReducers({dateFacetSet:Cu,configuration:mu,search:wu})}(e);const n=Al(e),{dispatch:i}=e,a=()=>e.state,o=Gl(e,t.options),s={...t.options,currentValues:(null===(r=t.initialState)||void 0===r?void 0:r.range)?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:o};return hd(e,s),i(Uo(s)),{...n,clear:()=>{i(Ho({facetId:o,values:[]})),i(ma({freezeFacetOrder:!0})),i(aa(io(o)))},setRange:e=>{const t={...e,state:"selected",numberOfResults:0,endInclusive:!0},r=Ho({facetId:o,values:[t]});return!r.error&&(i(r),i(ma({freezeFacetOrder:!0})),i(aa(ao({facetId:o,facetValue:`${t.start}..${t.end}`}))),!0)},get state(){const e=a().search.isLoading,t=Cd(a(),o),r=t.length?t[0]:void 0;return{facetId:o,isLoading:e,range:r}}}},e.buildDateRange=Do,e.buildDateSortCriterion=Yi,e.buildDidYouMean=function(e){!function(e){e.addReducers({configuration:mu,didYouMean:Mu})}(e);const t=Al(e),{dispatch:r}=e;return r(Dr()),{...t,get state(){const t=e.state;return{originalQuery:t.didYouMean.originalQuery,wasCorrectedTo:t.didYouMean.wasCorrectedTo,wasAutomaticallyCorrected:t.didYouMean.wasAutomaticallyCorrected,queryCorrection:t.didYouMean.queryCorrection,hasQueryCorrection:""!==t.didYouMean.queryCorrection.correctedQuery||""!==t.didYouMean.wasCorrectedTo}},applyCorrection(){r($r(this.state.queryCorrection.correctedQuery)),r(aa(Li()))}}},e.buildExecuteTrigger=function(e){!function(e){e.addReducers({triggers:Qu})}(e);const t=Al(e),{dispatch:r}=e,n=()=>e.state;let i=n().triggers.execute.functionName,a=n().triggers.execute.params;return{...t,subscribe(t){const n=()=>{const e=i!==this.state.functionName||a!==this.state.params;i=this.state.functionName,a=this.state.params,e&&this.state.functionName&&(t(),r(Xf()))};return n(),e.subscribe(n)},get state(){return{functionName:n().triggers.execute.functionName,params:n().triggers.execute.params}}}},e.buildFacet=function(e,t){!function(e){e.addReducers({facetSet:bu,configuration:mu,facetSearchSet:Su,search:wu})}(e);const{dispatch:r}=e,n=Al(e),i=Gl(e,t.options),a={facetSearch:{...Ja},...Ro,...t.options,facetId:i};Gt(e,nd,a,"buildFacet");const o=()=>di(e.state,i),s=()=>{const{currentValues:e}=o(),t=a.numberOfValues,r=!!e.find((e=>"idle"===e.state));return t<e.length&&r};r(bo(a));const c=(()=>{const{facetId:t,facetSearch:r}=a,n={facetId:t,...r};return function(e,t){const{dispatch:r}=e,{options:n}=t,{facetId:i}=n;r(Za(n));const a=Vl(e,{options:n,getFacetSearch:()=>e.state.facetSearchSet[i]});return{...a,select(e){r(Ga({facetId:i,value:e})),a.select(e)},singleSelect(e){r(wo(i)),r(Ga({facetId:i,value:e})),a.select(e)},get state(){const{values:e}=a.state;return{...a.state,values:e.map((({count:e,displayValue:t,rawValue:r})=>({count:e,displayValue:t,rawValue:r})))}}}}(e,{options:n})})(),{state:u,...l}=c,d=e=>{r(rd({facetId:a.facetId,selection:e}))};return{...n,facetSearch:l,toggleSelect:e=>d(e),toggleSingleSelect:e=>{"idle"===e.state&&r(wo(i)),d(e)},isValueSelected:ed,deselectAll(){r(wo(i)),r(ma({freezeFacetOrder:!0})),r(aa(io(i)))},sortBy(e){r(Oo({facetId:i,criterion:e})),r(ma({freezeFacetOrder:!0})),r(aa(no({facetId:i,criterion:e})))},isSortedBy(e){return this.state.sortCriterion===e},showMoreValues(){const e=o().numberOfValues,t=a.numberOfValues;r(Co({facetId:i,numberOfValues:e+(t-e%t)})),r(qo({facetId:i,isFieldExpanded:!0})),r(ma({freezeFacetOrder:!0})),r(aa(eo(i)))},showLessValues(){const e=a.numberOfValues,t=Math.max(e,(()=>{const{currentValues:e}=o();return e.filter((e=>"idle"!==e.state)).length})());r(Co({facetId:i,numberOfValues:t})),r(qo({facetId:i,isFieldExpanded:!1})),r(ma({freezeFacetOrder:!0})),r(aa(to(i)))},get state(){const t=o(),r=fi(e.state,i),n=e.state.search.isLoading,a=t.sortCriteria,u=r?r.values:[],l=u.some((e=>"idle"!==e.state)),d=!!r&&r.moreValuesAvailable;return{facetId:i,values:u,sortCriterion:a,isLoading:n,hasActiveValues:l,canShowMoreValues:d,canShowLessValues:s(),facetSearch:c.state}}}},e.buildFacetManager=function(e){!function(e){e.addReducers({search:wu,facetOptions:Ru})}(e);return{...Al(e),sort(e){return ta(e,this.state.facetIds)},get state(){return{facetIds:e.state.search.response.facets.map((e=>e.facetId))}}}},e.buildFieldSortCriterion=Wi,e.buildFoldedResultList=function(e,t={}){var r;!function(e){e.addReducers({search:wu,configuration:mu,folding:Ou})}(e);const n=_d(e,t),{dispatch:i}=e,a=(null===(r=t.options)||void 0===r?void 0:r.folding)?Gt(e,Wf,t.options.folding,"buildFoldedResultList"):{};return i(bs({...a})),{...n,loadCollection:t=>{i(Ss(t.result.raw[e.state.folding.fields.collection]))},get state(){const t=e.state;return{...n.state,results:n.state.results.map((e=>{const r=e.raw[t.folding.fields.collection];return r&&t.folding.collections[r]?t.folding.collections[r]:{result:e,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}}))}}}},e.buildHistoryManager=function(e){!function(e){e.addReducers({history:Bu,configuration:mu,facetOrder:qu})}(e);const t=Al(e),{dispatch:r}=e;return{...t,get state(){return e.state.history},async back(){this.state.past.length&&this.state.present&&(await r(yr()),r(aa(Id())))},async forward(){this.state.future.length&&this.state.present&&(await r(mr()),r(aa(qd())))}}},e.buildInteractiveResult=function(e,t){!function(e){e.addReducers({configuration:mu})}(e);const r={selectionDelay:1e3,...t.options};let n=!1;const i=()=>{n||(n=!0,e.dispatch($d(r.result)))};let a;return{select:i,beginDelayedSelect(){a=setTimeout(i,r.selectionDelay)},cancelPendingSelect(){a&&clearTimeout(a)}}},e.buildNoSortCriterion=Ki,e.buildNotifyTrigger=function(e){!function(e){e.addReducers({triggers:Qu})}(e);const t=Al(e),{dispatch:r}=e,n=()=>e.state;let i=n().triggers.notification;return{...t,subscribe(t){const a=()=>{const e=i!==this.state.notification;i=this.state.notification,e&&n().triggers.notification&&(t(),r(Kf()))};return a(),e.subscribe(a)},get state(){return{notification:n().triggers.notification}}}},e.buildNumericFacet=function(e,t){!function(e){e.addReducers({numericFacetSet:Iu,configuration:mu,search:wu})}(e),od(t.options,"buildNumericFacet");const r=e.dispatch,n=Gl(e,t.options),i={currentValues:[],...t.options,facetId:n};Sd(e,i),r(us(i));const a=ad(e,{facetId:n,getRequest:()=>e.state.numericFacetSet[n]});return{...a,toggleSelect:e=>(e=>{r(md({facetId:n,selection:e}))})(e),toggleSingleSelect(e){"idle"===e.state&&r(wo(n)),r(md({facetId:n,selection:e}))},get state(){return a.state}}},e.buildNumericFilter=function(e,t){var r;!function(e){e.addReducers({numericFacetSet:Iu,configuration:mu,search:wu})}(e);const n=Al(e),{dispatch:i}=e,a=()=>e.state,o=Gl(e,t.options),s={...t.options,currentValues:(null===(r=t.initialState)||void 0===r?void 0:r.range)?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:o};return Sd(e,s),i(us(s)),{...n,clear:()=>{i(ds({facetId:o,values:[]})),i(ma({freezeFacetOrder:!0})),i(aa(io(o)))},setRange:e=>{const t={...e,state:"selected",numberOfResults:0,endInclusive:!0},r=ds({facetId:o,values:[t]});return!r.error&&(i(r),i(ma({freezeFacetOrder:!0})),i(aa(ao({facetId:o,facetValue:`${t.start}..${t.end}`}))),!0)},get state(){const e=a().search.isLoading,t=Od(a(),o),r=t.length?t[0]:void 0;return{facetId:o,isLoading:e,range:r}}}},e.buildNumericRange=wd,e.buildPager=function(e,t={}){!function(e){e.addReducers({configuration:mu,pagination:vu})}(e);const r=Al(e),{dispatch:n}=e,i=Gt(e,Td,t.options,"buildPager"),a=Xt(e,Vd,t.initialState,"buildPager").page;a&&n(Ks(a));const o=()=>{const{numberOfPages:t}=i;return Ed(e.state,t)};return{...r,get state(){const t=Rd(e.state),r=Ad(e.state),n=t>1&&r>0,i=t<r;return{currentPage:t,currentPages:o(),maxPage:r,hasPreviousPage:n,hasNextPage:i}},selectPage(e){n(Zs(e)),n(aa(jd()))},nextPage(){n(Xs()),n(aa(kd()))},previousPage(){n(Gs()),n(aa(Pd()))},isCurrentPage(e){return e===this.state.currentPage}}},e.buildQueryError=function(e){!function(e){e.addReducers({search:wu})}(e);const t=Al(e),r=()=>e.state;return{...t,get state(){return{hasError:null!==r().search.error,error:r().search.error}}}},e.buildQueryRankingExpressionSortCriterion=Ji,e.buildQuerySummary=function(e){!function(e){e.addReducers({search:wu,pagination:vu})}(e);const t=Al(e),r=Md(e),n=()=>{const t=e.state.search.duration/1e3;return Math.round(100*(t+Number.EPSILON))/100};return{...t,get state(){const t=e.state;return{...r.state,durationInMilliseconds:t.search.duration,durationInSeconds:n(),firstResult:t.pagination.firstResult+1,hasDuration:0!==t.search.duration,hasQuery:""!==t.search.queryExecuted,lastResult:t.pagination.firstResult+t.search.results.length,query:t.search.queryExecuted,total:t.pagination.totalCountFiltered}}}},e.buildQueryTrigger=function(e){!function(e){e.addReducers({triggers:Qu,query:Eu})}(e);const t=Al(e),{dispatch:r}=e,n=()=>e.state;let i=n().triggers.query,a=n().query.q;return{...t,subscribe(t){const o=()=>{const e=i!==this.state.newQuery;if(i=this.state.newQuery,e&&this.state.newQuery){a=n().query.q;const e={q:n().triggers.query};r(zi(e)),t(),r(aa(Jf()))}};return o(),e.subscribe(o)},get state(){return{newQuery:n().triggers.query,originalQuery:a,wasQueryModified:""!==n().triggers.query}}}},e.buildQuickview=function(e,t){!function(e){e.addReducers({configuration:mu,resultPreview:Nu})}(e);const{dispatch:r}=e,n=Al(e),{result:i,maximumPreviewSize:a}=t.options,o=i.uniqueId;return{...n,fetchResultContent(){r(ru({uniqueId:o,requestedOutputSize:a})),r((e=>Yf(e)())(i))},get state(){const t=i.hasHtmlVersion,r=e.state.resultPreview;return{content:o===r.uniqueId?r.content:"",resultHasPreview:t,isLoading:r.isLoading}}}},e.buildRedirectionTrigger=function(e){!function(e){e.addReducers({triggers:Qu})}(e);const t=Al(e),{dispatch:r}=e,n=()=>e.state;let i=n().triggers.redirectTo;return{...t,subscribe(t){const n=()=>{const e=i!==this.state.redirectTo;i=this.state.redirectTo,e&&this.state.redirectTo&&(t(),r(Zf()))};return n(),e.subscribe(n)},get state(){return{redirectTo:n().triggers.redirectTo}}}},e.buildRelevanceInspector=function(e,t={}){!function(e){e.addReducers({debug:Lu,search:wu,configuration:mu})}(e);const r=Al(e),{dispatch:n}=e;return Xt(e,Tl,t.initialState,"buildRelevanceInspector").enabled&&n(kr()),{...r,get state(){const t=e.state,r=t.debug;if(!t.debug)return{isEnabled:r};const{executionReport:n,basicExpression:i,advancedExpression:a,constantExpression:o,userIdentities:s,rankingExpressions:c}=t.search.response;return{isEnabled:r,rankingInformation:Pl(t),executionReport:n,expressions:{basicExpression:i,advancedExpression:a,constantExpression:o},userIdentities:s,rankingExpressions:c}},enable(){n(kr())},disable(){n(Pr())}}},e.buildRelevanceSortCriterion=Hi,e.buildResultList=_d,e.buildResultTemplatesManager=function(e){!function(e){e.addReducers({fields:Du})}(e);const t=[];return{registerTemplates(...r){const n=[];try{(e=>{e.forEach((e=>{if(ap.validate(e,"Check the arguments of registerTemplates"),!e.conditions.every((e=>e instanceof Function)))throw new bt("Each result template conditions should be a function that takes a result as an argument and returns a boolean")}))})(r)}catch(t){return void e.logger.error(t,"Result template manager error")}r.forEach((e=>{const r={...e,priority:e.priority||0,fields:e.fields||[]};t.push(r),n.push(...r.fields)})),t.sort(((e,t)=>t.priority-e.priority)),n.length&&e.dispatch(ms(n))},selectTemplate(e){const r=t.find((t=>t.conditions.every((t=>t(e)))));return r?r.content:null}}},e.buildResultsPerPage=function(e,t={}){!function(e){e.addReducers({pagination:vu,configuration:mu})}(e);const r=Al(e),{dispatch:n}=e,i=Xt(e,Ld,t.initialState,"buildResultsPerPage").numberOfResults;return void 0!==i&&n(Ws(i)),{...r,get state(){return{numberOfResults:e.state.pagination.numberOfResults}},set(e){n(Js(e)),n(aa(Fd()))},isSetTo(e){return e===this.state.numberOfResults}}},e.buildSearchBox=Xd,e.buildSearchEngine=function(e){const t=function(e){return Xu({name:"@coveo/headless",level:(null==e?void 0:e.level)||"warn",formatters:{log:null==e?void 0:e.logFormatter},browser:{transmit:{send:(null==e?void 0:e.browserPostLogHook)||(()=>{})}}})}(e.loggerOptions);!function(e,t){try{ml.validate(e)}catch(e){throw t.error(e,"Search engine configuration error"),e}}(e.configuration,t);const r=function(e,t){const{search:r}=e;return new Mt({logger:t,preprocessRequest:e.preprocessRequest||gl,postprocessSearchResponseMiddleware:(null==r?void 0:r.preprocessSearchResponseMiddleware)||Ut,postprocessFacetSearchResponseMiddleware:(null==r?void 0:r.preprocessFacetSearchResponseMiddleware)||Bt,postprocessQuerySuggestResponseMiddleware:(null==r?void 0:r.preprocessQuerySuggestResponseMiddleware)||Ht})}(e.configuration,t),n={...hl(e.configuration,t),searchAPIClient:r},i=Ju({...e,reducers:Rl},n),{search:a}=e.configuration;return a&&i.dispatch(ar(a)),{...i,get state(){return i.state},executeFirstSearch(e=Ol()){if(xl(i.state))return;const t=aa(e);i.dispatch(t)}}},e.buildSearchParameterManager=ff,e.buildSearchParameterSerializer=Ef,e.buildSearchStatus=Md,e.buildSmartSnippet=function(e){!function(e){e.addReducers({search:wu,questionAnswering:Uu})}(e);return{...Al(e),get state(){const t=e.state;return{disliked:t.questionAnswering.disliked,liked:t.questionAnswering.liked,expanded:t.questionAnswering.expanded,answerFound:""!==t.search.response.questionAnswer.answerSnippet,question:t.search.response.questionAnswer.question,answer:t.search.response.questionAnswer.answerSnippet,documentId:t.search.response.questionAnswer.documentId}},expand(){e.dispatch(Gf()),e.dispatch(Vc())},collapse(){e.dispatch(ep()),e.dispatch(Mc())},like(){e.dispatch(tp()),e.dispatch(Dc())},dislike(){e.dispatch(rp()),e.dispatch(_c())}}},e.buildSmartSnippetQuestionsList=function(e){!function(e){e.addReducers({search:wu,questionAnswering:Uu})}(e);const t=Al(e),r=(e,t)=>{const r=Nc(t,e.documentId);return-1!==r&&t[r].expanded};return{...t,get state(){const t=e.state;return{questions:t.search.response.questionAnswer.relatedQuestions.map((e=>({question:e.question,answer:e.answerSnippet,documentId:e.documentId,expanded:r(e,t.questionAnswering.relatedQuestions)})))}},expand(t){e.dispatch(np(t)),e.dispatch($c(t))},collapse(t){e.dispatch(ip(t)),e.dispatch(Lc(t))}}},e.buildSort=function(e,t={}){var r;!function(e){e.addReducers({configuration:mu,sortCriteria:Tu})}(e);const n=Al(e),{dispatch:i}=e;ef(e,t.initialState);const a=null===(r=t.initialState)||void 0===r?void 0:r.criterion;return a&&i(du(a)),{...n,sortBy(e){i(fu(e)),i(Zs(1)),i(aa(Gd()))},isSortedBy(e){return this.state.sortCriteria===Bi(e)},get state(){return{sortCriteria:e.state.sortCriteria}}}},e.buildStandaloneSearchBox=function(e,t){!function(e){e.addReducers({redirection:ku,configuration:mu,query:Eu,querySuggest:Pu})}(e);const{dispatch:r}=e,n=()=>e.state,i=t.options.id||Os("standalone_search_box"),a={id:i,highlightOptions:{...t.options.highlightOptions},...zd,...t.options};Gt(e,lf,a,"buildStandaloneSearchBox");const o=Xd(e,{options:a});let s={cause:"",metadata:null};return{...o,updateText(e){s={cause:"searchFromLink",metadata:null},o.updateText(e)},selectSuggestion(e){s=function(e,t,r){return{cause:"omniboxFromLink",metadata:Yd(e,{id:t,suggestion:r})}}(n(),i,e),r(xc({id:i,expression:e})),this.submit()},submit(){r(zi({q:this.state.value,enableQuerySyntax:a.enableQuerySyntax})),r(Gc({defaultRedirectionUrl:a.redirectionUrl}))},get state(){const e=n();return{...o.state,redirectTo:e.redirection.redirectTo,analytics:s}}}},e.buildTab=function(e,t){!function(e){const t=qr().analytics.originLevel2;if(e===t)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${t}". Please specify a different value.`)}(t.options.id),function(e){e.addReducers({configuration:mu,advancedSearchQueries:Fu})}(e);const r=Al(e),{dispatch:n}=e,i=Gt(e,tf,t.options,"buildTab");if(Xt(e,rf,t.initialState,"buildTab").isActive){const{id:e}=i;e&&n(ur({originLevel2:e})),n(Sr({cq:i.expression}))}return{...r,select(){const{id:e}=i;e&&n(ur({originLevel2:e})),n(br({cq:i.expression})),n(aa(Cl()))},get state(){return{isActive:e.state.advancedSearchQueries.cq===i.expression}}}},e.buildUrlManager=function(e,t){!function(e){e.addReducers({configuration:mu})}(e),Xt(e,Qf,t.initialState,"buildUrlManager");const r=t=>{return{...(r=e.state,{q:"",enableQuerySyntax:!1,aq:null!==(i=null===(n=r.advancedSearchQueries)||void 0===n?void 0:n.defaultFilters.aq)&&void 0!==i?i:"",cq:null!==(o=null===(a=r.advancedSearchQueries)||void 0===a?void 0:a.defaultFilters.cq)&&void 0!==o?o:"",firstResult:0,numberOfResults:10,sortCriteria:Xi(),f:{},cf:{},nf:{},df:{},debug:!1}),...Hf(t)};var r,n,i,a,o},n=Al(e),{dispatch:i}=e;let a=Bf(t.initialState.fragment);const o=ff(e,{initialState:{parameters:Hf(a)}});return{...n,subscribe(t){const r=()=>{const e=this.state.fragment;Uf(a,e)||(a=e,t())};return r(),e.subscribe(r)},get state(){return{fragment:Ef().serialize(o.state.parameters)}},synchronize(e){const t=Bf(e);if(Uf(a,t))return;const n=r(a),o=r(t);var s,c;a=t,i(Or(o)),i(aa((c=o,(s=n).q!==c.q?Nd():s.sortCriteria!==c.sortCriteria?Gd():s.firstResult!==c.firstResult?jd():s.numberOfResults!==c.numberOfResults?Fd():$f(s.f,c.f)?Nf(s.f,c.f):$f(s.cf,c.cf)?Nf(s.cf,c.cf):$f(s.nf,c.nf)?zf(s.nf,c.nf):$f(s.df,c.df)?zf(s.df,c.df):Cl())))}}},e.createAction=xe,e.createAsyncThunk=je,e.createReducer=Re,e.currentPageSelector=Rd,e.currentPagesSelector=Ed,e.facetRequestSelector=di,e.facetResponseSelectedValuesSelector=pi,e.facetResponseSelector=fi,e.getSampleSearchEngineConfiguration=function(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",search:{pipeline:"default",searchHub:"default"}}},e.loadAdvancedSearchQueryActions=function(e){return e.addReducers({advancedSearchQueries:Fu}),{updateAdvancedSearchQueries:br,registerAdvancedSearchQueries:Sr}},e.loadBreadcrumbActions=function(e){return e.addReducers({}),{deselectAllFacets:Va}},e.loadCategoryFacetSetActions=function(e){return e.addReducers({categoryFacetSet:xu}),{deselectAllCategoryFacetValues:Ia,registerCategoryFacet:Ca,toggleSelectCategoryFacetValue:qa,updateCategoryFacetNumberOfValues:xa,updateCategoryFacetSortCriterion:Ra}},e.loadClickAnalyticsActions=function(e){return e.addReducers({}),{logDocumentOpen:$d}},e.loadConfigurationActions=function(e){return e.addReducers({configuration:mu}),{disableAnalytics:sr,enableAnalytics:cr,setOriginLevel2:ur,setOriginLevel3:lr,updateAnalyticsConfiguration:or,updateBasicConfiguration:ir}},e.loadContextActions=function(e){return e.addReducers({context:Vu}),{addContext:Er,removeContext:Fr,setContext:Ar}},e.loadDateFacetSetActions=function(e){return e.addReducers({dateFacetSet:Cu}),{deselectAllDateFacetValues:Wo,registerDateFacet:Uo,toggleSelectDateFacetValue:Bo,updateDateFacetSortCriterion:Yo,updateDateFacetValues:Ho}},e.loadDebugActions=function(e){return e.addReducers({debug:Lu}),{disableDebug:Pr,enableDebug:kr}},e.loadDidYouMeanActions=function(e){return e.addReducers({didYouMean:Mu,query:Eu}),{applyDidYouMeanCorrection:$r,disableDidYouMean:_r,enableDidYouMean:Dr}},e.loadFacetSetActions=function(e){return e.addReducers({facetSet:bu}),{deselectAllFacetValues:wo,registerFacet:bo,toggleSelectFacetValue:So,updateFacetIsFieldExpanded:qo,updateFacetNumberOfValues:Co,updateFacetSortCriterion:Oo,updateFreezeCurrentValues:Io}},e.loadFieldActions=function(e){return e.addReducers({fields:Du}),{registerFieldsToInclude:ms}},e.loadGenericAnalyticsActions=function(e){return e.addReducers({}),{logSearchEvent:bl,logClickEvent:Sl,logCustomEvent:wl}},e.loadHistoryActions=function(e){return e.addReducers({history:Bu,facetOrder:qu}),{back:yr,forward:mr}},e.loadNumericFacetSetActions=function(e){return e.addReducers({numericFacetSet:Iu}),{deselectAllNumericFacetValues:ps,registerNumericFacet:us,toggleSelectNumericFacetValue:ls,updateNumericFacetSortCriterion:fs,updateNumericFacetValues:ds}},e.loadPaginationActions=function(e){return e.addReducers({pagination:vu}),{nextPage:Xs,previousPage:Gs,registerNumberOfResults:Ws,registerPage:Ks,updateNumberOfResults:Js,updatePage:Zs}},e.loadPipelineActions=function(e){return e.addReducers({pipeline:_u}),{setPipeline:oc}},e.loadQueryActions=function(e){return e.addReducers({query:Eu}),{updateQuery:zi}},e.loadQuerySetActions=function(e){return e.addReducers({querySet:ju}),{registerQuerySetQuery:wc,updateQuerySetQuery:Oc}},e.loadQuerySuggestActions=function(e){return e.addReducers({querySuggest:Pu}),{clearQuerySuggest:Rc,fetchQuerySuggestions:Ac,registerQuerySuggest:qc,selectQuerySuggestion:xc}},e.loadRedirectionActions=function(e){return e.addReducers({redirection:ku}),{checkForRedirection:Gc}},e.loadSearchActions=function(e){return e.addReducers({search:wu}),{executeSearch:aa,fetchMoreResults:oa}},e.loadSearchAnalyticsActions=function(e){return e.addReducers({}),{logClearBreadcrumbs:nf,logInterfaceLoad:Ol,logSearchFromLink:ql,logOmniboxFromLink:Il,logInterfaceChange:Cl,logDidYouMeanClick:Li,logCategoryFacetBreadcrumb:of,logFacetBreadcrumb:so,logFacetClearAll:io,logFacetDeselect:oo,logFacetSelect:ao,logFacetShowLess:to,logFacetShowMore:eo,logFacetUpdateSort:no,logDateFacetBreadcrumb:uf,logNumericFacetBreadcrumb:cf,logNavigateBackward:Id,logNavigateForward:qd,logPageNext:kd,logPageNumber:jd,logPagePrevious:Pd,logPagerResize:Fd,logSearchboxSubmit:Nd,logQuerySuggestionClick:Hd,logResultsSort:Gd,logDislikeSmartSnippet:rp,logLikeSmartSnippet:tp,logExpandSmartSnippet:Gf,logCollapseSmartSnippet:ep,logExpandSmartSnippetSuggestion:np,logCollapseSmartSnippetSuggestion:ip}},e.loadSearchConfigurationActions=function(e){return e.addReducers({configuration:mu,pipeline:_u,searchHub:$u}),{updateSearchConfiguration:ar}},e.loadSearchHubActions=function(e){return e.addReducers({searchHub:$u}),{setSearchHub:iu}},e.loadSortCriteriaActions=function(e){return e.addReducers({sortCriteria:Tu}),{registerSortCriterion:du,updateSortCriterion:fu}},e.maxPageSelector=Ad,e.parseCriterionExpression=function(t){const r=t.split(","),n=new Error(`Wrong criterion expression format for "${t}"`);if(!r.length)throw n;return r.map((r=>{const i=r.trim().split(" "),a=i[0].toLowerCase(),o=i[1]&&i[1].toLowerCase();if(i.length>2)throw n;if(""===a)throw n;if(!function(t){return void 0===t||t===e.SortOrder.Ascending||t===e.SortOrder.Descending}(o))throw new Error(`Wrong criterion sort order "${o}" in expression "${t}". Order should either be "${e.SortOrder.Ascending}" or "${e.SortOrder.Descending}"`);return function(t){const{by:r,order:n}=t;switch(r){case e.SortBy.Relevancy:return Hi();case e.SortBy.QRE:return Ji();case e.SortBy.NoSort:return Ki();case e.SortBy.Date:if(!n)throw new Error('"order" should be specified when "by" value is "date"');return Yi(n);default:if(!n)throw new Error(`"order" should be specified when "by" value is "field" for field "${r}"`);return Wi(r,n)}}({by:a,order:o})}))},e.platformUrl=gt,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=headless.js.map
