function e(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function t(e){return!!e&&!!e[U]}function r(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[L]||!!e.constructor[L]||u(e)||c(e))}function n(e,t,r){void 0===r&&(r=!1),0===i(e)?(r?Object.keys:z)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function i(e){var t=e[U];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:u(e)?2:c(e)?3:0}function o(e,t){return 2===i(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function a(e,t,r){var n=i(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function s(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function u(e){return F&&e instanceof Map}function c(e){return V&&e instanceof Set}function l(e){return e.o||e.t}function d(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=N(e);delete t[U];for(var r=z(t),n=0;n<r.length;n++){var i=r[n],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function f(e,o){return void 0===o&&(o=!1),h(e)||t(e)||!r(e)||(i(e)>1&&(e.set=e.add=e.clear=e.delete=p),Object.freeze(e),o&&n(e,(function(e,t){return f(t,!0)}),!0)),e}function p(){e(2)}function h(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function g(t){var r=H[t];return r||e(18,t),r}function y(){return M}function v(e,t){t&&(g("Patches"),e.u=[],e.s=[],e.v=t)}function m(e){b(e),e.p.forEach(S),e.p=null}function b(e){e===M&&(M=e.l)}function w(e){return M={p:[],l:M,h:e,m:!0,_:0}}function S(e){var t=e[U];0===t.i||1===t.i?t.j():t.g=!0}function O(t,n){n._=n.p.length;var i=n.p[0],o=void 0!==t&&t!==i;return n.h.O||g("ES5").S(n,t,o),o?(i[U].P&&(m(n),e(4)),r(t)&&(t=C(n,t),n.l||E(n,t)),n.u&&g("Patches").M(i[U],t,n.u,n.s)):t=C(n,i,[]),m(n),n.u&&n.v(n.u,n.s),t!==D?t:void 0}function C(e,t,r){if(h(t))return t;var i=t[U];if(!i)return n(t,(function(n,o){return q(e,i,t,n,o,r)}),!0),t;if(i.A!==e)return t;if(!i.P)return E(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var o=4===i.i||5===i.i?i.o=d(i.k):i.o;n(3===i.i?new Set(o):o,(function(t,n){return q(e,i,o,t,n,r)})),E(e,o,!1),r&&e.u&&g("Patches").R(i,r,e.u,e.s)}return i.o}function q(e,n,i,s,u,c){if(t(u)){var l=C(e,u,c&&n&&3!==n.i&&!o(n.D,s)?c.concat(s):void 0);if(a(i,s,l),!t(l))return;e.m=!1}if(r(u)&&!h(u)){if(!e.h.N&&e._<1)return;C(e,u),n&&n.A.l||E(e,u)}}function E(e,t,r){void 0===r&&(r=!1),e.h.N&&e.m&&f(t,r)}function I(e,t){var r=e[U];return(r?l(r):e)[t]}function x(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function A(e){e.P||(e.P=!0,e.l&&A(e.l))}function j(e){e.o||(e.o=d(e.t))}function R(e,t,r){var n=u(t)?g("MapSet").T(t,r):c(t)?g("MapSet").F(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:y(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,o=Q;r&&(i=[n],o=Y);var a=Proxy.revocable(i,o),s=a.revoke,u=a.proxy;return n.k=u,n.j=s,u}(t,r):g("ES5").J(t,r);return(r?r.A:y()).p.push(n),n}function k(o){return t(o)||e(22,o),function e(t){if(!r(t))return t;var o,s=t[U],u=i(t);if(s){if(!s.P&&(s.i<4||!g("ES5").K(s)))return s.t;s.I=!0,o=P(t,u),s.I=!1}else o=P(t,u);return n(o,(function(t,r){s&&function(e,t){return 2===i(e)?e.get(t):e[t]}(s.t,t)===r||a(o,t,e(r))})),3===u?new Set(o):o}(o)}function P(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return d(e)}var T,M,_="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),F="undefined"!=typeof Map,V="undefined"!=typeof Set,$="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,D=_?Symbol.for("immer-nothing"):((T={})["immer-nothing"]=!0,T),L=_?Symbol.for("immer-draftable"):"__$immer_draftable",U=_?Symbol.for("immer-state"):"__$immer_state",z="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,N=Object.getOwnPropertyDescriptors||function(e){var t={};return z(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},H={},Q={get:function(e,t){if(t===U)return e;var n=l(e);if(!o(n,t))return function(e,t,r){var n,i=x(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!r(i)?i:i===I(e.t,t)?(j(e),e.o[t]=R(e.A.h,i,e)):i},has:function(e,t){return t in l(e)},ownKeys:function(e){return Reflect.ownKeys(l(e))},set:function(e,t,r){var n=x(l(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=I(l(e),t),a=null==i?void 0:i[U];if(a&&a.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(s(r,i)&&(void 0!==r||o(e.t,t)))return!0;j(e),A(e)}return e.o[t]=r,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==I(e.t,t)||t in e.t?(e.D[t]=!1,j(e),A(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=l(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){e(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){e(12)}},Y={};n(Q,(function(e,t){Y[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Y.deleteProperty=function(e,t){return Q.deleteProperty.call(this,e[0],t)},Y.set=function(e,t,r){return Q.set.call(this,e[0],t,r,e[0])};var B=new(function(){function n(e){this.O=$,this.N=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var i=n.prototype;return i.produce=function(t,n,i){if("function"==typeof t&&"function"!=typeof n){var o=n;n=t;var a=this;return function(e){var t=this;void 0===e&&(e=o);for(var r=arguments.length,i=Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return a.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(i))}))}}var s;if("function"!=typeof n&&e(6),void 0!==i&&"function"!=typeof i&&e(7),r(t)){var u=w(this),c=R(this,t,void 0),l=!0;try{s=n(c),l=!1}finally{l?m(u):b(u)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return v(u,i),O(e,u)}),(function(e){throw m(u),e})):(v(u,i),O(s,u))}if(!t||"object"!=typeof t){if((s=n(t))===D)return;return void 0===s&&(s=t),this.N&&f(s,!0),s}e(21,t)},i.produceWithPatches=function(e,t){var r,n,i=this;return"function"==typeof e?function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return i.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(n))}))}:[this.produce(e,t,(function(e,t){r=e,n=t})),r,n]},i.createDraft=function(n){r(n)||e(8),t(n)&&(n=k(n));var i=w(this),o=R(this,n,void 0);return o[U].C=!0,b(i),o},i.finishDraft=function(e,t){var r=(e&&e[U]).A;return v(r,t),O(void 0,r)},i.setAutoFreeze=function(e){this.N=e},i.setUseProxies=function(t){t&&!$&&e(20),this.O=t},i.applyPatches=function(e,r){var n;for(n=r.length-1;n>=0;n--){var i=r[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}var o=g("Patches").$;return t(e)?o(e,r):this.produce(e,(function(e){return o(e,r.slice(n+1))}))},n}()),W=B.produce;B.produceWithPatches.bind(B),B.setAutoFreeze.bind(B),B.setUseProxies.bind(B),B.applyPatches.bind(B),B.createDraft.bind(B),B.finishDraft.bind(B);var J=function(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),K=function(){return Math.random().toString(36).substring(7).split("").join(".")},Z={INIT:"@@redux/INIT"+K(),REPLACE:"@@redux/REPLACE"+K(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+K()}};function X(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function G(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(G)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,o=t,a=[],s=a,u=!1;function c(){s===a&&(s=a.slice())}function l(){if(u)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function d(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(u)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return c(),s.push(e),function(){if(t){if(u)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,c();var r=s.indexOf(e);s.splice(r,1),a=null}}}function f(e){if(!X(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,o=i(o,e)}finally{u=!1}for(var t=a=s,r=0;r<t.length;r++){(0,t[r])()}return e}function p(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,f({type:Z.REPLACE})}function h(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(l())}return r(),{unsubscribe:t(r)}}})[J]=function(){return this},e}return f({type:Z.INIT}),(n={dispatch:f,subscribe:d,getState:l,replaceReducer:p})[J]=h,n}function ee(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function te(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];"function"==typeof e[i]&&(r[i]=e[i])}var o,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:Z.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:Z.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+Z.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var n=!1,i={},s=0;s<a.length;s++){var u=a[s],c=r[u],l=e[u],d=c(l,t);if(void 0===d){var f=ee(u,t);throw new Error(f)}i[u]=d,n=n||d!==l}return(n=n||a.length!==Object.keys(e).length)?i:e}}function re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ne(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(r,!0).forEach((function(t){re(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function ae(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},o=t.map((function(e){return e(i)}));return ie({},r,{dispatch:n=oe.apply(void 0,o)(r.dispatch)})}}}function se(e,t){return e===t}function ue(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,i=0;i<n;i++)if(!e(t[i],r[i]))return!1;return!0}function ce(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(i){return"function"==typeof i?i(r,n,e):t(i)}}}}!function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n]}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:se,r=null,n=null;return function(){return ue(t,r,arguments)||(n=e.apply(null,arguments)),r=arguments,n}}));var le=ce();function de(){return(de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function he(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ge(e,t,r){return(ge=he()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&pe(i,r.prototype),i}).apply(null,arguments)}function ye(e){var t="function"==typeof Map?new Map:void 0;return(ye=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return ge(e,arguments,fe(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),pe(n,e)})(e)}le.withExtraArgument=ce;var ve="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?oe:oe.apply(null,arguments)};var me=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=n.prototype;return i.concat=function(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ge(n,(t=e.prototype.concat).call.apply(t,[this].concat(i)))},i.prepend=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 1===t.length&&Array.isArray(t[0])?ge(n,t[0].concat(this)):ge(n,t.concat(this))},n}(ye(Array));function be(){return function(e){return function(e){void 0===e&&(e={});var t=e,r=t.thunk,n=void 0===r||r;t.immutableCheck,t.serializableCheck;var i=new me;n&&(!function(e){return"boolean"==typeof e}(n)?i.push(le.withExtraArgument(n.extraArgument)):i.push(le));return i}(e)}}function we(e){var t,r=be(),n=e||{},i=n.reducer,o=void 0===i?void 0:i,a=n.middleware,s=void 0===a?r():a,u=n.devTools,c=void 0===u||u,l=n.preloadedState,d=void 0===l?void 0:l,f=n.enhancers,p=void 0===f?void 0:f;if("function"==typeof o)t=o;else{if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(o))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=te(o)}var h=ae.apply(void 0,"function"==typeof s?s(r):s),g=oe;c&&(g=ve(de({trace:!1},"object"==typeof c&&c)));var y=[h];return Array.isArray(p)?y=[h].concat(p):"function"==typeof p&&(y=p(y)),G(t,d,g.apply(void 0,y))}function Se(e,t){function r(){if(t){var r=t.apply(void 0,arguments);if(!r)throw new Error("prepareAction did not return an object");return de({type:e,payload:r.payload},"meta"in r&&{meta:r.meta},{},"error"in r&&{error:r.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(t){return t.type===e},r}function Oe(e,n,i,o){void 0===i&&(i=[]);var a="function"==typeof n?function(e){var t,r={},n=[],i={addCase:function(e,t){var n="string"==typeof e?e:e.type;if(n in r)throw new Error("addCase cannot be called with two reducers for the same action type");return r[n]=t,i},addMatcher:function(e,t){return n.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[r,n,t]}(n):[n,i,o],s=a[0],u=a[1],c=a[2];return function(n,i){void 0===n&&(n=e);var o=[s[i.type]].concat(u.filter((function(e){return(0,e.matcher)(i)})).map((function(e){return e.reducer})));return 0===o.filter((function(e){return!!e})).length&&(o=[c]),o.reduce((function(e,n){if(n){if(t(e)){var o=n(e,i);return void 0===o?e:o}if(r(e))return W(e,(function(e){return n(e,i)}));var a=n(e,i);if(void 0===a){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return a}return e}),n)}}"undefined"==typeof Symbol||(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"==typeof Symbol||(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var Ce=["name","message","stack","code"],qe=function(e){this.payload=e,this.name="RejectWithValue",this.message="Rejected"},Ee=function(e){if("object"==typeof e&&null!==e){var t={},r=Ce,n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var o;if(n){if(i>=r.length)break;o=r[i++]}else{if((i=r.next()).done)break;o=i.value}var a=o;"string"==typeof e[a]&&(t[a]=e[a])}return t}return{message:String(e)}};function Ie(e,t,r){var n=Se(e+"/fulfilled",(function(e,t,r){return{payload:e,meta:{arg:r,requestId:t,requestStatus:"fulfilled"}}})),i=Se(e+"/pending",(function(e,t){return{payload:void 0,meta:{arg:t,requestId:e,requestStatus:"pending"}}})),o=Se(e+"/rejected",(function(e,t,n){var i=e instanceof qe,o=!!e&&"AbortError"===e.name,a=!!e&&"ConditionError"===e.name;return{payload:e instanceof qe?e.payload:void 0,error:(r&&r.serializeError||Ee)(e||"Rejected"),meta:{arg:n,requestId:t,rejectedWithValue:i,requestStatus:"rejected",aborted:o,condition:a}}})),a="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(s,u,c){var l,d=function(e){void 0===e&&(e=21);for(var t="",r=e;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),f=new a,p=new Promise((function(e,t){return f.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:l||"Aborted"})}))})),h=!1;var g=function(){try{var a,l=function(e){return g?e:(r&&!r.dispatchConditionRejection&&o.match(a)&&a.meta.condition||s(a),a)},g=!1,y=function(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}((function(){if(r&&r.condition&&!1===r.condition(e,{getState:u,extra:c}))throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return h=!0,s(i(d,e)),Promise.resolve(Promise.race([p,Promise.resolve(t(e,{dispatch:s,getState:u,extra:c,requestId:d,signal:f.signal,rejectWithValue:function(e){return new qe(e)}})).then((function(t){return t instanceof qe?o(t,d,e):n(t,d,e)}))])).then((function(e){a=e}))}),(function(t){a=o(t,d,e)}));return Promise.resolve(y&&y.then?y.then(l):l(y))}catch(e){return Promise.reject(e)}}();return Object.assign(g,{abort:function(e){h&&(l=e,f.abort())},requestId:d,arg:e})}}),{pending:i,rejected:o,fulfilled:n,typePrefix:e})}!function(){function e(e,t){var r=u[e];return r?r.enumerable=t:u[e]=r={configurable:!0,enumerable:t,get:function(){var t=this[U];return Q.get(t,e)},set:function(t){var r=this[U];Q.set(r,e,t)}},r}function r(e){for(var t=e.length-1;t>=0;t--){var r=e[t][U];if(!r.P)switch(r.i){case 5:a(r)&&A(r);break;case 4:i(r)&&A(r)}}}function i(e){for(var t=e.t,r=e.k,n=z(r),i=n.length-1;i>=0;i--){var a=n[i];if(a!==U){var u=t[a];if(void 0===u&&!o(t,a))return!0;var c=r[a],l=c&&c[U];if(l?l.t!==u:!s(c,u))return!0}}var d=!!t[U];return n.length!==z(t).length+(d?0:1)}function a(e){var t=e.k;if(t.length!==e.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}var u={};!function(e,t){H[e]||(H[e]=t)}("ES5",{J:function(t,r){var n=Array.isArray(t),i=function(t,r){if(t){for(var n=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(n,""+i,e(i,!0));return n}var o=N(r);delete o[U];for(var a=z(o),s=0;s<a.length;s++){var u=a[s];o[u]=e(u,t||!!o[u].enumerable)}return Object.create(Object.getPrototypeOf(r),o)}(n,t),o={i:n?5:4,A:r?r.A:y(),P:!1,I:!1,D:{},l:r,t:t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,U,{value:o,writable:!0}),i},S:function(e,i,s){s?t(i)&&i[U].A===e&&r(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var r=t[U];if(r){var i=r.t,s=r.k,u=r.D,c=r.i;if(4===c)n(s,(function(t){t!==U&&(void 0!==i[t]||o(i,t)?u[t]||e(s[t]):(u[t]=!0,A(r)))})),n(i,(function(e){void 0!==s[e]||o(s,e)||(u[e]=!1,A(r))}));else if(5===c){if(a(r)&&(A(r),u.length=!0),s.length<i.length)for(var l=s.length;l<i.length;l++)u[l]=!1;else for(var d=i.length;d<s.length;d++)u[d]=!0;for(var f=Math.min(s.length,i.length),p=0;p<f;p++)void 0===u[p]&&e(s[p])}}}}(e.p[0]),r(e.p))},K:function(e){return 4===e.i?i(e):a(e)}})}();class xe extends Error{constructor(e){super(e),this.name="SchemaValidationError"}}class Ae{constructor(e){this.definition=e}validate(e={},t=""){const r={...this.default,...e},n=[];for(const e in this.definition){const t=this.definition[e].validate(r[e]);t&&n.push(`${e}: ${t}`)}if(n.length)throw function(e,t){const r=`\n  The following properties are invalid:\n\n    ${e.join("\n\t")}\n  \n  ${t}\n  `;return new xe(r)}(n,t);return r}get default(){const e={};for(const t in this.definition){const r=this.definition[t].default;void 0!==r&&(e[t]=r)}return e}}class je{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&ke(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return!0===this.baseConfig.required}}function Re(e){return void 0===e}function ke(e){return Re(e)||function(e){return null===e}(e)}class Pe{constructor(e={}){this.config=e,this.value=new je(e)}validate(e){return this.value.validate(e)||(function(e){return Re(e)||Te(e)}(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}}function Te(e){return"number"==typeof e&&!isNaN(e)}class Me{constructor(e={}){this.value=new je(e)}validate(e){return this.value.validate(e)||(function(e){return Re(e)||_e(e)}(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}}function _e(e){return"boolean"==typeof e}const Fe=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;class Ve{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new je(this.config)}validate(e){const{emptyAllowed:t,url:r,regex:n,constrainTo:i}=this.config,o=this.value.validate(e);return o||(Re(e)?null:$e(e)?t||e.length?r&&!Fe.test(e)?"value is not a valid URL.":n&&!n.test(e)?"value did not match provided regex "+n:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is an empty string.":"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}}function $e(e){return"[object String]"===Object.prototype.toString.call(e)}class De{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(Re(e))return this.config.options.required?"value is required and is currently undefined":null;if(!Le(e))return"value is not an object";for(const[t,r]of Object.entries(this.config.values))if(r.required&&ke(e[t]))return"value does not contain "+t;let t="";for(const[r,n]of Object.entries(this.config.values)){const i=e[r],o=n.validate(i);null!==o&&(t+=" "+o)}return""===t?null:t}get default(){}get required(){return!!this.config.options.required}}function Le(e){return void 0!==e&&"object"==typeof e}class Ue{constructor(e={}){this.config=e,this.value=new je(this.config)}validate(e){if(!ke(e)&&!Array.isArray(e))return"value is not an array";const t=this.value.validate(e);if(null!==t)return t;if(ke(e))return null;if(void 0!==this.config.max&&e.length>this.config.max)return"value contains more than "+this.config.max;if(void 0!==this.config.min&&e.length<this.config.min)return"value contains less than "+this.config.min;if(void 0!==this.config.each){let t="";return e.forEach((r=>{this.config.each.required&&ke(r)&&(t="value is null or undefined: "+e.join(","));const n=this.validatePrimitiveValue(r,this.config.each);null!==n&&(t+=" "+n)})),""===t?null:t}return null}validatePrimitiveValue(e,t){return _e(e)||$e(e)||Te(e)||Le(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}}function ze(e){return Array.isArray(e)}const Ne=new Ve({required:!0,emptyAllowed:!1}),He=new Ve({required:!0,emptyAllowed:!0}),Qe=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),Ye=(e,t)=>"required"in t?{payload:new Ae({value:t}).validate({value:e}).value}:{payload:new Ae(t).validate(e)},Be=(e,t)=>{try{return Ye(e,t)}catch(t){return{payload:e,error:Qe(t)}}},We=(e,t,r,n,i)=>{try{return t.validate(r,n)}catch(t){throw e.logger.error(t,i),t}},Je=new Ve({emptyAllowed:!1,required:!1}),Ke=()=>new Ve({emptyAllowed:!1,required:!1}),Ze=()=>new Ve({emptyAllowed:!1,required:!0}),Xe=Se("configuration/updateBasicConfiguration",(e=>Be(e,{accessToken:new Ve({emptyAllowed:!1}),organizationId:new Ve({emptyAllowed:!1}),platformUrl:new Ve({url:!0,emptyAllowed:!1})}))),Ge=Se("configuration/updateSearchConfiguration",(e=>Be(e,{apiBaseUrl:new Ve({url:!0,emptyAllowed:!1}),pipeline:new Ve({emptyAllowed:!1}),searchHub:new Ve({emptyAllowed:!1}),locale:Je}))),et=Se("configuration/updateAnalyticsConfiguration",(e=>Be(e,{enabled:new Me({default:!0}),originLevel2:Ke(),originLevel3:Ke(),apiBaseUrl:new Ve({url:!0,emptyAllowed:!1}),runtimeEnvironment:new je}))),tt=Se("configuration/analytics/disable"),rt=Se("configuration/analytics/enable"),nt=Se("configuration/analytics/originlevel2",(e=>Be(e,{originLevel2:Ze()}))),it=Se("configuration/analytics/originlevel3",(e=>Be(e,{originLevel3:Ze()})));const ot=e=>()=>t=>r=>{if(!r.error)return t(r);const n=r.error;return e.error(n.stack||n.message||n.name||"Error","Action dispatch error "+r.type,r),"SchemaValidationError"!==r.error.name?t(r):void 0};const at=Se("history/undo"),st=Se("history/redo"),ut=Se("history/snapshot");Ie("history/back",(async(e,{dispatch:t})=>{t(at()),await t(ct())})),Ie("history/forward",(async(e,{dispatch:t})=>{t(st()),await t(ct())}));const ct=Ie("history/change",(async(e,{getState:t})=>t().history.present)),lt=Se("advancedSearchQueries/update",(e=>Be(e,{aq:new Ve({required:!1,emptyAllowed:!0}),cq:new Ve({required:!1,emptyAllowed:!0})}))),dt=Se("advancedSearchQueries/register",(e=>Be(e,{aq:new Ve({required:!1,emptyAllowed:!0}),cq:new Ve({required:!1,emptyAllowed:!0})}))),ft={q:new Ve,enableQuerySyntax:new Me,aq:new Ve,cq:new Ve,firstResult:new Pe({min:0}),numberOfResults:new Pe({min:0}),sortCriteria:new Ve,f:new De,cf:new De,nf:new De,df:new De,debug:new Me},pt=Se("searchParameters/restore",(e=>Be(e,ft))),ht=Oe({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},(e=>{e.addCase(lt,((e,t)=>{const{aq:r,cq:n}=t.payload;Re(r)||(e.aq=r,e.aqWasSet=!0),Re(n)||(e.cq=n,e.cqWasSet=!0)})).addCase(dt,((e,t)=>{const{aq:r,cq:n}=t.payload;Re(r)||(e.defaultFilters.aq=r,e.aqWasSet||(e.aq=r)),Re(n)||(e.defaultFilters.cq=n,e.cqWasSet||(e.cq=n))})).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.advancedSearchQueries)&&void 0!==n?n:e})).addCase(pt,((e,t)=>{const{aq:r,cq:n}=t.payload;Re(r)||(e.aq=r,e.aqWasSet=!0),Re(n)||(e.cq=n,e.cqWasSet=!0)}))}));var gt=fetch,yt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function vt(e){var t={exports:{}};return e(t,t.exports),t.exports}var mt=yt&&yt.__assign||function(){return(mt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},bt={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};var wt=function(e){var t=mt(mt({},bt),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t},St=Object.defineProperty({getSanitizedOptions:wt},"__esModule",{value:!0});var Ot=function(e){var t=Math.random()*e;return Math.round(t)},Ct=Object.defineProperty({fullJitter:Ot},"__esModule",{value:!0});var qt=function(e){return e},Et=Object.defineProperty({noJitter:qt},"__esModule",{value:!0});var It,xt=function(e){switch(e.jitter){case"full":return Ct.fullJitter;case"none":default:return Et.noJitter}},At=Object.defineProperty({JitterFactory:xt},"__esModule",{value:!0}),jt=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return At.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}(),Rt=Object.defineProperty({Delay:jt},"__esModule",{value:!0}),kt=yt&&yt.__extends||(It=function(e,t){return(It=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}It(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Pt=yt&&yt.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},Tt=yt&&yt.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return kt(t,e),t.prototype.apply=function(){return Pt(this,void 0,void 0,(function(){return Tt(this,(function(t){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(Rt.Delay),_t=Object.defineProperty({SkipFirstDelay:Mt},"__esModule",{value:!0}),Ft=yt&&yt.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ft(t,e),t}(Rt.Delay),$t=Object.defineProperty({AlwaysDelay:Vt},"__esModule",{value:!0});var Dt=function(e,t){var r=function(e){if(!e.delayFirstAttempt)return new _t.SkipFirstDelay(e);return new $t.AlwaysDelay(e)}(e);return r.setAttemptNumber(t),r};var Lt=Object.defineProperty({DelayFactory:Dt},"__esModule",{value:!0}),Ut=yt&&yt.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},zt=yt&&yt.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};var Nt=function(e,t){return void 0===t&&(t={}),Ut(this,void 0,void 0,(function(){var r;return zt(this,(function(n){switch(n.label){case 0:return r=St.getSanitizedOptions(t),[4,new Ht(e,r).execute()];case 1:return[2,n.sent()]}}))}))},Ht=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return Ut(this,void 0,void 0,(function(){var e;return zt(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return Ut(this,void 0,void 0,(function(){return zt(this,(function(e){switch(e.label){case 0:return[4,Lt.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}();class Qt extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}}class Yt extends Error{constructor(){super(),this.name="Disconnected",this.message="Client is not connected to the internet."}}function Bt(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function Wt(e){return 429===e}class Jt{static async call(e){const t=function(e){const{url:t,method:r,requestParams:n,contentType:i,accessToken:o,signal:a}=e,s=function(e,t){if("application/x-www-form-urlencoded"===t)return"object"==typeof(r=e)&&r&&Object.values(r).every(Bt)?function(e){const t=[];for(const r in e){const n=encodeURIComponent(r),i=encodeURIComponent(e[r]);t.push(`${n}=${i}`)}return t.join("&")}(e):"";var r;return JSON.stringify(e)}(n,i);return{url:t,method:r,headers:{"Content-Type":i,Authorization:"Bearer "+o,...e.headers},body:s,signal:a}}(e),{preprocessRequest:r,logger:n}=e,i={...t,...r?await r(t,"searchApiFetch"):{}};n.info(i,"Platform request");const{url:o,...a}=i,s=async()=>{const e=await gt(o,a);if(Wt(e.status))throw e;return e};try{const e=await Nt(s,{retry:e=>{const t=e&&Wt(e.status);return t&&n.info("Platform retrying request"),t}});if(419===e.status)throw n.info("Platform renewing token"),new Qt;return n.info({response:e,requestInfo:i},"Platform response"),e}catch(e){return"Failed to fetch"===e.message?new Yt:e}}}function Kt(e){return`https://platform${e&&e.environment&&"prod"!==e.environment?e.environment:""}${e&&e.region&&"us-east-1"!==e.region?"-"+e.region:""}.cloud.coveo.com`}const Zt=Oe({organizationId:"",accessToken:"",platformUrl:Kt(),search:{apiBaseUrl:Kt()+"/rest/search/v2",locale:"en-US"},analytics:{enabled:!0,apiBaseUrl:Kt()+"/rest/ua",originLevel2:"default",originLevel3:"default"}},(e=>e.addCase(Xe,((e,t)=>{t.payload.accessToken&&(e.accessToken=t.payload.accessToken),t.payload.organizationId&&(e.organizationId=t.payload.organizationId),t.payload.platformUrl&&(e.platformUrl=t.payload.platformUrl,e.search.apiBaseUrl=t.payload.platformUrl+"/rest/search/v2",e.analytics.apiBaseUrl=t.payload.platformUrl+"/rest/ua")})).addCase(Ge,((e,t)=>{t.payload.apiBaseUrl&&(e.search.apiBaseUrl=t.payload.apiBaseUrl),t.payload.locale&&(e.search.locale=t.payload.locale)})).addCase(et,((e,t)=>{void 0!==t.payload.enabled&&(e.analytics.enabled=t.payload.enabled),void 0!==t.payload.originLevel2&&(e.analytics.originLevel2=t.payload.originLevel2),void 0!==t.payload.originLevel3&&(e.analytics.originLevel3=t.payload.originLevel3),void 0!==t.payload.apiBaseUrl&&(e.analytics.apiBaseUrl=t.payload.apiBaseUrl),void 0!==t.payload.runtimeEnvironment&&(e.analytics.runtimeEnvironment=t.payload.runtimeEnvironment)})).addCase(tt,(e=>{e.analytics.enabled=!1})).addCase(rt,(e=>{e.analytics.enabled=!0})).addCase(nt,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(it,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})))),Xt=new Ue({each:Ne,required:!0}),Gt=(e,t)=>(Be(e,Ne),$e(t)?Be(t,Ne):Be(t,Xt),{payload:{contextKey:e,contextValue:t}}),er=Se("context/set",(e=>{for(const[t,r]of Object.entries(e))Gt(t,r);return{payload:e}})),tr=Se("context/add",(e=>Gt(e.contextKey,e.contextValue))),rr=Se("context/remove",(e=>Be(e,Ne)));const nr=Oe({contextValues:{}},(e=>{e.addCase(er,((e,t)=>{e.contextValues=t.payload})).addCase(tr,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase(rr,((e,t)=>{delete e.contextValues[t.payload]})).addCase(ct.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.context.contextValues)}))})),ir=Se("debug/enable"),or=Se("debug/disable"),ar=Oe(!1,(e=>{e.addCase(ir,(()=>!0)).addCase(or,(()=>!1)).addCase(pt,((e,t)=>{var r;return null!==(r=t.payload.debug)&&void 0!==r?r:e}))})),sr=Oe("1.7.0",(e=>e)),ur=Se("didYouMean/enable"),cr=Se("didYouMean/disable"),lr=Se("didYouMean/correction",(e=>Be(e,Ne)));function dr(e){if(e instanceof Yt)return{error:{statusCode:0,type:"Disconnected",message:"Could not connect"}};throw e}const fr=(e,t,r,n)=>({accessToken:e.accessToken,method:t,contentType:r,url:`${e.url}${n}?${pr(e)}`}),pr=e=>"organizationId="+e.organizationId;const hr=TextDecoder;class gr{constructor(e){this.options=e,this.searchAbortController=null}async plan(e){const t=await Jt.call({...fr(e,"POST","application/json","/plan"),requestParams:Or(e),...this.options});if(t instanceof Error)return dr(t);const r=await t.json();return function(e){return void 0!==e.preprocessingOutput}(r)?{success:r}:{error:yr({response:t,body:r})}}async querySuggest(e){const t=await Jt.call({...fr(e,"POST","application/json","/querySuggest"),requestParams:Or(e),...this.options});if(t instanceof Error)return dr(t);const r=await t.json(),n={response:t,body:r};if(function(e){return void 0!==e.completions}(r)){return{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}}return{error:yr(n)}}async search(e){var t;this.searchAbortController&&(this.options.logger.warn("Cancelling current pending search query"),this.searchAbortController.abort()),this.searchAbortController=this.getAbortControllerInstanceIfAvailable();const r=await Jt.call({...fr(e,"POST","application/json",""),requestParams:Or(e),...this.options,signal:null===(t=this.searchAbortController)||void 0===t?void 0:t.signal});if(r instanceof Error)return dr(r);this.searchAbortController=null;const n=await r.json(),i={response:r,body:n};if(Sr(n)){i.body=function(e){const t={answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0};if(ke(e.questionAnswer))return e.questionAnswer=t,e;return e.questionAnswer={...t,...e.questionAnswer},e}(n);return{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}}return{error:yr(i)}}async facetSearch(e){const t=await Jt.call({...fr(e,"POST","application/json","/facet"),requestParams:Or(e),...this.options});if(t instanceof Error)throw t;const r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){const t=await Jt.call({...fr(e,"POST","application/json",""),requestParams:Or(e),...this.options});if(t instanceof Error)throw t;const r=await t.json();return Sr(r)?{success:r}:{error:yr({response:t,body:r})}}async html(e){const t=await Jt.call({...fr(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:Or(e),...this.options});if(t instanceof Error)throw t;const r=function(e){return((e.headers.get("content-type")||"").split(";").find((e=>-1!==e.indexOf("charset=")))||"").split("=")[1]||"UTF-8"}(t),n=await t.arrayBuffer(),i=new hr(r).decode(n);return function(e){return"string"==typeof e}(i)?{success:i}:{error:yr({response:t,body:i})}}async productRecommendations(e){const t=await Jt.call({...fr(e,"POST","application/json",""),requestParams:Or(e),...this.options});if(t instanceof Error)throw t;const r=await t.json();return Sr(r)?{success:r}:{error:yr({response:t,body:r})}}getAbortControllerInstanceIfAvailable(){if("undefined"==typeof window){return new(require("node-abort-controller"))}return"undefined"==typeof AbortController?null:new AbortController}}const yr=e=>{const{response:t}=e;return t.body?vr(e):mr(t)},vr=e=>function(e){return void 0!==e.body.exception}(e)?br(e):function(e){return void 0!==e.body.statusCode}(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},mr=e=>{const t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:"Client side error: "+(t.message||""),statusCode:400,type:"ClientError"}},br=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),wr=e=>void 0!==e.error;function Sr(e){return void 0!==e.results}function Or(e){const{url:t,accessToken:r,organizationId:n,...i}=e;return i}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function Cr(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function qr(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}var Er;!function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"}(Er||(Er={}));const Ir=window.fetch;class xr{constructor(e){this.opts=e}sendEvent(e,t){return qr(this,void 0,void 0,(function*(){const{baseUrl:r,visitorIdProvider:n,preprocessRequest:i}=this.opts,o=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",a={url:`${r}/analytics/${e}${o}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},s=Object.assign(Object.assign({},a),i?yield i(a,"analyticsFetch"):{}),{url:u}=s,c=Cr(s,["url"]),l=yield Ir(u,c);if(l.ok){const e=yield l.json();return e.visitorId&&n.setCurrentVisitorId(e.visitorId),e}try{l.json()}catch(e){}throw console.error(`An error has occured when sending the "${e}" event.`,l,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}))}shouldAppendVisitorId(e){return-1!==[Er.click,Er.custom,Er.search,Er.view].indexOf(e)}getVisitorIdParam(){return qr(this,void 0,void 0,(function*(){const{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?"?visitor="+t:""}))}getHeaders(){const{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:"Bearer "+e}:{}),{"Content-Type":"application/json"})}}function Ar(){return"undefined"!=typeof navigator}function jr(){return"undefined"!=typeof document}function Rr(){return"undefined"!=typeof localStorage}function kr(){return Ar()&&navigator.cookieEnabled}function Pr(){return"undefined"!=typeof crypto&&void 0!==crypto.getRandomValues}const Tr=[Er.click,Er.custom,Er.search,Er.view],Mr=(e,t)=>-1!==Tr.indexOf(e)?Object.assign({language:jr()?document.documentElement.lang:"unknown",userAgent:Ar()?navigator.userAgent:"unknown"},t):t;class _r{static set(e,t,r){var n,i,o,a;r?((i=new Date).setTime(i.getTime()+r),o="; expires="+i.toGMTString()):o="",-1===(a=location.hostname).indexOf(".")?document.cookie=e+"="+t+o+"; path=/":((n=a.split(".")).shift(),Fr({name:e,value:t,expires:o,domain:"."+n.join(".")}),null!=_r.get(e)&&_r.get(e)==t||Fr({name:e,value:t,expires:o,domain:"."+a}))}static get(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var i=r[n];if(0==(i=i.replace(/^\s+/,"")).indexOf(t))return i.substring(t.length,i.length)}return null}static erase(e){_r.set(e,"",-1)}}function Fr(e){const{name:t,value:r,expires:n,domain:i}=e;document.cookie=`${t}=${r}${n}; path=/; domain=${i}; SameSite=Lax`}function Vr(){return Rr()?localStorage:kr()?new $r:"undefined"!=typeof sessionStorage?sessionStorage:new Lr}class $r{getItem(e){return _r.get(`${$r.prefix}${e}`)}removeItem(e){_r.erase(`${$r.prefix}${e}`)}setItem(e,t){_r.set(`${$r.prefix}${e}`,t)}}$r.prefix="coveo_";class Dr{constructor(){this.cookieStorage=new $r}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t)}}class Lr{getItem(e){return null}removeItem(e){}setItem(e,t){}}const Ur="__coveo.analytics.history";class zr{constructor(e){this.store=e||Vr()}addElement(e){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=this.getHistoryWithInternalTime();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return qr(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=yield this.getHistoryWithInternalTimeAsync();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){const e=this.getHistoryWithInternalTime();return this.stripInternalTime(e)}getHistoryAsync(){return qr(this,void 0,void 0,(function*(){const e=yield this.getHistoryWithInternalTimeAsync();return this.stripInternalTime(e)}))}getHistoryWithInternalTime(){try{const e=this.store.getItem(Ur);return e&&"string"==typeof e?JSON.parse(e):[]}catch(e){return[]}}getHistoryWithInternalTimeAsync(){return qr(this,void 0,void 0,(function*(){try{const e=yield this.store.getItem(Ur);return e?JSON.parse(e):[]}catch(e){return[]}}))}setHistory(e){try{this.store.setItem(Ur,JSON.stringify(e.slice(0,20)))}catch(e){}}clear(){try{this.store.removeItem(Ur)}catch(e){}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();if(null!=e){return e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]}return null}cropQueryElement(e){e.name&&"query"==e.name.toLowerCase()&&null!=e.value&&(e.value=e.value.slice(0,75))}isValidEntry(e){let t=this.getMostRecentElement();return!t||t.value!=e.value||(e.internalTime||0)-(t.internalTime||0)>6e4}stripInternalTime(e){return e.map((e=>{const{name:t,time:r,value:n}=e;return{name:t,time:r,value:n}}))}}var Nr=Object.freeze({__proto__:null,STORE_KEY:Ur,MAX_NUMBER_OF_HISTORY_ELEMENTS:20,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:6e4,MAX_VALUE_SIZE:75,HistoryStore:zr,default:zr});const Hr=(e,t)=>qr(void 0,void 0,void 0,(function*(){return e===Er.view?(yield Qr(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),Qr=e=>qr(void 0,void 0,void 0,(function*(){const t=new zr,r={name:"PageView",value:e,time:JSON.stringify(new Date)};yield t.addElementAsync(r)})),Yr=e=>e?(Number(e)^Br(new Uint8Array(1))[0]%16>>Number(e)/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,Yr),Br=e=>{if(Pr())return crypto.getRandomValues(e);for(var t=0,r=0;t<e.length;t++)0==(3&t)&&(r=4294967296*Math.random()),e[t]=r>>>((3&t)<<3)&255;return e},Wr=Object.keys,Jr={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},Kr=[...Wr(Jr).map((e=>Jr[e]))].join("|"),Zr=new RegExp(`^(${Kr}$)`),Xr=[e=>Zr.test(e)],Gr={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},en={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr"},tn={action:"pa",list:"pal",listSource:"pls"},rn={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},nn={id:"quoteId",affiliation:"quoteAffiliation"},on={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},an={add:tn,bookmark_add:tn,bookmark_remove:tn,click:tn,checkout:tn,checkout_option:tn,detail:tn,impression:tn,remove:tn,refund:Object.assign(Object.assign({},tn),rn),purchase:Object.assign(Object.assign({},tn),rn),quickview:tn,quote:Object.assign(Object.assign({},tn),nn),review:Object.assign(Object.assign({},tn),on)},sn=Wr(Gr).map((e=>Gr[e])),un=Wr(en).map((e=>en[e])),cn=Wr(tn).map((e=>tn[e])),ln=Wr(rn).map((e=>rn[e])),dn=Wr(on).map((e=>on[e])),fn=Wr(nn).map((e=>nn[e])),pn=[...sn,"custom"].join("|"),hn=[...un,"custom"].join("|"),gn=new RegExp(`^(pr[0-9]+)(${pn})$`),yn=new RegExp(`^((il[0-9]+pi[0-9]+)(${hn}))|(il[0-9]+nm)$`),vn=new RegExp(`^(${cn.join("|")})$`),mn=new RegExp(`^(${ln.join("|")})$`),bn=new RegExp("^(pr[0-9]+)custom$"),wn=new RegExp("^(il[0-9]+pi[0-9]+)custom$"),Sn=new RegExp(`^(${["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit",...dn,...fn].join("|")})$`),On=[e=>yn.test(e),e=>gn.test(e),e=>vn.test(e),e=>mn.test(e),e=>Sn.test(e)],Cn=[bn,wn],qn=Object.assign(Object.assign(Object.assign({},{anonymizeIp:"aip"}),{eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"}),{hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"}),En=Object.assign(Object.assign({},qn),{svcAction:"svc_action",svcActionData:"svc_action_data"}),In=Wr(En).map((e=>En[e])),xn=e=>-1!==In.indexOf(e),An=e=>"custom"===e,jn=e=>{let t=void 0;return[...Cn].every((r=>{var n;return t=null===(n=r.exec(e))||void 0===n?void 0:n[1],!Boolean(t)})),t},Rn=(e,t)=>Wr(t).reduce(((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]})),{});class kn{constructor(e){this.opts=e}sendEvent(e,t){return qr(this,void 0,void 0,(function*(){if(!navigator.sendBeacon)throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');const{baseUrl:r,preprocessRequest:n}=this.opts,i=this.encodeForEventType(e,t),o=yield this.getQueryParamsForEventType(e),a={url:`${r}/analytics/${e}?${o}`,body:new Blob([i],{type:"application/x-www-form-urlencoded"})},{url:s,body:u}=Object.assign(Object.assign({},a),n?yield n(a,"analyticsBeacon"):{});console.log(`Sending beacon for "${e}" with: `,JSON.stringify(t)),navigator.sendBeacon(s,u)}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeForLegacyType(e,t):this.encodeForFormUrlEncoded(Object.assign({access_token:this.opts.token},t))}getQueryParamsForEventType(e){return qr(this,void 0,void 0,(function*(){const{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?"access_token="+t:"",n?"visitorId="+n:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return-1!==[Er.click,Er.custom,Er.search,Er.view].indexOf(e)}encodeForLegacyType(e,t){return`${e}Event=${encodeURIComponent(JSON.stringify(t))}`}encodeForFormUrlEncoded(e){return Object.keys(e).filter((t=>!!e[t])).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(this.encodeValue(e[t]))}`)).join("&")}encodeValue(e){return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e:JSON.stringify(e)}}class Pn{sendEvent(e,t){return qr(this,void 0,void 0,(function*(){return Promise.resolve()}))}}class Tn{constructor(e,t){Rr()&&kr()?this.storage=new Dr:Rr()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Lr),this.beaconClient=new kn(e),window.addEventListener("beforeunload",(()=>t()))}}class Mn{constructor(e,t){this.storage=t||new Lr,this.beaconClient=new xr(e)}}class _n{constructor(){this.storage=new Lr,this.beaconClient=new Pn}}const Fn="https://analytics.cloud.coveo.com/rest/ua";class Vn{constructor(e){if(!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Hr,Mr].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};const t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.analyticsFetchClient=new xr(t)}get defaultOptions(){return{endpoint:Fn,token:"",version:"v15",beforeSendHooks:[],afterSendHooks:[]}}initRuntime(e){return"undefined"!=typeof window&&jr()?new Tn(e,(()=>this.flushBufferWithBeacon())):("undefined"!=typeof navigator&&"ReactNative"==navigator.product&&console.warn("\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please install @react-native-async-storage/async-storage and instantiate \n        your analytics client as follows:\n        \n        import {ReactNativeRuntime} from 'coveo.analytics/react-native';\n        \n        const analytics = new CoveoAnalytics({\n            ...your options,\n            runtimeEnvironment: new ReactNativeRuntime();\n        })\n    "),new Mn(e))}get analyticsBeaconClient(){return this.runtime.beaconClient}get storage(){return this.runtime.storage}determineVisitorId(){return qr(this,void 0,void 0,(function*(){try{return(yield this.storage.getItem("visitorId"))||Yr()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Yr()}}))}getCurrentVisitorId(){return qr(this,void 0,void 0,(function*(){if(!this.visitorId){const e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return qr(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}getParameters(e,...t){return qr(this,void 0,void 0,(function*(){return yield this.resolveParameters(e,...t)}))}getPayload(e,...t){return qr(this,void 0,void 0,(function*(){const r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)}))}get currentVisitorId(){return"string"!=typeof(this.visitorId||this.storage.getItem("visitorId"))&&this.setCurrentVisitorId(Yr()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}resolveParameters(e,...t){return qr(this,void 0,void 0,(function*(){const{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:i=!1}=this.eventTypeMapping[e]||{};return yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>qr(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{visitorId:n?yield this.getCurrentVisitorId():""})})),e=>i?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,r)=>qr(this,void 0,void 0,(function*(){const n=yield t;return yield r(e,n)}))),t)].reduce(((e,t)=>qr(this,void 0,void 0,(function*(){const r=yield e;return yield t(r)}))),Promise.resolve(t))}))}resolvePayloadForParameters(e,t){return qr(this,void 0,void 0,(function*(){const{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[t=>this.removeEmptyPayloadValues(t,e),e=>this.validateParams(e),e=>r?(e=>{const t=!!e.action&&an[e.action]||{};return Wr(e).reduce(((r,n)=>{const i=t[n]||En[n]||n;return Object.assign(Object.assign({},r),{[i]:e[n]})}),{})})(e):e,e=>r?this.removeUnknownParameters(e):e,e=>r?this.processCustomParameters(e):e].reduce(((e,t)=>qr(this,void 0,void 0,(function*(){const r=yield e;return yield t(r)}))),Promise.resolve(t))}))}sendEvent(e,...t){return qr(this,void 0,void 0,(function*(){const{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),i=yield this.resolvePayloadForParameters(e,n);return this.bufferedRequests.push({eventType:r,payload:i,handled:!1}),yield Promise.all(this.afterSendHooks.map((t=>t(e,n)))),yield this.deferExecution(),yield this.sendFromBufferWithFetch()}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}flushBufferWithBeacon(){for(;this.hasPendingRequests();){const{eventType:e,payload:t}=this.bufferedRequests.pop();this.analyticsBeaconClient.sendEvent(e,t)}}sendFromBufferWithFetch(){return qr(this,void 0,void 0,(function*(){const e=this.bufferedRequests.shift();if(e){const{eventType:t,payload:r}=e;return this.analyticsFetchClient.sendEvent(t,r)}}))}hasPendingRequests(){return this.bufferedRequests.length>0}clear(){this.storage.removeItem("visitorId");(new zr).clear()}sendSearchEvent(e){return qr(this,void 0,void 0,(function*(){return this.sendEvent(Er.search,e)}))}sendClickEvent(e){return qr(this,void 0,void 0,(function*(){return this.sendEvent(Er.click,e)}))}sendCustomEvent(e){return qr(this,void 0,void 0,(function*(){return this.sendEvent(Er.custom,e)}))}sendViewEvent(e){return qr(this,void 0,void 0,(function*(){return this.sendEvent(Er.view,e)}))}getVisit(){return qr(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/visit"),t=yield e.json();return this.visitorId=t.visitorId,t}))}getHealth(){return qr(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/monitoring/health");return yield e.json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}parseVariableArgumentsPayload(e,t){const r={};for(let n=0,i=t.length;n<i;n++){const i=t[n];if("string"==typeof i)r[e[n]]=i;else if("object"==typeof i)return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return-1!==({[Er.search]:["queryText"]}[e]||[]).indexOf(t)}removeEmptyPayloadValues(e,t){return Object.keys(e).filter((r=>{return this.isKeyAllowedEmpty(t,r)||null!=(n=e[r])&&""!==n;var n})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if((e=>[...On,...Xr,xn,An].some((t=>t(e))))(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}processCustomParameters(e){const{custom:t}=e,r=Cr(e,["custom"]),n=this.lowercaseKeys(t),i=Wr(o=r).reduce(((e,t)=>{const r=jn(t);return r?Object.assign(Object.assign({},e),Rn(r,o[t])):Object.assign(Object.assign({},e),{[t]:o[t]})}),{});var o;return Object.assign(Object.assign({},n),i)}lowercaseKeys(e){return Object.keys(e||{}).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r.toLowerCase()]:e[r]})),{})}validateParams(e){const{anonymizeIp:t}=e,r=Cr(e,["anonymizeIp"]);return void 0!==t&&-1==["0","false","undefined","null","{}","[]",""].indexOf((""+t).toLowerCase())&&(r.anonymizeIp=1),r}ensureAnonymousUserWhenUsingApiKey(e){const{userId:t}=e,r=Cr(e,["userId"]);return(null==(n=this.options.token)?void 0:n.startsWith("xx"))&&!t?(r.userId="anonymous",r):e;var n}get baseUrl(){const{version:e,endpoint:t}=this.options,r=-1!==t.indexOf(".cloud.coveo.com");return`${t}${r?"":"/rest"}/${e}`}}var $n;!function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion"}($n||($n={}));const Dn={[$n.triggerNotify]:"queryPipelineTriggers",[$n.triggerExecute]:"queryPipelineTriggers",[$n.triggerQuery]:"queryPipelineTriggers",[$n.triggerRedirect]:"queryPipelineTriggers",[$n.queryError]:"errors",[$n.queryErrorBack]:"errors",[$n.queryErrorClear]:"errors",[$n.queryErrorRetry]:"errors",[$n.pagerNext]:"getMoreResults",[$n.pagerPrevious]:"getMoreResults",[$n.pagerNumber]:"getMoreResults",[$n.pagerResize]:"getMoreResults",[$n.pagerScrolling]:"getMoreResults",[$n.facetSearch]:"facet",[$n.facetShowLess]:"facet",[$n.facetShowMore]:"facet",[$n.recommendation]:"recommendation",[$n.likeSmartSnippet]:"smartSnippet",[$n.dislikeSmartSnippet]:"smartSnippet",[$n.expandSmartSnippet]:"smartSnippet",[$n.collapseSmartSnippet]:"smartSnippet",[$n.openSmartSnippetFeedbackModal]:"smartSnippet",[$n.closeSmartSnippetFeedbackModal]:"smartSnippet",[$n.sendSmartSnippetReason]:"smartSnippet",[$n.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[$n.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions"};var Ln;!function(e){e.DoesNotAnswer="does_not_answer",e.PartiallyAnswers="partially_answers",e.WasNotAQuestion="was_not_a_question",e.Other="other"}(Ln||(Ln={}));class Un{constructor(){this.runtime=new _n,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}sendEvent(){return Promise.resolve()}sendSearchEvent(){return Promise.resolve()}sendClickEvent(){return Promise.resolve()}sendCustomEvent(){return Promise.resolve()}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}}function zn(e){const t=e.join(";");return t.length<=256?t:zn(e.slice(1))}const Nn=e=>zn(function(e){let t="";return e.filter((e=>{const r=e!==t;return t=e,r}))}(function(e){return e.map((e=>e.replace(/;/g,"")))}(e)));function Hn(e){const t="string"==typeof e.partialQueries?e.partialQueries:Nn(e.partialQueries),r="string"==typeof e.suggestions?e.suggestions:Nn(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}class Qn{constructor(e,t){this.opts=e,this.provider=t,this.coveoAnalyticsClient=!1===e.enableAnalytics?new Un:new Vn(e)}disable(){this.coveoAnalyticsClient instanceof Vn&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Un}enable(){this.coveoAnalyticsClient=new Vn(this.opts)}logInterfaceLoad(){return this.logSearchEvent($n.interfaceLoad)}logRecommendationInterfaceLoad(){return this.logSearchEvent($n.recommendationInterfaceLoad)}logRecommendation(){return this.logCustomEvent($n.recommendation)}logRecommendationOpen(e,t){return this.logClickEvent($n.recommendationOpen,e,t)}logFetchMoreResults(){return this.logCustomEvent($n.pagerScrolling,{type:"getMoreResults"})}logInterfaceChange(e){return this.logSearchEvent($n.interfaceChange,e)}logDidYouMeanAutomatic(){return this.logSearchEvent($n.didyoumeanAutomatic)}logDidYouMeanClick(){return this.logSearchEvent($n.didyoumeanClick)}logResultsSort(e){return this.logSearchEvent($n.resultsSort,e)}logSearchboxSubmit(){return this.logSearchEvent($n.searchboxSubmit)}logSearchboxClear(){return this.logSearchEvent($n.searchboxClear)}logSearchboxAsYouType(){return this.logSearchEvent($n.searchboxAsYouType)}logBreadcrumbFacet(e){return this.logSearchEvent($n.breadcrumbFacet,e)}logBreadcrumbResetAll(){return this.logSearchEvent($n.breadcrumbResetAll)}logDocumentQuickview(e,t){return this.logClickEvent($n.documentQuickview,e,t)}logDocumentOpen(e,t){return this.logClickEvent($n.documentOpen,e,t)}logOmniboxAnalytics(e){return this.logSearchEvent($n.omniboxAnalytics,Hn(e))}logOmniboxFromLink(e){return this.logSearchEvent($n.omniboxFromLink,Hn(e))}logSearchFromLink(){return this.logSearchEvent($n.searchFromLink)}logTriggerNotify(e){return this.logCustomEvent($n.triggerNotify,e)}logTriggerExecute(e){return this.logCustomEvent($n.triggerExecute,e)}logTriggerQuery(){const e={query:this.provider.getSearchEventRequestPayload().queryText};return this.logCustomEvent($n.triggerQuery,e)}logTriggerRedirect(e){const t=Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText});return this.logCustomEvent($n.triggerRedirect,t)}logPagerResize(e){return this.logCustomEvent($n.pagerResize,e)}logPagerNumber(e){return this.logCustomEvent($n.pagerNumber,e)}logPagerNext(e){return this.logCustomEvent($n.pagerNext,e)}logPagerPrevious(e){return this.logCustomEvent($n.pagerPrevious,e)}logPagerScrolling(){return this.logCustomEvent($n.pagerScrolling)}logFacetClearAll(e){return this.logSearchEvent($n.facetClearAll,e)}logFacetSearch(e){return this.logSearchEvent($n.facetSearch,e)}logFacetSelect(e){return this.logSearchEvent($n.facetSelect,e)}logFacetDeselect(e){return this.logSearchEvent($n.facetDeselect,e)}logFacetExclude(e){return this.logSearchEvent($n.facetExclude,e)}logFacetUnexclude(e){return this.logSearchEvent($n.facetUnexclude,e)}logFacetSelectAll(e){return this.logSearchEvent($n.facetSelectAll,e)}logFacetUpdateSort(e){return this.logSearchEvent($n.facetUpdateSort,e)}logFacetShowMore(e){return this.logCustomEvent($n.facetShowMore,e)}logFacetShowLess(e){return this.logCustomEvent($n.facetShowLess,e)}logQueryError(e){return this.logCustomEvent($n.queryError,e)}logQueryErrorBack(){return qr(this,void 0,void 0,(function*(){return yield this.logCustomEvent($n.queryErrorBack),this.logSearchEvent($n.queryErrorBack)}))}logQueryErrorRetry(){return qr(this,void 0,void 0,(function*(){return yield this.logCustomEvent($n.queryErrorRetry),this.logSearchEvent($n.queryErrorRetry)}))}logQueryErrorClear(){return qr(this,void 0,void 0,(function*(){return yield this.logCustomEvent($n.queryErrorClear),this.logSearchEvent($n.queryErrorClear)}))}logLikeSmartSnippet(){return this.logCustomEvent($n.likeSmartSnippet)}logDislikeSmartSnippet(){return this.logCustomEvent($n.dislikeSmartSnippet)}logExpandSmartSnippet(){return this.logCustomEvent($n.expandSmartSnippet)}logCollapseSmartSnippet(){return this.logCustomEvent($n.collapseSmartSnippet)}logOpenSmartSnippetFeedbackModal(){return this.logCustomEvent($n.openSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return this.logCustomEvent($n.closeSmartSnippetFeedbackModal)}logSmartSnippetFeedbackReason(e,t){return this.logCustomEvent($n.sendSmartSnippetReason,{reason:e,details:t})}logExpandSmartSnippetSuggestion(e){return this.logCustomEvent($n.expandSmartSnippetSuggestion,{documentId:e})}logCollapseSmartSnippetSuggestion(e){return this.logCustomEvent($n.collapseSmartSnippetSuggestion,{documentId:e})}logCustomEvent(e,t){const r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),n=Object.assign(Object.assign({},this.getBaseCustomEventRequest(r)),{eventType:Dn[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(n)}logCustomEventWithType(e,t,r){const n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},this.getBaseCustomEventRequest(n)),{eventType:t,eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(i)}logSearchEvent(e,t){return this.coveoAnalyticsClient.sendSearchEvent(this.getBaseSearchEventRequest(e,t))}logClickEvent(e,t,r,n){const i=Object.assign(Object.assign(Object.assign({},t),this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(i)}getBaseSearchEventRequest(e,t){return Object.assign(Object.assign(Object.assign({},this.getBaseEventRequest(t)),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})}getBaseCustomEventRequest(e){return Object.assign(Object.assign({},this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})}getBaseEventRequest(e){const t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[]})}getOrigins(){return{originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}}const Yn=e=>{const t=e.configuration.search.locale.split("-")[0];return t&&2===t.length?t:"en"};function Bn(e){if(!e)return{parents:[],values:[]};let t=[],r=e;for(;r.length&&r[0].children.length;)t=[...t,...r],r=r[0].children;const n=r.find((e=>"selected"===e.state));return n&&(t=[...t,n],r=[]),{parents:t,values:r}}const Wn=(e,t)=>{const r=((e,t)=>{const r=((e,t)=>e.search.response.facets.find((e=>e.facetId===t)))(e,t);if(function(e,t){return!!t&&t.facetId in e.categoryFacetSet}(e,r))return r})(e,t);return Bn(null==r?void 0:r.values).parents};function Jn(e){return{facetSet:e.facetSet||{},categoryFacetSet:e.categoryFacetSet||{},dateFacetSet:e.dateFacetSet||{},numericFacetSet:e.numericFacetSet||{},search:e.search||{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]}}}const Kn=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),Zn=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Xn=e=>({displayValue:e.value,value:e.value}),Gn=(e,t)=>{const r=((e,t)=>Wn(e,t).map((e=>e.value)).join(";"))(e,t);return{value:r,valuePosition:1,displayValue:r}},ei=(e,t)=>({title:`${e.field}_${e.facetId}`,field:e.field,id:e.facetId,facetPosition:t}),ti=(e,t)=>{var r;return e.facetSet[t]||(null===(r=e.categoryFacetSet[t])||void 0===r?void 0:r.request)||e.dateFacetSet[t]||e.numericFacetSet[t]},ri=(e,t)=>{const r=ti(e,t);return r?r.type:"specific"};class ni{constructor(e){this.state=e}getLanguage(){return Yn(this.state)}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults,getBaseMetadata:this.getBaseMetadata()}}getBaseMetadata(){const{context:e}=this.state,t=(null==e?void 0:e.contextValues)||{},r={};for(const[e,n]of Object.entries(t)){r["context_"+e]=n}return r}getSearchUID(){var e,t;return(null===(e=this.state.search)||void 0===e?void 0:e.response.searchUid)||(null===(t=this.state.recommendation)||void 0===t?void 0:t.searchUid)||""}getPipeline(){return this.state.pipeline||"default"}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}getFacetState(){return(e=>{const t=[];return e.search.response.facets.forEach(((r,n)=>{const i=ri(e,r.facetId),o=ei(r,n+1);if("hierarchical"!==i)r.values.forEach(((e,r)=>{if("idle"===e.state)return;const n=Kn(e,r+1,i),a="specific"===i?Xn(e):Zn(e);t.push({...o,...n,...a})}));else{if(!Wn(e,r.facetId).length)return;t.push({...o,...Gn(e,r.facetId),facetType:i,state:"selected"})}})),t})(Jn(this.state))}mapResultsToAnalyticsDocument(){var e;return null===(e=this.state.search)||void 0===e?void 0:e.response.results.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get queryText(){var e;return(null===(e=this.state.query)||void 0===e?void 0:e.q)||""}get responseTime(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.duration)||0}get numberOfResults(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.response.results.length)||[].length}}const ii=()=>new Vn({}).currentVisitorId,oi=new Nr.HistoryStore;var ai;!function(e){e[e.Search=0]="Search",e[e.Custom=1]="Custom",e[e.Click=2]="Click"}(ai||(ai={}));const si=(e,t,r,n=(e=>new ni(e)))=>Ie(e,(async(e,{getState:i,extra:{analyticsClientMiddleware:o,preprocessRequest:a,logger:s}})=>{const u=(e=>e())(i),c=(({logger:e,state:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new ni(t)})=>{const o=t.configuration.accessToken,a=t.configuration.analytics.apiBaseUrl,s=t.configuration.analytics.runtimeEnvironment,u=new Qn({token:o,endpoint:a,runtimeEnvironment:s,preprocessRequest:n,beforeSendHooks:[r,(t,r)=>(e.info({...r,type:t,endpoint:a,token:o},"Analytics request"),r)]},i);return!1===t.configuration.analytics.enabled&&u.disable(),u})({state:u,logger:s,analyticsClientMiddleware:o,preprocessRequest:a,provider:n(u)}),l=await r(c,u);return s.info({client:c.coveoAnalyticsClient,response:l},"Analytics response"),{analyticsType:t}})),ui=(e,t)=>{var r;const n=(null===(r=t.recommendation)||void 0===r?void 0:r.recommendations.findIndex((({uniqueId:t})=>e.uniqueId===t)))||0;return function(e,t,r){const n=e.raw.collection;return{collectionName:"string"==typeof n?n:"default",documentAuthor:di(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:fi(e),queryPipeline:r.pipeline||"default"}}(e,n,t)};const ci={urihash:new Ve,sourcetype:new Ve,permanentid:new Ve},li={uniqueId:Ne,raw:new De({values:ci}),title:Ne,uri:Ne,clickUri:Ne,rankingModifier:new Ve({required:!1,emptyAllowed:!0})};function di(e){const t=e.raw.author;return ke(t)?"unknown":Array.isArray(t)?t.join(";"):""+t}function fi(e){const t=e.raw.source;return ke(t)?"unknown":t}const pi=e=>new Ae(li).validate(function(e){return Object.assign({},...Object.keys(li).map((t=>({[t]:e[t]}))),{raw:(t=e.raw,Object.assign({},...Object.keys(ci).map((e=>({[e]:t[e]})))))});var t}(e));si("analytics/didyoumean/click",ai.Search,(e=>e.logDidYouMeanClick()));const hi=si("analytics/didyoumean/automatic",ai.Search,(e=>e.logDidYouMeanAutomatic())),gi=Se("query/updateQuery",(e=>Be(e,{q:new Ve,enableQuerySyntax:new Me})));var yi,vi;!function(e){e.Ascending="ascending",e.Descending="descending"}(yi||(yi={})),function(e){e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort"}(vi||(vi={}));const mi=e=>{if(ze(e))return e.map((e=>mi(e))).join(",");switch(e.by){case vi.Relevancy:case vi.QRE:case vi.NoSort:return e.by;case vi.Date:return"date "+e.order;case vi.Field:return`@${e.field} ${e.order}`;default:return""}};function bi(){return mi({by:vi.Relevancy})}function wi(e){var t,r;return{context:e.context||{contextValues:{}},facetSet:e.facetSet||{},numericFacetSet:e.numericFacetSet||{},dateFacetSet:e.dateFacetSet||{},categoryFacetSet:e.categoryFacetSet||{},pagination:e.pagination||{firstResult:0,numberOfResults:10,totalCountFiltered:0},query:e.query||{q:"",enableQuerySyntax:!1},advancedSearchQueries:e.advancedSearchQueries||{cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},querySet:e.querySet||{},sortCriteria:e.sortCriteria||bi(),pipeline:e.pipeline||"default",searchHub:e.searchHub||"default",facetOptions:e.facetOptions||{freezeFacetOrder:!1},facetOrder:null!==(t=e.facetOrder)&&void 0!==t?t:[],debug:null!==(r=e.debug)&&void 0!==r&&r}}const Si=si("search/logFetchMoreResults",ai.Search,(e=>e.logFetchMoreResults())),Oi=e=>si("search/queryError",ai.Search,((t,r)=>{var n,i,o;return t.logQueryError({query:(null===(n=r.query)||void 0===n?void 0:n.q)||"",aq:(null===(i=r.advancedSearchQueries)||void 0===i?void 0:i.aq)||"",cq:(null===(o=r.advancedSearchQueries)||void 0===o?void 0:o.cq)||"",dq:"",errorType:e.type,errorMessage:e.message})}))(),Ci=async(e,t,r)=>{var n;const i=(new Date).getTime();return{response:await e.search(r),duration:(new Date).getTime()-i,queryExecuted:(null===(n=t.query)||void 0===n?void 0:n.q)||"",requestExecuted:r}},qi=Ie("search/executeSearch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{const o=t();Ti(o);const a=await Ci(i.searchAPIClient,o,ji(o));if(wr(a.response))return r(Oi(a.response.error)),n(a.response.error);if(!Ai(o,a.response.success))return r(ut(wi(o))),{...a,response:a.response.success,automaticallyCorrected:!1,originalQuery:Mi(o),analyticsAction:e};const{correctedQuery:s}=a.response.success.queryCorrections[0],u=await xi(i.searchAPIClient,s,t,r);if(wr(u.response))return r(Oi(u.response.error)),n(u.response.error);const c=a.response.success;return e(r,(()=>Ii(a.queryExecuted,a.duration,o,c)),i),r(ut(wi(t()))),{...u,response:{...u.response.success,queryCorrections:a.response.success.queryCorrections},automaticallyCorrected:!0,originalQuery:Mi(o),analyticsAction:hi()}})),Ei=Ie("search/fetchMoreResults",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:{searchAPIClient:i}})=>{const o=t(),a=await Ci(i,o,Ri(o));return wr(a.response)?(r(Oi(a.response.error)),n(a.response.error)):(r(ut(wi(o))),{...a,response:a.response.success,automaticallyCorrected:!1,originalQuery:Mi(o),analyticsAction:Si()})})),Ii=(e,t,r,n)=>{var i,o;return{...r,query:{q:e,enableQuerySyntax:null!==(o=null===(i=r.query)||void 0===i?void 0:i.enableQuerySyntax)&&void 0!==o&&o},search:{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],duration:t,response:n,results:n.results}}},xi=async(e,t,r,n)=>{n(gi({q:t}));const i=await Ci(e,r(),ji(r()));return n(lr(t)),i},Ai=(e,t)=>{var r;return!0===(null===(r=e.didYouMean)||void 0===r?void 0:r.enableDidYouMean)&&0===t.results.length&&0!==t.queryCorrections.length},ji=e=>{var t;const r=function(e){var t;return function(e,t){const r={};e.forEach((e=>r[e.facetId]=e));const n=[];t.forEach((e=>{e in r&&(n.push(r[e]),delete r[e])}));const i=Object.values(r);return[...n,...i]}(function(e){return[...Pi(e.facetSet),...Pi(e.numericFacetSet),...Pi(e.dateFacetSet),...ki(e.categoryFacetSet)]}(e),null!==(t=e.facetOrder)&&void 0!==t?t:[])}(e);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,...e.configuration.analytics.enabled&&{visitorId:ii()},...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.context&&{context:e.context.contextValues},...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},...r.length&&{facets:r},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.pagination&&{numberOfResults:e.pagination.numberOfResults,firstResult:e.pagination.firstResult},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.facetOptions&&{facetOptions:e.facetOptions},...(null===(t=e.folding)||void 0===t?void 0:t.enabled)&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange}}},Ri=e=>{var t,r,n,i;return{...ji(e),firstResult:(null!==(r=null===(t=e.pagination)||void 0===t?void 0:t.firstResult)&&void 0!==r?r:0)+(null!==(i=null===(n=e.search)||void 0===n?void 0:n.results.length)&&void 0!==i?i:0)}};function ki(e){return Object.values(e||{}).map((e=>e.request))}function Pi(e={}){return Object.keys(e).map((t=>e[t]))}const Ti=e=>{var t;e.configuration.analytics.enabled&&oi.addElement({name:"Query",value:(null===(t=e.query)||void 0===t?void 0:t.q)||"",time:JSON.stringify(new Date)})},Mi=e=>{var t;return void 0!==(null===(t=e.query)||void 0===t?void 0:t.q)?e.query.q:""};Oe({enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:{correctedQuery:"",wordCorrections:[],originalQuery:""},originalQuery:""},(e=>{e.addCase(ur,(e=>{e.enableDidYouMean=!0})).addCase(cr,(e=>{e.enableDidYouMean=!1})).addCase(qi.pending,(e=>{e.queryCorrection={correctedQuery:"",wordCorrections:[],originalQuery:""},e.wasAutomaticallyCorrected=!1,e.wasCorrectedTo=""})).addCase(qi.fulfilled,((e,t)=>{e.queryCorrection=t.payload.response.queryCorrections[0]||{correctedQuery:"",wordCorrections:[],originalQuery:""},e.originalQuery=t.payload.originalQuery,e.wasAutomaticallyCorrected=t.payload.automaticallyCorrected})).addCase(lr,((e,t)=>{e.wasCorrectedTo=t.payload}))}));const _i=Se("facetOptions/update",(e=>Be(e,{freezeFacetOrder:new Me({required:!1})})));Oe({freezeFacetOrder:!1},(e=>{e.addCase(_i,((e,t)=>({...e,...t.payload}))).addCase(qi.fulfilled,(e=>{e.freezeFacetOrder=!1})).addCase(qi.rejected,(e=>{e.freezeFacetOrder=!1})).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.facetOptions)&&void 0!==n?n:e}))}));const Fi=Ne,Vi={state:new je({required:!0}),numberOfResults:new Pe({required:!0,min:0}),value:new Ve({required:!0,emptyAllowed:!0}),path:new Ue({required:!0,each:Ne}),moreValuesAvailable:new Me({required:!1})};function $i(e){e.children.forEach((e=>{$i(e)})),Ye({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},Vi)}const Di={facetId:Fi,field:Ne,delimitingCharacter:new Ve({required:!1,emptyAllowed:!0}),filterFacetCount:new Me({required:!1}),injectionDepth:new Pe({required:!1,min:0}),numberOfValues:new Pe({required:!1,min:1}),sortCriteria:new je({required:!1}),basePath:new Ue({required:!1,each:Ne}),filterByBasePath:new Me({required:!1})},Li=Se("categoryFacet/register",(e=>Be(e,Di))),Ui=Se("categoryFacet/toggleSelectValue",(e=>{try{return Ye(e.facetId,Ne),$i(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Qe(t)}}})),zi=Se("categoryFacet/deselectAll",(e=>Be(e,Fi))),Ni=Se("categoryFacet/updateNumberOfValues",(e=>Be(e,{facetId:Fi,numberOfValues:new Pe({required:!0,min:1})}))),Hi=Se("categoryFacet/updateSortCriterion",(e=>Be(e,{facetId:Fi,criterion:new je})));function Qi(e,t){const{facetId:r,criterion:n}=t,i=e[r];i&&(i.sortCriteria=n)}function Yi(e){e&&(e.currentValues=e.currentValues.map((e=>({...e,state:"idle"}))),e.preventAutoSelect=!0)}function Bi(e,t){e&&(e.numberOfValues=t)}const Wi={facetId:Fi,captions:new De({options:{required:!1}}),numberOfValues:new Pe({required:!1,min:1}),query:new Ve({required:!1,emptyAllowed:!0})},Ji={path:new Ue({required:!0,each:Ne}),displayValue:He,rawValue:He,count:new Pe({required:!0,min:0})},Ki=Se("categoryFacet/selectSearchResult",(e=>Be(e,{facetId:Fi,value:new De({values:Ji})}))),Zi=Se("categoryFacetSearch/register",(e=>Be(e,Wi))),Xi=Se("facet/deselectAllFacets");function Gi(e,t,r){e.currentValues=function(e,t){if(!e.length)return[];const r=eo(e[0],t);let n=r;for(const r of e.splice(1)){const e=eo(r,t);n.children.push(e),n=e}return n.state="selected",n.retrieveChildren=!0,[r]}(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function eo(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}Oe({},(e=>{e.addCase(Li,((e,t)=>{const r=t.payload,{facetId:n}=r;if(n in e)return;const i=(o=r,{...to,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...o});var o;const a=i.numberOfValues;e[n]={request:i,initialNumberOfValues:a}})).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.categoryFacetSet)&&void 0!==n?n:e})).addCase(pt,((e,t)=>{const r=t.payload.cf||{};Object.keys(e).forEach((t=>{Gi(e[t].request,r[t]||[],e[t].initialNumberOfValues)}))})).addCase(Hi,((e,t)=>{var r;const{facetId:n,criterion:i}=t.payload,o=null===(r=e[n])||void 0===r?void 0:r.request;o&&(o.sortCriteria=i)})).addCase(Ui,((e,t)=>{var r;const{facetId:n,selection:i,retrieveCount:o}=t.payload,a=null===(r=e[n])||void 0===r?void 0:r.request;if(!a)return;let s=a.currentValues;const{path:u}=i,c=u.slice(0,u.length-1);for(const e of c){const t=s[0];if(e!==t.value)return;t.retrieveChildren=!1,t.state="idle",s=t.children}if(s.length){const e=s[0];return e.retrieveChildren=!0,e.state="selected",void(e.children=[])}const l=function(e,t){const{value:r}=e;return{value:r,state:"selected",children:[],retrieveChildren:!0,retrieveCount:t}}(i,o);s.push(l),a.numberOfValues=1})).addCase(zi,((e,t)=>{ro(e,t.payload)})).addCase(Xi,(e=>{Object.keys(e).forEach((t=>ro(e,t)))})).addCase(Ni,((e,t)=>{var r;const{facetId:n,numberOfValues:i}=t.payload,o=null===(r=e[n])||void 0===r?void 0:r.request;if(o)return o.currentValues.length?void function(e,t){var r;const{facetId:n,numberOfValues:i}=t;let o=null===(r=e[n])||void 0===r?void 0:r.request.currentValues[0];if(!o)return;for(;o.children.length&&"selected"!==(null==o?void 0:o.state);)o=o.children[0];o.retrieveCount=i}(e,t.payload):Bi(o,i)})).addCase(Ki,((e,t)=>{const{facetId:r,value:n}=t.payload,i=e[r];if(!i)return;const o=[...n.path,n.rawValue];Gi(i.request,o,i.initialNumberOfValues)})).addCase(qi.fulfilled,((e,t)=>{const{facets:r}=t.payload.response;r.forEach((t=>{var r;if(!function(e,t){return t.facetId in e}(e,t))return;const n=t.facetId,i=null===(r=e[n])||void 0===r?void 0:r.request;if(!i)return;const o=function(e,t){const r=Bn(e.currentValues).parents,n=Bn(t.values).parents;return r.length!==n.length}(i,t);i.currentValues=o?[]:i.currentValues,i.preventAutoSelect=!1}))}))}));const to={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0};function ro(e,t){const r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function no(e,t,r){const{facetId:n}=t;if(e[n])return;const i={...lo,...t},o=r();e[n]={options:i,isLoading:!1,response:o,initialNumberOfValues:i.numberOfValues,requestId:""}}function io(e,t){const{facetId:r,...n}=t,i=e[r];i&&(i.options={...i.options,...n})}function oo(e,t,r){const n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function ao(e,t){const r=e[t];r&&(r.isLoading=!1)}function so(e,t,r){const{facetId:n,response:i}=t,o=e[n];o&&o.requestId===r&&(o.isLoading=!1,o.response=i)}function uo(e,t,r){const{facetId:n}=t,i=e[n];i&&(i.requestId="",i.isLoading=!1,i.response=r(),i.options.numberOfValues=i.initialNumberOfValues,i.options.query=lo.query)}function co(e,t){Object.keys(e).forEach((r=>uo(e,{facetId:r},t)))}Oe([],(e=>{e.addCase(qi.fulfilled,((e,t)=>t.payload.response.facets.map((e=>e.facetId)))).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.facetOrder)&&void 0!==n?n:e}))}));const lo={captions:{},numberOfValues:10,query:""},fo={facetId:Fi,value:new De({values:{displayValue:He,rawValue:He,count:new Pe({required:!0,min:0})}})},po=Se("facetSearch/register",(e=>Be(e,Wi))),ho=Se("facetSearch/update",(e=>Be(e,Wi))),go=Se("facetSearch/toggleSelectValue",(e=>Be(e,fo)));const yo=e=>si("analytics/facet/search",ai.Search,((t,r)=>{Be(e,Fi);const n=Jn(r),i=((e,t)=>{const r=ti(t,e),n=r?r.field:"";return{facetId:e,facetField:n,facetTitle:`${n}_${e}`}})(e,n);return t.logFacetSearch(i)}))(),vo=e=>{const t=[];let r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t},mo=Ie("facetSearch/executeSearch",(async(e,{dispatch:t,getState:r,extra:{searchAPIClient:n,validatePayload:i}})=>{const o=r();let a;i(e,Ne),a=wo(o,e)?((e,t)=>{const{captions:r,query:n,numberOfValues:i}=t.facetSearchSet[e].options,{field:o,delimitingCharacter:a,currentValues:s}=t.facetSet[e],u=ji(t),c=s.filter((e=>"idle"!==e.state)).map((e=>e.value)),l=`*${n}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,captions:r,numberOfValues:i,query:l,field:o,delimitingCharacter:a,ignoreValues:c,searchContext:u,type:"specific"}})(e,o):((e,t)=>{const r=t.categoryFacetSearchSet[e].options,n=t.categoryFacetSet[e].request,{captions:i,query:o,numberOfValues:a}=r,{field:s,delimitingCharacter:u,basePath:c}=n,l=ji(t),d=vo(n),f=d.length?[d]:[],p=`*${o}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,basePath:c,captions:i,numberOfValues:a,query:p,field:s,delimitingCharacter:u,ignorePaths:f,searchContext:l,type:"hierarchical"}})(e,o);const s=await n.facetSearch(a);return t(yo(e)),{facetId:e,response:s}})),bo=Se("facetSearch/clearResults",(e=>Be(e,{facetId:Fi}))),wo=(e,t)=>void 0!==e.facetSearchSet&&void 0!==e.facetSet&&void 0!==e.facetSet[t];function So(){return{moreValuesAvailable:!1,values:[]}}function Oo(){return{moreValuesAvailable:!1,values:[]}}Oe({},(e=>{e.addCase(Zi,((e,t)=>{no(e,t.payload,So)})).addCase(ho,((e,t)=>{io(e,t.payload)})).addCase(mo.pending,((e,t)=>{oo(e,t.meta.arg,t.meta.requestId)})).addCase(mo.rejected,((e,t)=>{ao(e,t.meta.arg)})).addCase(mo.fulfilled,((e,t)=>{so(e,t.payload,t.meta.requestId)})).addCase(bo,((e,{payload:{facetId:t}})=>{uo(e,{facetId:t},So)})).addCase(qi.fulfilled,(e=>{co(e,So)}))})),Oe({},(e=>{e.addCase(po,((e,t)=>{no(e,t.payload,Oo)})).addCase(ho,((e,t)=>{io(e,t.payload)})).addCase(mo.pending,((e,t)=>{oo(e,t.meta.arg,t.meta.requestId)})).addCase(mo.rejected,((e,t)=>{ao(e,t.meta.arg)})).addCase(mo.fulfilled,((e,t)=>{so(e,t.payload,t.meta.requestId)})).addCase(bo,((e,{payload:t})=>{uo(e,t,Oo)})).addCase(qi.fulfilled,(e=>{co(e,Oo)}))}));const Co={value:Ne,numberOfResults:new Pe({min:0}),state:Ne},qo={facetId:Fi,field:new Ve({required:!0,emptyAllowed:!0}),delimitingCharacter:new Ve({required:!1,emptyAllowed:!0}),filterFacetCount:new Me({required:!1}),injectionDepth:new Pe({required:!1,min:0}),numberOfValues:new Pe({required:!1,min:1}),sortCriteria:new je({required:!1})},Eo=Se("facet/register",(e=>Be(e,qo))),Io=Se("facet/toggleSelectValue",(e=>Be(e,{facetId:Fi,selection:new De({values:Co})}))),xo=Se("facet/deselectAll",(e=>Be(e,Fi))),Ao=Se("facet/updateSortCriterion",(e=>Be(e,{facetId:Fi,criterion:new je({required:!0})}))),jo=Se("facet/updateNumberOfValues",(e=>Be(e,{facetId:Fi,numberOfValues:new Pe({required:!0,min:1})}))),Ro=Se("facet/updateIsFieldExpanded",(e=>Be(e,{facetId:Fi,isFieldExpanded:new Me({required:!0})}))),ko=Se("facet/updateFreezeCurrentValues",(e=>Be(e,{facetId:Fi,freezeCurrentValues:new Me({required:!0})})));Oe({},(e=>{e.addCase(Eo,((e,t)=>{const{facetId:r}=t.payload;var n;r in e||(e[r]=(n=t.payload,{...Po,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...n}))})).addCase(ct.fulfilled,((e,t)=>{if(t.payload&&0!==Object.keys(t.payload.facetSet).length)return t.payload.facetSet})).addCase(pt,((e,t)=>{const r=t.payload.f||{};Object.keys(e).forEach((t=>{const n=e[t],i=r[t]||[];n.currentValues=i.map(Mo),n.preventAutoSelect=!0,n.numberOfValues=Math.max(i.length,n.numberOfValues)}))})).addCase(Io,((e,t)=>{const{facetId:r,selection:n}=t.payload,i=e[r];if(!i)return;const o=i.currentValues.find((e=>e.value===n.value));if(!o)return;const a="selected"===o.state;o.state=a?"idle":"selected",i.freezeCurrentValues=!0,i.preventAutoSelect=!0})).addCase(ko,((e,t)=>{const{facetId:r,freezeCurrentValues:n}=t.payload,i=e[r];i&&(i.freezeCurrentValues=n)})).addCase(xo,((e,t)=>{Yi(e[t.payload])})).addCase(Xi,(e=>{Object.keys(e).forEach((t=>{Yi(e[t])}))})).addCase(Ao,((e,t)=>{Qi(e,t.payload)})).addCase(jo,((e,t)=>{const{facetId:r,numberOfValues:n}=t.payload;Bi(e[r],n)})).addCase(Ro,((e,t)=>{const{facetId:r,isFieldExpanded:n}=t.payload,i=e[r];i&&(i.isFieldExpanded=n)})).addCase(qi.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>{const r=t.facetId,n=e[r];n&&(n.currentValues=t.values.map(To),n.freezeCurrentValues=!1,n.preventAutoSelect=!1)}))})).addCase(go,((e,t)=>{const{facetId:r,value:n}=t.payload,i=e[r];if(!i)return;const{rawValue:o}=n,{currentValues:a}=i,s=a.find((e=>e.value===o));if(s)return void(s.state="selected");const u=Mo(o),c=a.findIndex((e=>"idle"===e.state)),l=-1===c?a.length:c,d=a.slice(0,l),f=a.slice(l+1);i.currentValues=[...d,u,...f],i.numberOfValues=i.currentValues.length,i.freezeCurrentValues=!0,i.preventAutoSelect=!0}))}));const Po={delimitingCharacter:">",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic"};function To(e){const{value:t,state:r}=e;return{value:t,state:r}}function Mo(e){return{value:e,state:"selected"}}var _o=vt((function(e,t){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",o="minute",a="hour",s="day",u="week",c="month",l="quarter",d="year",f="date",p="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},m={s:v,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+v(n,2,"0")+":"+v(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),o=r-i<0,a=t.clone().add(n+(o?-1:1),c);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:u,d:s,D:f,h:a,m:o,s:i,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=y;var S=function(e){return e instanceof E},O=function(e,t,r){var n;if(!e)return b;if("string"==typeof e)w[e]&&(n=e),t&&(w[e]=t,n=e);else{var i=e.name;w[i]=e,n=i}return!r&&n&&(b=n),n||!r&&b},C=function(e,t){if(S(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new E(r)},q=m;q.l=O,q.i=S,q.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function y(e){this.$L=O(e.locale,null,!0),this.parse(e)}var v=y.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(q.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(h);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return q},v.isValid=function(){return!(this.$d.toString()===p)},v.isSame=function(e,t){var r=C(e);return this.startOf(t)<=r&&r<=this.endOf(t)},v.isAfter=function(e,t){return C(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<C(e)},v.$g=function(e,t,r){return q.u(e)?this[t]:this.set(r,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var r=this,n=!!q.u(t)||t,l=q.p(e),p=function(e,t){var i=q.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(s)},h=function(e,t){return q.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},g=this.$W,y=this.$M,v=this.$D,m="set"+(this.$u?"UTC":"");switch(l){case d:return n?p(1,0):p(31,11);case c:return n?p(1,y):p(0,y+1);case u:var b=this.$locale().weekStart||0,w=(g<b?g+7:g)-b;return p(n?v-w:v+(6-w),y);case s:case f:return h(m+"Hours",0);case a:return h(m+"Minutes",1);case o:return h(m+"Seconds",2);case i:return h(m+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var r,u=q.p(e),l="set"+(this.$u?"UTC":""),p=(r={},r[s]=l+"Date",r[f]=l+"Date",r[c]=l+"Month",r[d]=l+"FullYear",r[a]=l+"Hours",r[o]=l+"Minutes",r[i]=l+"Seconds",r[n]=l+"Milliseconds",r)[u],h=u===s?this.$D+(t-this.$W):t;if(u===c||u===d){var g=this.clone().set(f,1);g.$d[p](h),g.init(),this.$d=g.set(f,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](h);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[q.p(e)]()},v.add=function(n,l){var f,p=this;n=Number(n);var h=q.p(l),g=function(e){var t=C(p);return q.w(t.date(t.date()+Math.round(e*n)),p)};if(h===c)return this.set(c,this.$M+n);if(h===d)return this.set(d,this.$y+n);if(h===s)return g(1);if(h===u)return g(7);var y=(f={},f[o]=t,f[a]=r,f[i]=e,f)[h]||1,v=this.$d.getTime()+n*y;return q.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this;if(!this.isValid())return p;var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=q.z(this),i=this.$locale(),o=this.$H,a=this.$m,s=this.$M,u=i.weekdays,c=i.months,l=function(e,n,i,o){return e&&(e[n]||e(t,r))||i[n].substr(0,o)},d=function(e){return q.s(o%12||12,e,"0")},f=i.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},h={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:q.s(s+1,2,"0"),MMM:l(i.monthsShort,s,c,3),MMMM:l(c,s),D:this.$D,DD:q.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,u,2),ddd:l(i.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(o),HH:q.s(o,2,"0"),h:d(1),hh:d(2),a:f(o,a,!0),A:f(o,a,!1),m:String(a),mm:q.s(a,2,"0"),s:String(this.$s),ss:q.s(this.$s,2,"0"),SSS:q.s(this.$ms,3,"0"),Z:n};return r.replace(g,(function(e,t){return t||h[e]||n.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(n,f,p){var h,g=q.p(f),y=C(n),v=(y.utcOffset()-this.utcOffset())*t,m=this-y,b=q.m(this,y);return b=(h={},h[d]=b/12,h[c]=b,h[l]=b/3,h[u]=(m-v)/6048e5,h[s]=(m-v)/864e5,h[a]=m/r,h[o]=m/t,h[i]=m/e,h)[g]||m,p?b:q.a(b)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return w[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=O(e,t,!0);return n&&(r.$L=n),r},v.clone=function(){return q.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},y}(),I=E.prototype;return C.prototype=I,[["$ms",n],["$s",i],["$m",o],["$H",a],["$W",s],["$M",c],["$y",d],["$D",f]].forEach((function(e){I[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,E,C),e.$i=!0),C},C.locale=O,C.isDayjs=S,C.unix=function(e){return C(1e3*e)},C.en=w[b],C.Ls=w,C.p={},C}()}));const Fo={state:Ne,start:new Pe({required:!0}),end:new Pe({required:!0}),endInclusive:new Me({required:!0}),numberOfResults:new Pe({required:!0,min:0})},Vo={start:Ne,end:Ne,endInclusive:new Me({required:!0}),state:Ne,numberOfResults:new Pe({required:!0,min:0})};var $o=vt((function(e,t){e.exports=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,i,o){var a=i.prototype;o.utc=function(e){return new i({date:e,utc:!0,args:arguments})},a.utc=function(t){var r=o(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},a.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var u=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var c=a.utcOffset;a.utcOffset=function(n,i){var o=this.$utils().u;if(o(n))return this.$u?0:o(this.$offset)?c.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var i=(""+n[0]).match(r)||["-",0,0],o=i[0],a=60*+i[1]+ +i[2];return 0===a?0:"+"===o?a:-a}(n)))return this;var a=Math.abs(n)<=16?60*n:n,s=this;if(i)return s.$offset=a,s.$u=0===n,s;if(0!==n){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+u,e)).$offset=a,s.$x.$localOffset=u}else s=this.utc();return s};var l=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=a.diff;a.diff=function(e,t,r){if(e&&this.$u===e.$u)return f.call(this,e,t,r);var n=this.local(),i=o(e).local();return f.call(n,i,t,r)}}}()})),Do=vt((function(e,t){e.exports=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^\s\d-_:/()]+/,o={},a=function(e){return function(t){this[e]=+t}},s=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],u=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},c=function(e,t){var r,n=o.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},l={A:[i,function(e){this.afternoon=c(e,!1)}],a:[i,function(e){this.afternoon=c(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,a("seconds")],ss:[n,a("seconds")],m:[n,a("minutes")],mm:[n,a("minutes")],H:[n,a("hours")],h:[n,a("hours")],HH:[n,a("hours")],hh:[n,a("hours")],D:[n,a("day")],DD:[r,a("day")],Do:[i,function(e){var t=o.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,a("month")],MM:[r,a("month")],MMM:[i,function(e){var t=u("months"),r=(u("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=u("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,a("year")],YY:[r,function(e){e=+e,this.year=e+(e>68?1900:2e3)}],YYYY:[/\d{4}/,a("year")],Z:s,ZZ:s};function d(r){var n,i;n=r,i=o&&o.formats;for(var a=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var o=n&&n.toUpperCase();return r||i[n]||e[n]||i[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),s=a.length,u=0;u<s;u+=1){var c=a[u],d=l[c],f=d&&d[0],p=d&&d[1];a[u]=p?{regex:f,parser:p}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<s;r+=1){var i=a[r];if("string"==typeof i)n+=i.length;else{var o=i.regex,u=i.parser,c=e.substr(n),l=o.exec(c)[0];u.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0;var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,a=e.args;this.$u=n;var s=a[1];if("string"==typeof s){var u=!0===a[2],c=!0===a[3],l=u||c,f=a[2];c&&(f=a[2]),o=this.$locale(),!u&&f&&(o=r.Ls[f]),this.$d=function(e,t,r){try{var n=d(t)(e),i=n.year,o=n.month,a=n.day,s=n.hours,u=n.minutes,c=n.seconds,l=n.milliseconds,f=n.zone,p=new Date,h=a||(i||o?1:p.getDate()),g=i||p.getFullYear(),y=0;i&&!o||(y=o>0?o-1:p.getMonth());var v=s||0,m=u||0,b=c||0,w=l||0;return f?new Date(Date.UTC(g,y,h,v,m,b,w+60*f.offset*1e3)):r?new Date(Date.UTC(g,y,h,v,m,b,w)):new Date(g,y,h,v,m,b,w)}catch(e){return new Date("")}}(t,s,n),this.init(),f&&!0!==f&&(this.$L=this.locale(f).$L),l&&t!==this.format(s)&&(this.$d=new Date("")),o={}}else if(s instanceof Array)for(var p=s.length,h=1;h<=p;h+=1){a[1]=s[h-1];var g=r.apply(this,a);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}h===p&&(this.$d=new Date(""))}else i.call(this,e)}}}()}));function Lo(e,t){const{dateFormat:r,useLocalTime:n}=t,i=_o(e,r);if(!i.isValid())throw new Error(`Could not parse the provided date "${e}".\n      Please provide a dateFormat string in the configuration options.\n      See https://day.js.org/docs/en/parse/string-format for more information.\n       `);return function(e){const t="YYYY/MM/DD@HH:mm:ss";return e.format(t)}(n?i:i.utc())}_o.extend($o),_o.extend(Do);const Uo=Se("rangeFacet/updateSortCriterion",(e=>Be(e,{facetId:Fi,criterion:new je({required:!0})}))),zo={start:Ne,end:Ne,endInclusive:new Me({required:!0}),state:Ne},No={facetId:Fi,field:Ne,currentValues:new Ue({required:!1,each:new De({values:zo})}),generateAutomaticRanges:new Me({required:!0}),filterFacetCount:new Me({required:!1}),injectionDepth:new Pe({required:!1,min:0}),numberOfValues:new Pe({required:!1,min:1}),sortCriteria:new je({required:!1}),rangeAlgorithm:new je({required:!1})};function Ho(e){e.currentValues&&e.currentValues.forEach((e=>{const{start:t,end:r}={start:Lo((n=e).start,n),end:Lo(n.end,n),endInclusive:null!==(i=n.endInclusive)&&void 0!==i&&i,state:null!==(o=n.state)&&void 0!==o?o:"idle"};var n,i,o;if(_o(t).isAfter(_o(r)))throw new Error(`The start value is greater than the end value for the date range ${e.start} to ${e.end}`)}))}const Qo=Se("dateFacet/register",(e=>{try{return Ye(e,No),Ho(e),{payload:e,error:null}}catch(t){return{payload:e,error:Qe(t)}}})),Yo=Se("dateFacet/toggleSelectValue",(e=>Be(e,{facetId:Fi,selection:new De({values:Vo})}))),Bo=Se("dateFacet/updateFacetValues",(e=>{try{return Ye(e,{facetId:Fi,values:new Ue({each:new De({values:Vo})})}),Ho({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Qe(t)}}})),Wo=Uo,Jo=xo,Ko={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even"};function Zo(e,t){const{facetId:r}=t;if(r in e)return;const n=ia(t);e[r]={...t,numberOfValues:n}}function Xo(e,t,r){const n=e[t];n&&(n.currentValues=r,n.numberOfValues=ia(n))}function Go(e,t,r){const n=e[t];if(!n)return;const i=na(n.currentValues,r);if(!i)return;const o="selected"===i.state;i.state=o?"idle":"selected",n.preventAutoSelect=!0}function ea(e,t){const r=e[t];r&&r.currentValues.forEach((e=>e.state="idle"))}function ta(e,t){Object.entries(e).forEach((([e,r])=>{const n=t[e]||[];r.currentValues.forEach((e=>{const t=!!na(n,e);return e.state=t?"selected":"idle",e}));const i=n.filter((e=>!na(r.currentValues,e))),o=r.currentValues;o.push(...i),r.numberOfValues=Math.max(r.numberOfValues,o.length)}))}function ra(e,t,r){t.forEach((t=>{const n=t.facetId,i=e[n];if(!i)return;const o=r(t.values);i.currentValues=o,i.preventAutoSelect=!1}))}function na(e,t){const{start:r,end:n}=t;return e.find((e=>e.start===r&&e.end===n))}function ia(e){const{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}function oa(e){return e.map((e=>{const{numberOfResults:t,...r}=e;return r}))}Oe({},(e=>{e.addCase(Qo,((e,t)=>{const{payload:r}=t;var n;Zo(e,(n=r,{...Ko,currentValues:[],preventAutoSelect:!1,type:"dateRange",...n}))})).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.dateFacetSet)&&void 0!==n?n:e})).addCase(pt,((e,t)=>{ta(e,t.payload.df||{})})).addCase(Yo,((e,t)=>{const{facetId:r,selection:n}=t.payload;Go(e,r,n)})).addCase(Bo,((e,t)=>{const{facetId:r,values:n}=t.payload;Xo(e,r,n)})).addCase(Jo,((e,t)=>{ea(e,t.payload)})).addCase(Xi,(e=>{Object.keys(e).forEach((t=>{ea(e,t)}))})).addCase(Wo,((e,t)=>{Qi(e,t.payload)})).addCase(qi.fulfilled,((e,t)=>{ra(e,t.payload.response.facets,oa)}))}));const aa={state:Ne,start:new Pe({required:!0}),end:new Pe({required:!0}),endInclusive:new Me({required:!0})},sa={facetId:Fi,field:Ne,currentValues:new Ue({required:!1,each:new De({values:aa})}),generateAutomaticRanges:new Me({required:!0}),filterFacetCount:new Me({required:!1}),injectionDepth:new Pe({required:!1,min:0}),numberOfValues:new Pe({required:!1,min:1}),sortCriteria:new je({required:!1}),rangeAlgorithm:new je({required:!1})};function ua(e){e.currentValues&&e.currentValues.forEach((({start:e,end:t})=>{if(e>t)throw new Error(`The start value is greater than the end value for the numeric range ${e} to ${t}`)}))}const ca=Se("numericFacet/register",(e=>{try{return Be(e,sa),ua(e),{payload:e,error:null}}catch(t){return{payload:e,error:Qe(t)}}})),la=Se("numericFacet/toggleSelectValue",(e=>Be(e,{facetId:Fi,selection:new De({values:Fo})}))),da=Se("numericFacet/updateFacetValues",(e=>{try{return Ye(e,{facetId:Fi,values:new Ue({each:new De({values:Fo})})}),ua({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Qe(t)}}})),fa=Uo,pa=xo;function ha(e){return e.map((e=>{const{numberOfResults:t,...r}=e;return r}))}Oe({},(e=>{e.addCase(ca,((e,t)=>{const{payload:r}=t;var n;Zo(e,(n=r,{...Ko,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...n}))})).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.numericFacetSet)&&void 0!==n?n:e})).addCase(pt,((e,t)=>{ta(e,t.payload.nf||{})})).addCase(la,((e,t)=>{const{facetId:r,selection:n}=t.payload;Go(e,r,n)})).addCase(da,((e,t)=>{const{facetId:r,values:n}=t.payload;Xo(e,r,n)})).addCase(pa,((e,t)=>{ea(e,t.payload)})).addCase(Xi,(e=>{Object.keys(e).forEach((t=>{ea(e,t)}))})).addCase(fa,((e,t)=>{Qi(e,t.payload)})).addCase(qi.fulfilled,((e,t)=>{ra(e,t.payload.response.facets,ha)}))}));const ga=new Ue({each:Ne,required:!0}),ya=Se("fields/registerFieldsToInclude",(e=>Be(e,ga))),va={collectionField:new Ve,parentField:new Ve,childField:new Ve,numberOfFoldedResults:new Pe({min:0})},ma=Se("folding/register",(e=>Be(e,va))),ba=Ie("folding/loadCollection",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const{folding:{fields:i},configuration:{accessToken:o,organizationId:a,search:{apiBaseUrl:s}}}=t(),u=await n.search({tab:"",referrer:"",accessToken:o,organizationId:a,url:s,aq:`@${i.collection} = ${e}`,numberOfResults:100});return wr(u)?r(u.error):{collectionId:e,results:u.success.results}})),wa=Oe({fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},(e=>e.addCase(ya,((e,t)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(t.payload))]})).addCase(ma,((e,{payload:t})=>{var r,n,i;const o={collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"};e.fieldsToInclude.push(null!==(r=t.collectionField)&&void 0!==r?r:o.collection,null!==(n=t.parentField)&&void 0!==n?n:o.parent,null!==(i=t.childField)&&void 0!==i?i:o.child)}))));function Sa(e,t){return e.raw[t.parent]}function Oa(e,t){const r=e.raw[t.child];return n=r,Array.isArray(n)?r[0]:r;var n}function Ca(e){return e.childResults?e.childResults.flatMap((e=>[e,...Ca(e)])):[]}function qa(e,t,r,n=[]){const i=Oa(e,r);return i?-1!==n.indexOf(i)?[]:t.filter((t=>{const n=Oa(t,r)===Oa(e,r);return Sa(t,r)===i&&!n})).map((e=>({result:e,children:qa(e,t,r,[...n,i])}))):[]}function Ea(e,t){return e.find((e=>{const r=void 0===Sa(e,t),n=(i=Sa(e,t),o=Oa(e,t),void 0!==(i||o)&&i===o);var i,o;return r||n}))}function Ia(e){const t=Ca(e),r=[e,...t].filter((e=>e.parentResult)).map((e=>e.parentResult));var n,i;return n=[e,...t,...r],i=e=>e.uniqueId,Object.values(n.reduce(((e,t,r)=>({...e,[i(t,r)]:t})),{}))}function xa(e,t){const r={};return e.forEach((e=>{const n=function(e,t){return e.raw[t.collection]}(e,t);n&&Oa(e,t)&&(r[n]=function(e,t){var r;const n=Ia(e),i=null!==(r=Ea(n,t))&&void 0!==r?r:e;return{result:i,children:qa(i,n,t),moreResultsAvailable:!0,isLoadingMoreResults:!1}}(e,t))})),r}Oe({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}},(e=>e.addCase(qi.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?xa(t.response.results,e.fields):{}})).addCase(Ei.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?{...e.collections,...xa(t.response.results,e.fields)}:{}})).addCase(ma,((e,{payload:t})=>{var r,n,i,o;return e.enabled?e:{enabled:!0,collections:{},fields:{collection:null!==(r=t.collectionField)&&void 0!==r?r:e.fields.collection,parent:null!==(n=t.parentField)&&void 0!==n?n:e.fields.parent,child:null!==(i=t.childField)&&void 0!==i?i:e.fields.child},filterFieldRange:null!==(o=t.numberOfFoldedResults)&&void 0!==o?o:e.filterFieldRange}})).addCase(ba.pending,((e,{meta:t})=>{const r=t.arg;e.collections[r].isLoadingMoreResults=!0})).addCase(ba.rejected,((e,{meta:t})=>{const r=t.arg;e.collections[r].isLoadingMoreResults=!1})).addCase(ba.fulfilled,((e,{payload:{collectionId:t,results:r}})=>{const n=Ea(r,e.fields);n&&(e.collections[t]={result:n,children:qa(n,r,e.fields),moreResultsAvailable:!1,isLoadingMoreResults:!1})})))),vt((function(e,t){!function(e){var t="function"==typeof WeakSet,r=Object.keys;function n(e,t){return e===t||e!=e&&t!=t}function i(e){return e.constructor===Object||null==e.constructor}function o(e){return!!e&&"function"==typeof e.then}function a(e){return!(!e||!e.$$typeof)}function s(){var e=[];return{add:function(t){e.push(t)},has:function(t){return-1!==e.indexOf(t)}}}var u=t?function(){return new WeakSet}:s;function c(e){return function(t){var r=e||t;return function(e,t,n){void 0===n&&(n=u());var i=!!e&&"object"==typeof e,o=!!t&&"object"==typeof t;if(i||o){var a=i&&n.has(e),s=o&&n.has(t);if(a||s)return a&&s;i&&n.add(e),o&&n.add(t)}return r(e,t,n)}}}function l(e,t,r,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!r(e[i],t[i],n))return!1;return!0}function d(e,t,r,n){var i=e.size===t.size;return i&&e.size&&e.forEach((function(e,o){i&&(i=!1,t.forEach((function(t,a){!i&&r(o,a,n)&&(i=r(e,t,n))})))})),i}var f="_owner",p=Function.prototype.bind.call(Function.prototype.call,Object.prototype.hasOwnProperty);function h(e,t,n,i){var o=r(e),s=o.length;if(r(t).length!==s)return!1;if(s)for(var u=void 0;s-- >0;){if((u=o[s])===f){var c=a(e),l=a(t);if((c||l)&&c!==l)return!1}if(!p(t,u)||!n(e[u],t[u],i))return!1}return!0}function g(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex}function y(e,t,r,n){var i=e.size===t.size;return i&&e.size&&e.forEach((function(e){i&&(i=!1,t.forEach((function(t){i||(i=r(e,t,n))})))})),i}var v="function"==typeof Map,m="function"==typeof Set;function b(e){var t="function"==typeof e?e(r):r;function r(e,r,a){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(i(e)&&i(r))return h(e,r,t,a);var s=Array.isArray(e),u=Array.isArray(r);return s||u?s===u&&l(e,r,t,a):(s=e instanceof Date,u=r instanceof Date,s||u?s===u&&n(e.getTime(),r.getTime()):(s=e instanceof RegExp,u=r instanceof RegExp,s||u?s===u&&g(e,r):o(e)||o(r)?e===r:v&&(s=e instanceof Map,u=r instanceof Map,s||u)?s===u&&d(e,r,t,a):m&&(s=e instanceof Set,u=r instanceof Set,s||u)?s===u&&y(e,r,t,a):h(e,r,t,a)))}return e!=e&&r!=r}return r}var w=b(),S=b((function(){return n})),O=b(c()),C=b(c(n));e.circularDeepEqual=O,e.circularShallowEqual=C,e.createCustomEqual=b,e.deepEqual=w,e.sameValueZeroEqual=n,e.shallowEqual=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)})).createCustomEqual((e=>(t,r)=>Array.isArray(t)&&Array.isArray(r)?t.length===r.length&&t.every((t=>-1!==r.findIndex((r=>e(t,r))))):e(t,r))),Oe(wi({}),(e=>{e.addCase(ut,((e,t)=>Aa(e,t.payload)?void 0:t.payload))}));const Aa=(e,t)=>ja(e.context,t.context)&&Ma(e.advancedSearchQueries,t.advancedSearchQueries)&&Ra(e.facetSet,t.facetSet)&&Ra(e.dateFacetSet,t.dateFacetSet)&&Ra(e.numericFacetSet,t.numericFacetSet)&&ka(e.categoryFacetSet,t.categoryFacetSet)&&Pa(e.pagination,t.pagination)&&Ta(e.query,t.query)&&_a(e,t)&&Fa(e.pipeline,t.pipeline)&&Va(e.searchHub,t.searchHub)&&$a(e.facetOrder,t.facetOrder)&&Da(e.debug,t.debug),ja=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),Ra=(e,t)=>{for(const[r,n]of Object.entries(t)){if(!e[r])return!1;const t=e[r].currentValues.filter((e=>"selected"===e.state)),i=n.currentValues.filter((e=>"selected"===e.state));if(JSON.stringify(t)!==JSON.stringify(i))return!1}return!0},ka=(e,t)=>{var r;for(const[n,i]of Object.entries(t)){if(!e[n])return!1;const t=Bn(null===(r=e[n])||void 0===r?void 0:r.request.currentValues).parents.map((({value:e})=>e)),o=Bn(null==i?void 0:i.request.currentValues).parents.map((({value:e})=>e));if(JSON.stringify(t)!==JSON.stringify(o))return!1}return!0},Pa=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,Ta=(e,t)=>JSON.stringify(e)===JSON.stringify(t),Ma=(e,t)=>JSON.stringify(e)===JSON.stringify(t),_a=(e,t)=>e.sortCriteria===t.sortCriteria,Fa=(e,t)=>e===t,Va=(e,t)=>e===t,$a=(e,t)=>{return n=t,(r=e).length===n.length&&-1===r.findIndex(((e,t)=>n[t]!==e));var r,n},Da=(e,t)=>e===t,La=new Pe({required:!0,min:0}),Ua=Se("pagination/registerNumberOfResults",(e=>Be(e,La))),za=Se("pagination/updateNumberOfResults",(e=>Be(e,La))),Na=Se("pagination/registerPage",(e=>Be(e,La))),Ha=Se("pagination/updatePage",(e=>Be(e,La))),Qa=Se("pagination/nextPage"),Ya=Se("pagination/previousPage");function Ba(e){e.firstResult=0}function Wa(e){const{firstResult:t,numberOfResults:r}=e;return function(e,t){return e/t+1}(t,r)}function Ja(e,t){return(e-1)*t}Oe({firstResult:0,numberOfResults:10,totalCountFiltered:0},(e=>{e.addCase(Ua,((e,t)=>{const r=Wa(e),n=t.payload;e.numberOfResults=n,e.firstResult=Ja(r,n)})).addCase(za,((e,t)=>{e.numberOfResults=t.payload,e.firstResult=0})).addCase(Na,((e,t)=>{const r=t.payload;e.firstResult=Ja(r,e.numberOfResults)})).addCase(Ha,((e,t)=>{const r=t.payload;e.firstResult=Ja(r,e.numberOfResults)})).addCase(Ya,(e=>{const t=Wa(e),r=Math.max(t-1,1);e.firstResult=Ja(r,e.numberOfResults)})).addCase(Qa,(e=>{const t=Wa(e),r=function(e){const{totalCountFiltered:t,numberOfResults:r}=e;return function(e,t){const r=Math.min(e,1e3);return Math.ceil(r/t)}(t,r)}(e),n=Math.min(t+1,r);e.firstResult=Ja(n,e.numberOfResults)})).addCase(ct.fulfilled,((e,t)=>{t.payload&&(e.numberOfResults=t.payload.pagination.numberOfResults,e.firstResult=t.payload.pagination.firstResult)})).addCase(pt,((e,t)=>{var r,n;e.firstResult=null!==(r=t.payload.firstResult)&&void 0!==r?r:e.firstResult,e.numberOfResults=null!==(n=t.payload.numberOfResults)&&void 0!==n?n:e.numberOfResults})).addCase(qi.fulfilled,((e,t)=>{const{response:r}=t.payload;e.totalCountFiltered=r.totalCountFiltered})).addCase(xo,(e=>{Ba(e)})).addCase(Io,(e=>{Ba(e)})).addCase(zi,(e=>{Ba(e)})).addCase(Ui,(e=>{Ba(e)})).addCase(Ki,(e=>{Ba(e)})).addCase(Yo,(e=>{Ba(e)})).addCase(la,(e=>{Ba(e)})).addCase(Xi,(e=>{Ba(e)})).addCase(Bo,(e=>{Ba(e)})).addCase(da,(e=>{Ba(e)})).addCase(go,(e=>{Ba(e)}))}));const Ka=Se("pipeline/set",(e=>Be(e,new Ve({required:!0,emptyAllowed:!0})))),Za=Oe("default",(e=>{e.addCase(Ka,((e,t)=>t.payload)).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.pipeline)&&void 0!==n?n:e})).addCase(Ge,((e,t)=>t.payload.pipeline||e))})),Xa=["permanentid","ec_name","ec_brand","ec_category","ec_price","ec_promo_price","ec_shortdesc","ec_thumbnails","ec_images","ec_in_stock","ec_rating"];class Ga{constructor(e){this.state=e,this.initialState={id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0}}getLanguage(){return Yn(this.state)}getSearchEventRequestPayload(){return{queryText:"",responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getBaseMetadata(){var e;return{recommendation:(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.id)||this.initialState.id}}getSearchUID(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.searchUid)||this.initialState.searchUid}getPipeline(){return""}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2||"default"}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}mapResultsToAnalyticsDocument(){return[]}get responseTime(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.duration)||this.initialState.duration}get numberOfResults(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.recommendations.length)||this.initialState.recommendations.length}}const es=si("analytics/productrecommendations/load",ai.Search,(e=>e.logRecommendationInterfaceLoad()),(e=>new Ga(e))),ts=Se("productrecommendations/setId",(e=>Be(e,{id:Ne}))),rs=Se("productrecommendations/setSku",(e=>Be(e,{skus:new Ue({required:!0,min:1,each:new Ve({emptyAllowed:!1})})}))),ns=Se("productrecommendations/setBrand",(e=>Be(e,{brand:new Ve({required:!0,emptyAllowed:!0})}))),is=Se("productrecommendations/setCategory",(e=>Be(e,{category:new Ve({required:!0,emptyAllowed:!0})}))),os=Se("productrecommendations/setAdditionalFields",(e=>Be(e,{additionalFields:new Ue({required:!0,each:new Ve({emptyAllowed:!1})})}))),as=Se("productrecommendations/setMaxNumberOfRecommendations",(e=>Be(e,{number:new Pe({required:!0,max:50,min:1})}))),ss=Ie("productrecommendations/get",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const i=t(),o=(new Date).getTime(),a=await n.productRecommendations(cs(i)),s=(new Date).getTime()-o;if(wr(a))return r(a.error);const u=i.productRecommendations.additionalFields||[];return{recommendations:a.success.results.map((e=>us(e,{additionalFields:u}))),analyticsAction:es(),searchUid:a.success.searchUid,duration:s}})),us=(e,{additionalFields:t})=>{const r=e.raw.ec_price,n=e.raw.ec_promo_price,i=e.raw.ec_in_stock;return{permanentid:e.raw.permanentid,clickUri:e.clickUri,ec_name:e.raw.ec_name,ec_brand:e.raw.ec_brand,ec_category:e.raw.ec_category,ec_price:r,ec_shortdesc:e.raw.ec_shortdesc,ec_thumbnails:e.raw.ec_thumbnails,ec_images:e.raw.ec_images,ec_promo_price:void 0===n||void 0!==r&&n>=r?void 0:n,ec_in_stock:void 0===i?void 0:"yes"===i.toLowerCase()||"true"===i.toLowerCase(),ec_rating:e.raw.ec_rating,additionalFields:t.reduce(((t,r)=>({...t,[r]:e.raw[r]})),{})}},cs=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,...e.configuration.analytics.enabled&&{visitorId:ii()},recommendation:e.productRecommendations.id,numberOfResults:e.productRecommendations.maxNumberOfRecommendations,fieldsToInclude:[...Xa,...e.productRecommendations.additionalFields||[]],mlParameters:{...e.productRecommendations.skus&&e.productRecommendations.skus.length>0&&{itemIds:e.productRecommendations.skus},...e.productRecommendations.filter.brand&&{brandFilter:e.productRecommendations.filter.brand},...e.productRecommendations.filter.category&&{categoryFilter:e.productRecommendations.filter.category}},actionsHistory:e.configuration.analytics.enabled?oi.getHistory():[],...e.context&&{context:e.context.contextValues},...e.searchHub&&{searchHub:e.searchHub}});Oe({id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0},(e=>{e.addCase(ts,((e,t)=>{e.id=t.payload.id})).addCase(rs,((e,t)=>{e.skus=t.payload.skus})).addCase(ns,((e,t)=>{e.filter.brand=t.payload.brand})).addCase(is,((e,t)=>{e.filter.category=t.payload.category})).addCase(as,((e,t)=>{e.maxNumberOfRecommendations=t.payload.number})).addCase(os,((e,t)=>{e.additionalFields=t.payload.additionalFields})).addCase(ss.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(ss.fulfilled,((e,t)=>{e.error=null,e.searchUid=t.payload.searchUid,e.recommendations=t.payload.recommendations,e.isLoading=!1})).addCase(ss.pending,(e=>{e.isLoading=!0}))}));const ls={id:Ne,query:He},ds=Se("querySet/register",(e=>Be(e,ls))),fs=Se("querySet/update",(e=>Be(e,ls))),ps={id:Ne},hs=Se("querySuggest/register",(e=>Be(e,{...ps,q:new Ve,count:new Pe({min:0})}))),gs=Se("querySuggest/unregister",(e=>Be(e,ps))),ys=Se("querySuggest/selectSuggestion",(e=>Be(e,{...ps,expression:He}))),vs=Se("querySuggest/clear",(e=>Be(e,ps))),ms=Ie("querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n,validatePayload:i}})=>{i(e,ps);const o=e.id,a=await n.querySuggest(bs(o,t()));return wr(a)?r({id:o,...a.error}):{id:o,...a.success}})),bs=(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySuggest[e].q,locale:t.configuration.search.locale,actionsHistory:t.configuration.analytics.enabled?oi.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub}});Oe({},(e=>{e.addCase(ds,((e,t)=>{const{id:r,query:n}=t.payload;r in e||(e[r]=n)})).addCase(fs,((e,t)=>{const{id:r,query:n}=t.payload;ws(e,r,n)})).addCase(ys,((e,t)=>{const{id:r,expression:n}=t.payload;ws(e,r,n)})).addCase(qi.fulfilled,((e,t)=>{const{queryExecuted:r}=t.payload;Object.keys(e).forEach((t=>e[t]=r))})).addCase(ct.fulfilled,((e,t)=>{if(t.payload)for(const[r,n]of Object.entries(t.payload.querySet))ws(e,r,n)}))}));const ws=(e,t,r)=>{t in e&&(e[t]=r)};Oe({},(e=>e.addCase(hs,((e,t)=>{e[t.payload.id]={id:"",completions:[],count:5,q:"",currentRequestId:"",error:null,partialQueries:[],...t.payload}})).addCase(gs,((e,t)=>{delete e[t.payload.id]})).addCase(ms.pending,((e,t)=>{e[t.meta.arg.id].currentRequestId=t.meta.requestId})).addCase(ms.fulfilled,((e,t)=>{var r;const n=t.meta.arg.id;if(t.meta.requestId===(null===(r=e[n])||void 0===r?void 0:r.currentRequestId)){const{q:r}=e[n];r&&e[n].partialQueries.push(r.replace(/;/,encodeURIComponent(";"))),e[n].completions=t.payload.completions}})).addCase(ms.rejected,((e,t)=>{e[t.payload.id].error=t.payload})).addCase(fs,((e,t)=>{const{id:r,query:n}=t.payload;r in e&&(e[r].q=n)})).addCase(vs,((e,t)=>{const{id:r}=t.payload;e[r].q="",e[r].completions=[],e[r].partialQueries=[]})).addCase(ys,((e,t)=>{const{id:r,expression:n}=t.payload;e[r].q=n})))),Oe({q:"",enableQuerySyntax:!1},(e=>e.addCase(gi,((e,t)=>({...e,...t.payload}))).addCase(lr,((e,t)=>{e.q=t.payload})).addCase(ys,((e,t)=>{e.q=t.payload.expression})).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.query)&&void 0!==n?n:e})).addCase(pt,((e,t)=>{var r,n;e.q=null!==(r=t.payload.q)&&void 0!==r?r:e.q,e.enableQuerySyntax=null!==(n=t.payload.enableQuerySyntax)&&void 0!==n?n:e.enableQuerySyntax}))));const Ss=()=>new De({values:{documentId:new De({values:{contentIdKey:new Ve({required:!0,emptyAllowed:!1}),contentIdValue:new Ve({required:!0,emptyAllowed:!1})}})},options:{required:!0}}),Os=Se("smartSnippet/expand"),Cs=Se("smartSnippet/collapse"),qs=Se("smartSnippet/like"),Es=Se("smartSnippet/dislike"),Is=Se("smartSnippet/related/expand",(e=>Be(e,Ss()))),xs=Se("smartSnippet/related/collapse",(e=>Be(e,Ss()))),As=(e,t)=>e.findIndex((e=>e.contentIdValue===t.contentIdValue&&e.contentIdKey===t.contentIdKey));Oe({liked:!1,disliked:!1,expanded:!1,relatedQuestions:[]},(e=>e.addCase(Os,(e=>{e.expanded=!0})).addCase(Cs,(e=>{e.expanded=!1})).addCase(qs,(e=>{e.liked=!0,e.disliked=!1})).addCase(Es,(e=>{e.liked=!1,e.disliked=!0})).addCase(qi.fulfilled,((e,t)=>{e.relatedQuestions=t.payload.response.questionAnswer.relatedQuestions.map((e=>({contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1})))})).addCase(Is,((e,t)=>{const r=As(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!0)})).addCase(xs,((e,t)=>{const r=As(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!1)}))));const js=si("analytics/recommendation/update",ai.Search,(e=>e.logRecommendationInterfaceLoad())),Rs=e=>si("analytics/recommendation/open",ai.Click,((t,r)=>(pi(e),t.logRecommendationOpen(ui(e,r),(e=>({contentIDKey:"@permanentid",contentIDValue:e.raw.permanentid||""}))(e)))))(),ks=Se("recommendation/set",(e=>Be(e,{id:Ne}))),Ps=Ie("recommendation/get",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const i=t(),o=(new Date).getTime(),a=await n.recommendations(Ts(i)),s=(new Date).getTime()-o;return wr(a)?r(a.error):{recommendations:a.success.results,analyticsAction:js(),duration:s,searchUid:a.success.searchUid}})),Ts=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,recommendation:e.recommendation.id,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,actionsHistory:e.configuration.analytics.enabled?oi.getHistory():[],...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.context&&{context:e.context.contextValues},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude}}),Ms=Oe({duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[],searchUid:""},(e=>{e.addCase(ks,((e,t)=>{e.id=t.payload.id})).addCase(Ps.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(Ps.fulfilled,((e,t)=>{e.error=null,e.recommendations=t.payload.recommendations,e.duration=t.payload.duration,e.isLoading=!1,e.searchUid=t.payload.searchUid})).addCase(Ps.pending,(e=>{e.isLoading=!0}))}));function _s(e){return"notify"===e.type}function Fs(e){return"redirect"===e.type}function Vs(e){return"query"===e.type}function $s(e){return"execute"===e.type}class Ds{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){const e=this.response.preprocessingOutput.triggers.filter(Fs);return e.length?e[0].content:null}}const Ls=si("analytics/redirection",ai.Search,((e,t)=>{var r;if(null===(r=t.redirection)||void 0===r?void 0:r.redirectTo)return e.logTriggerRedirect({redirectedTo:t.redirection.redirectTo})})),Us=Ie("redirection/check",(async(e,{dispatch:t,getState:r,rejectWithValue:n,extra:{searchAPIClient:i,validatePayload:o}})=>{o(e,{defaultRedirectionUrl:new Ve({emptyAllowed:!1,url:!0})});const a=await i.plan(zs(r()));if(wr(a))return n(a.error);const s=new Ds(a.success).redirectionUrl;return s&&t(Ls()),s||e.defaultRedirectionUrl})),zs=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub}});Oe({redirectTo:null},(e=>e.addCase(Us.fulfilled,((e,t)=>{e.redirectTo=t.payload}))));const Ns=Ie("resultPreview/fetchResultContent",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{const i=function(e,t){var r;const{search:n,accessToken:i,organizationId:o}=e.configuration,a=(null===(r=e.query)||void 0===r?void 0:r.q)||"";return{url:n.apiBaseUrl,accessToken:i,organizationId:o,enableNavigation:!1,q:a,...t,requestedOutputSize:t.requestedOutputSize||0}}(r(),e),o=await t.searchAPIClient.html(i);return wr(o)?n(o.error):{content:o.success,uniqueId:e.uniqueId}}));Oe({uniqueId:"",content:"",isLoading:!1},(e=>{e.addCase(Ns.pending,(e=>{e.isLoading=!0})).addCase(Ns.fulfilled,((e,t)=>{const{content:r,uniqueId:n}=t.payload;e.content=r,e.uniqueId=n,e.isLoading=!1}))}));const Hs=Se("searchHub/set",(e=>Be(e,new Ve({required:!0,emptyAllowed:!0})))),Qs=Oe("default",(e=>{e.addCase(Hs,((e,t)=>t.payload)).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.searchHub)&&void 0!==n?n:e})).addCase(Ge,((e,t)=>t.payload.searchHub||e))}));function Ys(e,t){e.error=t.payload?t.payload:null,e.isLoading=!1}function Bs(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function Ws(e){e.isLoading=!0}Oe({response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]},(e=>{e.addCase(qi.rejected,Ys),e.addCase(Ei.rejected,Ys),e.addCase(qi.fulfilled,((e,t)=>{Bs(e,t),e.results=t.payload.response.results})),e.addCase(Ei.fulfilled,((e,t)=>{Bs(e,t),e.results=[...e.results,...t.payload.response.results]})),e.addCase(qi.pending,Ws),e.addCase(Ei.pending,Ws)}));const Js={by:new class{constructor(e){this.config=e,this.value=new je(e)}validate(e){const t=this.value.validate(e);return null!==t?t:Re(e)||Object.values(this.config.enum).find((t=>t===e))?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}}({enum:vi,required:!0})},Ks=Se("sortCriteria/register",(e=>Xs(e))),Zs=Se("sortCriteria/update",(e=>Xs(e))),Xs=e=>ze(e)?(e.forEach((e=>Be(e,Js))),{payload:e}):Be(e,Js);Oe(bi(),(e=>{e.addCase(Ks,((e,t)=>mi(t.payload))).addCase(Zs,((e,t)=>mi(t.payload))).addCase(ct.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.sortCriteria)&&void 0!==n?n:e})).addCase(pt,((e,t)=>{var r;return null!==(r=t.payload.sortCriteria)&&void 0!==r?r:e}))}));Oe({redirectTo:"",query:"",execute:{functionName:"",params:[]},notification:""},(e=>e.addCase(qi.fulfilled,((e,t)=>{const r=t.payload.response.triggers.filter(Fs);e.redirectTo=r.length?r[0].content:"";const n=t.payload.response.triggers.filter(Vs);e.query=n.length?n[0].content:"";const i=t.payload.response.triggers.filter($s);e.execute=i.length?{functionName:i[0].content.name,params:i[0].content.params}:{functionName:"",params:[]};const o=t.payload.response.triggers.filter(_s);e.notification=o.length?o[0].content:""}))));const Gs=Zt,eu=ht,tu=nr,ru=wa,nu=Za,iu=Qs,ou=ar,au=Ms;function su(e,t){let r=0;const n=function(e,t,r){var n,i,o;void 0===t&&(t=50),void 0===r&&(r={});var a=null!=(n=r.isImmediate)&&n,s=null!=(i=r.callback)&&i,u=r.maxWait,c=Date.now(),l=[];function d(){if(void 0!==u){var e=Date.now()-c;if(e+t>=u)return u-e}return t}var f=function(){var t=[].slice.call(arguments),r=this;return new Promise((function(n,i){var u=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,c=Date.now(),!a){var n=e.apply(r,t);s&&s(n),l.forEach((function(e){return(0,e.resolve)(n)})),l=[]}}),d()),u){var f=e.apply(r,t);return s&&s(f),n(f)}l.push({resolve:n,reject:i})}))};return f.cancel=function(e){void 0!==o&&clearTimeout(o),l.forEach((function(t){return(0,t.reject)(e)})),l=[]},f}((()=>r=0),500);return i=>o=>async a=>{if(!("function"==typeof a))return o(a);const s=await o(a);if(!function(e){var t;return(null===(t=e.error)||void 0===t?void 0:t.name)===(new Qt).name}(s))return s;if("function"!=typeof t)return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),s;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),s;r++,n();const u=await async function(e){try{return await e()}catch(e){return""}}(t);i.dispatch(Xe({accessToken:u})),i.dispatch(a)}}const uu=e=>t=>r=>{var n,i;const o=null===(n=r.payload)||void 0===n?void 0:n.analyticsAction;void 0!==o&&(null===(i=r.payload)||void 0===i||delete i.analyticsAction);const a=t(r);return r.type===qi.fulfilled.type&&void 0===o&&console.error("No analytics action associated with search:",r),r.type===Ps.fulfilled&&void 0===o&&console.error("No analytics action associated with recommendation:",r),r.type===ss.fulfilled&&void 0===o&&console.error("No analytics action associated with product recommendation:",r),void 0!==o&&e.dispatch(o),a},cu={configuration:Gs,version:sr};function lu(e,t){const r=function(e,t){const{reducers:r}=e,n=function(e){const t={...e};return{get combinedReducer(){return te(t)},add(e){Object.keys(e).filter((e=>!(e in t))).forEach((r=>t[r]=e[r]))}}}({...cu,...r}),i=t.logger,o=function(e,t,r){const{preloadedState:n,configuration:i}=e,o=i.name||"coveo-headless",a=function(e,t){const{renewAccessToken:r}=e.configuration;return[su(t,r),ot(t),uu].concat(e.middlewares||[])}(e,t.logger);return function({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:i}){return we({reducer:e,preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e,name:i},middleware:e=>{return[...r,...e({thunk:{extraArgument:n}}),(t=n.logger,e=>r=>n=>(t.debug({action:n,nextState:e.getState()},"Action dispatched: "+n.type),r(n)))];var t}})}({preloadedState:n,reducer:r.combinedReducer,middlewares:a,thunkExtraArguments:t,name:o})}(e,t,n);return{addReducers(e){n.add(e),o.replaceReducer(n.combinedReducer)},dispatch:o.dispatch,subscribe:o.subscribe,enableAnalytics(){o.dispatch(rt())},disableAnalytics(){o.dispatch(tt())},get state(){return o.getState()},logger:i,store:o}}(e,t),{accessToken:n,organizationId:i,platformUrl:o,analytics:a}=e.configuration;if(r.dispatch(Xe({accessToken:n,organizationId:i,platformUrl:o})),a){const{analyticsClientMiddleware:e,...t}=a;r.dispatch(et(t))}return r}const du={organizationId:Ne,accessToken:Ne,platformUrl:new Ve({required:!1,emptyAllowed:!1}),name:new Ve({required:!1,emptyAllowed:!1}),analytics:new De({options:{required:!1},values:{enabled:new Me({required:!1}),originLevel2:new Ve({required:!1}),originLevel3:new Ve({required:!1})}})};const fu=new Ae({...du,pipeline:new Ve({required:!1,emptyAllowed:!1}),searchHub:new Ve({required:!1,emptyAllowed:!1})});function pu(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",pipeline:"default",searchHub:"default"}}function hu(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}var gu=function(e,t,r){var n=r&&r.stringify||hu;if("object"==typeof e&&null!==e){var i=t.length+1;if(1===i)return e;var o=new Array(i);o[0]=n(e);for(var a=1;a<i;a++)o[a]=n(t[a]);return o.join(" ")}if("string"!=typeof e)return e;var s=t.length;if(0===s)return e;for(var u="",c=0,l=-1,d=e&&e.length||0,f=0;f<d;){if(37===e.charCodeAt(f)&&f+1<d){switch(l=l>-1?l:0,e.charCodeAt(f+1)){case 100:case 102:if(c>=s)break;if(l<f&&(u+=e.slice(l,f)),null==t[c])break;u+=Number(t[c]),l=f+=2;break;case 105:if(c>=s)break;if(l<f&&(u+=e.slice(l,f)),null==t[c])break;u+=Math.floor(Number(t[c])),l=f+=2;break;case 79:case 111:case 106:if(c>=s)break;if(l<f&&(u+=e.slice(l,f)),void 0===t[c])break;var p=typeof t[c];if("string"===p){u+="'"+t[c]+"'",l=f+2,f++;break}if("function"===p){u+=t[c].name||"<anonymous>",l=f+2,f++;break}u+=n(t[c]),l=f+2,f++;break;case 115:if(c>=s)break;l<f&&(u+=e.slice(l,f)),u+=String(t[c]),l=f+2,f++;break;case 37:l<f&&(u+=e.slice(l,f)),u+="%",l=f+2,f++,c--}++c}++f}if(-1===l)return e;l<d&&(u+=e.slice(l));return u};var yu=bu;const vu=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},mu={mapHttpRequest:xu,mapHttpResponse:xu,wrapRequestSerializer:Au,wrapResponseSerializer:Au,wrapErrorSerializer:Au,req:xu,res:xu,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}};function bu(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");const r=e.browser.write||vu;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=function(e,t){if(Array.isArray(e))return e.filter((function(e){return"!stdSerializers.err"!==e}));return!0===e&&Object.keys(t)}(e.browser.serialize,n);let o=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);"function"==typeof r&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),!1===e.enabled&&(e.level="silent");const a=e.level||"info",s=Object.create(r);s.log||(s.log=ju),Object.defineProperty(s,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(s,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,wu(u,s,"error","log"),wu(u,s,"fatal","error"),wu(u,s,"warn","error"),wu(u,s,"info","log"),wu(u,s,"debug","log"),wu(u,s,"trace","log")}});const u={transmit:t,serialize:i,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:Iu(e)};return s.levels=bu.levels,s.level=a,s.setMaxListeners=s.getMaxListeners=s.emit=s.addListener=s.on=s.prependListener=s.once=s.prependOnceListener=s.removeListener=s.removeAllListeners=s.listeners=s.listenerCount=s.eventNames=s.write=s.flush=ju,s.serializers=n,s._serialize=i,s._stdErrSerialize=o,s.child=function(r){if(!r)throw new Error("missing bindings for child Pino");const o=r.serializers;if(i&&o){var a=Object.assign({},n,o),s=!0===e.browser.serialize?Object.keys(a):i;delete r.serializers,Ou([r],s,a,this._stdErrSerialize)}function u(e){this._childLevel=1+(0|e._childLevel),this.error=Cu(e,r,"error"),this.fatal=Cu(e,r,"fatal"),this.warn=Cu(e,r,"warn"),this.info=Cu(e,r,"info"),this.debug=Cu(e,r,"debug"),this.trace=Cu(e,r,"trace"),a&&(this.serializers=a,this._serialize=s),t&&(this._logEvent=Eu([].concat(e._logEvent.bindings,r)))}return u.prototype=this,new u(this)},t&&(s._logEvent=Eu()),s}function wu(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?ju:i[r]?i[r]:vu[r]||vu[n]||ju,function(e,t,r){if(!e.transmit&&t[r]===ju)return;t[r]=(n=t[r],function(){const i=e.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===vu?vu:this;for(var s=0;s<o.length;s++)o[s]=arguments[s];if(e.serialize&&!e.asObject&&Ou(o,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(a,Su(this,r,o,i)):n.apply(a,o),e.transmit){const n=e.transmit.level||t.level,a=bu.levels.values[n],s=bu.levels.values[r];if(s<a)return;qu(this,{ts:i,methodLevel:r,methodValue:s,transmitLevel:n,transmitValue:bu.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},o)}});var n}(e,t,r)}function Su(e,t,r,n){e._serialize&&Ou(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let o=i[0];const a={};n&&(a.time=n),a.level=bu.levels.values[t];let s=1+(0|e._childLevel);if(s<1&&(s=1),null!==o&&"object"==typeof o){for(;s--&&"object"==typeof i[0];)Object.assign(a,i.shift());o=i.length?gu(i.shift(),i):void 0}else"string"==typeof o&&(o=gu(i.shift(),i));return void 0!==o&&(a.msg=o),a}function Ou(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=bu.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(const n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function Cu(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function qu(e,t,r){const n=t.send,i=t.ts,o=t.methodLevel,a=t.methodValue,s=t.val,u=e._logEvent.bindings;Ou(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return-1===u.indexOf(e)})),e._logEvent.level.label=o,e._logEvent.level.value=a,n(o,e._logEvent,s),e._logEvent=Eu(u)}function Eu(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Iu(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?Ru:ku}function xu(){return{}}function Au(e){return e}function ju(){}function Ru(){return!1}function ku(){return Date.now()}bu.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},bu.stdSerializers=mu,bu.stdTimeFunctions=Object.assign({},{nullTime:Ru,epochTime:ku,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}});const Pu=e=>e;function Tu(e,t){return{analyticsClientMiddleware:function(e){const{analytics:t}=e,r=(e,t)=>t;return(null==t?void 0:t.analyticsClientMiddleware)||r}(e),validatePayload:Ye,preprocessRequest:function(e){return e.preprocessRequest||Pu}(e),logger:t}}const Mu=e=>e,_u=e=>e,Fu=e=>e,Vu={debug:ou,pipeline:nu,searchHub:iu,recommendation:au};function $u(e){const t=function(e){return yu({name:"@coveo/headless",level:(null==e?void 0:e.level)||"warn",formatters:{log:null==e?void 0:e.logFormatter},browser:{transmit:{send:(null==e?void 0:e.browserPostLogHook)||(()=>{})}}})}(e.loggerOptions);!function(e,t){try{fu.validate(e)}catch(e){throw t.error(e,"Recommendation engine configuration error"),e}}(e.configuration,t);const r=function(e,t){return new gr({logger:t,preprocessRequest:e.preprocessRequest||Pu,postprocessSearchResponseMiddleware:Mu,postprocessFacetSearchResponseMiddleware:_u,postprocessQuerySuggestResponseMiddleware:Fu})}(e.configuration,t),n={...Tu(e.configuration,t),searchAPIClient:r},i=lu({...e,reducers:Vu},n),{pipeline:o,searchHub:a}=e.configuration;return ke(o)||i.dispatch(Ka(o)),ke(a)||i.dispatch(Hs(a)),{...i,get state(){return i.state}}}function Du(e){return e.addReducers({configuration:Gs}),{disableAnalytics:tt,enableAnalytics:rt,setOriginLevel2:nt,setOriginLevel3:it,updateAnalyticsConfiguration:et,updateBasicConfiguration:Xe}}function Lu(e){return e.addReducers({advancedSearchQueries:eu}),{updateAdvancedSearchQueries:lt,registerAdvancedSearchQueries:dt}}function Uu(e){return e.addReducers({context:tu}),{addContext:tr,removeContext:rr,setContext:er}}function zu(e){return e.addReducers({fields:ru}),{registerFieldsToInclude:ya}}function Nu(e){return e.addReducers({pipeline:nu}),{setPipeline:Ka}}function Hu(e){return e.addReducers({searchHub:iu}),{setSearchHub:Hs}}function Qu(e){return e.addReducers({debug:ou}),{disableDebug:or,enableDebug:ir}}function Yu(e){return e.addReducers({recommendation:au}),{getRecommendations:Ps,setRecommendationId:ks}}function Bu(e){return e.addReducers({}),{logRecommendationOpen:Rs}}function Wu(e){let t;return{subscribe(r){return r(),t=JSON.stringify(this.state),e.subscribe((()=>{(e=>{try{const r=JSON.stringify(e),n=t!==r;return t=r,n}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}})(this.state)&&r()}))},get state(){return{}}}}const Ju=new Ae({id:new Ve({emptyAllowed:!0,required:!1,default:""})});function Ku(e,t={}){!function(e){e.addReducers({recommendation:au,configuration:Gs})}(e);const r=Wu(e),{dispatch:n}=e,i=((e,t,r,n)=>We(e,t,r,"Check the options of "+n,"Controller initialization error"))(e,Ju,t.options,"buildRecommendationList");return""!==i.id&&n(ks({id:i.id})),{...r,refresh(){n(Ps())},get state(){const t=e.state;return{recommendations:t.recommendation.recommendations,error:t.recommendation.error,isLoading:t.recommendation.isLoading}}}}function Zu(e){!function(e){e.addReducers({context:tu})}(e);const t=Wu(e),{dispatch:r}=e;return{...t,get state(){return{values:e.state.context.contextValues}},set(e){r(er(e))},add(e,t){r(tr({contextKey:e,contextValue:t}))},remove(e){r(rr(e))}}}export{Zu as buildContext,Wu as buildController,$u as buildRecommendationEngine,Ku as buildRecommendationList,pu as getSampleRecommendationEngineConfiguration,Lu as loadAdvancedSearchQueryActions,Bu as loadClickAnalyticsActions,Du as loadConfigurationActions,Uu as loadContextActions,Qu as loadDebugActions,zu as loadFieldActions,Nu as loadPipelineActions,Yu as loadRecommendationActions,Hu as loadSearchHubActions};
//# sourceMappingURL=headless.esm.js.map
