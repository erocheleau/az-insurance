const e=e=>e;var t=fetch,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){var t={exports:{}};return e(t,t.exports),t.exports}var i=r&&r.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};var a=function(e){var t=i(i({},o),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t},s=Object.defineProperty({getSanitizedOptions:a},"__esModule",{value:!0});var u=function(e){var t=Math.random()*e;return Math.round(t)},c=Object.defineProperty({fullJitter:u},"__esModule",{value:!0});var l=function(e){return e},d=Object.defineProperty({noJitter:l},"__esModule",{value:!0});var f,p=function(e){switch(e.jitter){case"full":return c.fullJitter;case"none":default:return d.noJitter}},h=Object.defineProperty({JitterFactory:p},"__esModule",{value:!0}),g=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return h.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}(),y=Object.defineProperty({Delay:g},"__esModule",{value:!0}),m=r&&r.__extends||(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),v=r&&r.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},b=r&&r.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.prototype.apply=function(){return v(this,void 0,void 0,(function(){return b(this,(function(t){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(y.Delay),S=Object.defineProperty({SkipFirstDelay:w},"__esModule",{value:!0}),O=r&&r.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t}(y.Delay),q=Object.defineProperty({AlwaysDelay:C},"__esModule",{value:!0});var E=function(e,t){var r=function(e){if(!e.delayFirstAttempt)return new S.SkipFirstDelay(e);return new q.AlwaysDelay(e)}(e);return r.setAttemptNumber(t),r};var x=Object.defineProperty({DelayFactory:E},"__esModule",{value:!0}),I=r&&r.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},A=r&&r.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};var R=function(e,t){return void 0===t&&(t={}),I(this,void 0,void 0,(function(){var r;return A(this,(function(n){switch(n.label){case 0:return r=s.getSanitizedOptions(t),[4,new j(e,r).execute()];case 1:return[2,n.sent()]}}))}))},j=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return I(this,void 0,void 0,(function(){var e;return A(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return I(this,void 0,void 0,(function(){return A(this,(function(e){switch(e.label){case 0:return[4,x.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}();class k extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}}class P extends Error{constructor(){super(),this.name="Disconnected",this.message="Client is not connected to the internet."}}function T(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function F(e){return 429===e}class _{static async call(e){const r=function(e){const{url:t,method:r,requestParams:n,contentType:i,accessToken:o,signal:a}=e,s=function(e,t){if("application/x-www-form-urlencoded"===t)return"object"==typeof(r=e)&&r&&Object.values(r).every(T)?function(e){const t=[];for(const r in e){const n=encodeURIComponent(r),i=encodeURIComponent(e[r]);t.push(`${n}=${i}`)}return t.join("&")}(e):"";var r;return JSON.stringify(e)}(n,i);return{url:t,method:r,headers:{"Content-Type":i,Authorization:"Bearer "+o,...e.headers},body:s,signal:a}}(e),{preprocessRequest:n,logger:i}=e,o={...r,...n?await n(r,"searchApiFetch"):{}};i.info(o,"Platform request");const{url:a,...s}=o,u=async()=>{const e=await t(a,s);if(F(e.status))throw e;return e};try{const e=await R(u,{retry:e=>{const t=e&&F(e.status);return t&&i.info("Platform retrying request"),t}});if(419===e.status)throw i.info("Platform renewing token"),new k;return i.info({response:e,requestInfo:o},"Platform response"),e}catch(e){return"Failed to fetch"===e.message?new P:e}}}function M(e){return`https://platform${e&&e.environment&&"prod"!==e.environment?e.environment:""}${e&&e.region&&"us-east-1"!==e.region?"-"+e.region:""}.cloud.coveo.com`}function V(e){if(e instanceof P)return{error:{statusCode:0,type:"Disconnected",message:"Could not connect"}};throw e}const $=(e,t,r,n)=>({accessToken:e.accessToken,method:t,contentType:r,url:`${e.url}${n}?${D(e)}`}),D=e=>"organizationId="+e.organizationId;const L=TextDecoder;class N extends Error{constructor(e){super(e),this.name="SchemaValidationError"}}class U{constructor(e){this.definition=e}validate(e={},t=""){const r={...this.default,...e},n=[];for(const e in this.definition){const t=this.definition[e].validate(r[e]);t&&n.push(`${e}: ${t}`)}if(n.length)throw function(e,t){const r=`\n  The following properties are invalid:\n\n    ${e.join("\n\t")}\n  \n  ${t}\n  `;return new N(r)}(n,t);return r}get default(){const e={};for(const t in this.definition){const r=this.definition[t].default;void 0!==r&&(e[t]=r)}return e}}class z{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&Q(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return!0===this.baseConfig.required}}function H(e){return void 0===e}function Q(e){return H(e)||function(e){return null===e}(e)}class B{constructor(e={}){this.config=e,this.value=new z(e)}validate(e){return this.value.validate(e)||(function(e){return H(e)||Y(e)}(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}}function Y(e){return"number"==typeof e&&!isNaN(e)}class W{constructor(e={}){this.value=new z(e)}validate(e){return this.value.validate(e)||(function(e){return H(e)||J(e)}(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}}function J(e){return"boolean"==typeof e}const K=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i;class Z{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new z(this.config)}validate(e){const{emptyAllowed:t,url:r,regex:n,constrainTo:i}=this.config,o=this.value.validate(e);return o||(H(e)?null:X(e)?t||e.length?r&&!K.test(e)?"value is not a valid URL.":n&&!n.test(e)?"value did not match provided regex "+n:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is an empty string.":"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}}function X(e){return"[object String]"===Object.prototype.toString.call(e)}class G{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(H(e))return this.config.options.required?"value is required and is currently undefined":null;if(!ee(e))return"value is not an object";for(const[t,r]of Object.entries(this.config.values))if(r.required&&Q(e[t]))return"value does not contain "+t;let t="";for(const[r,n]of Object.entries(this.config.values)){const i=e[r],o=n.validate(i);null!==o&&(t+=" "+o)}return""===t?null:t}get default(){}get required(){return!!this.config.options.required}}function ee(e){return void 0!==e&&"object"==typeof e}class te{constructor(e={}){this.config=e,this.value=new z(this.config)}validate(e){if(!Q(e)&&!Array.isArray(e))return"value is not an array";const t=this.value.validate(e);if(null!==t)return t;if(Q(e))return null;if(void 0!==this.config.max&&e.length>this.config.max)return"value contains more than "+this.config.max;if(void 0!==this.config.min&&e.length<this.config.min)return"value contains less than "+this.config.min;if(void 0!==this.config.each){let t="";return e.forEach((r=>{this.config.each.required&&Q(r)&&(t="value is null or undefined: "+e.join(","));const n=this.validatePrimitiveValue(r,this.config.each);null!==n&&(t+=" "+n)})),""===t?null:t}return null}validatePrimitiveValue(e,t){return J(e)||X(e)||Y(e)||ee(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}}function re(e){return Array.isArray(e)}class ne{constructor(e){this.options=e,this.searchAbortController=null}async plan(e){const t=await _.call({...$(e,"POST","application/json","/plan"),requestParams:le(e),...this.options});if(t instanceof Error)return V(t);const r=await t.json();return function(e){return void 0!==e.preprocessingOutput}(r)?{success:r}:{error:ie({response:t,body:r})}}async querySuggest(e){const t=await _.call({...$(e,"POST","application/json","/querySuggest"),requestParams:le(e),...this.options});if(t instanceof Error)return V(t);const r=await t.json(),n={response:t,body:r};if(function(e){return void 0!==e.completions}(r)){return{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}}return{error:ie(n)}}async search(e){var t;this.searchAbortController&&(this.options.logger.warn("Cancelling current pending search query"),this.searchAbortController.abort()),this.searchAbortController=this.getAbortControllerInstanceIfAvailable();const r=await _.call({...$(e,"POST","application/json",""),requestParams:le(e),...this.options,signal:null===(t=this.searchAbortController)||void 0===t?void 0:t.signal});if(r instanceof Error)return V(r);this.searchAbortController=null;const n=await r.json(),i={response:r,body:n};if(ce(n)){i.body=function(e){const t={answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0};if(Q(e.questionAnswer))return e.questionAnswer=t,e;return e.questionAnswer={...t,...e.questionAnswer},e}(n);return{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}}return{error:ie(i)}}async facetSearch(e){const t=await _.call({...$(e,"POST","application/json","/facet"),requestParams:le(e),...this.options});if(t instanceof Error)throw t;const r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){const t=await _.call({...$(e,"POST","application/json",""),requestParams:le(e),...this.options});if(t instanceof Error)throw t;const r=await t.json();return ce(r)?{success:r}:{error:ie({response:t,body:r})}}async html(e){const t=await _.call({...$(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:le(e),...this.options});if(t instanceof Error)throw t;const r=function(e){return((e.headers.get("content-type")||"").split(";").find((e=>-1!==e.indexOf("charset=")))||"").split("=")[1]||"UTF-8"}(t),n=await t.arrayBuffer(),i=new L(r).decode(n);return function(e){return"string"==typeof e}(i)?{success:i}:{error:ie({response:t,body:i})}}async productRecommendations(e){const t=await _.call({...$(e,"POST","application/json",""),requestParams:le(e),...this.options});if(t instanceof Error)throw t;const r=await t.json();return ce(r)?{success:r}:{error:ie({response:t,body:r})}}getAbortControllerInstanceIfAvailable(){if("undefined"==typeof window){return new(require("node-abort-controller"))}return"undefined"==typeof AbortController?null:new AbortController}}const ie=e=>{const{response:t}=e;return t.body?oe(e):ae(t)},oe=e=>function(e){return void 0!==e.body.exception}(e)?se(e):function(e){return void 0!==e.body.statusCode}(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},ae=e=>{const t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:"Client side error: "+(t.message||""),statusCode:400,type:"ClientError"}},se=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),ue=e=>void 0!==e.error;function ce(e){return void 0!==e.results}function le(e){const{url:t,accessToken:r,organizationId:n,...i}=e;return i}const de=e=>e,fe=e=>e,pe=e=>e;function he(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ge(e){return!!e&&!!e[tt]}function ye(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[et]||!!e.constructor[et]||Oe(e)||Ce(e))}function me(e,t,r){void 0===r&&(r=!1),0===ve(e)?(r?Object.keys:rt)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function ve(e){var t=e[tt];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Oe(e)?2:Ce(e)?3:0}function be(e,t){return 2===ve(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function we(e,t,r){var n=ve(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function Se(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Oe(e){return Ke&&e instanceof Map}function Ce(e){return Ze&&e instanceof Set}function qe(e){return e.o||e.t}function Ee(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=nt(e);delete t[tt];for(var r=rt(t),n=0;n<r.length;n++){var i=r[n],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function xe(e,t){return void 0===t&&(t=!1),Ae(e)||ge(e)||!ye(e)||(ve(e)>1&&(e.set=e.add=e.clear=e.delete=Ie),Object.freeze(e),t&&me(e,(function(e,t){return xe(t,!0)}),!0)),e}function Ie(){he(2)}function Ae(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Re(e){var t=it[e];return t||he(18,e),t}function je(){return We}function ke(e,t){t&&(Re("Patches"),e.u=[],e.s=[],e.v=t)}function Pe(e){Te(e),e.p.forEach(_e),e.p=null}function Te(e){e===We&&(We=e.l)}function Fe(e){return We={p:[],l:We,h:e,m:!0,_:0}}function _e(e){var t=e[tt];0===t.i||1===t.i?t.j():t.g=!0}function Me(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.O||Re("ES5").S(t,e,n),n?(r[tt].P&&(Pe(t),he(4)),ye(e)&&(e=Ve(t,e),t.l||De(t,e)),t.u&&Re("Patches").M(r[tt],e,t.u,t.s)):e=Ve(t,r,[]),Pe(t),t.u&&t.v(t.u,t.s),e!==Ge?e:void 0}function Ve(e,t,r){if(Ae(t))return t;var n=t[tt];if(!n)return me(t,(function(i,o){return $e(e,n,t,i,o,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return De(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=Ee(n.k):n.o;me(3===n.i?new Set(i):i,(function(t,o){return $e(e,n,i,t,o,r)})),De(e,i,!1),r&&e.u&&Re("Patches").R(n,r,e.u,e.s)}return n.o}function $e(e,t,r,n,i,o){if(ge(i)){var a=Ve(e,i,o&&t&&3!==t.i&&!be(t.D,n)?o.concat(n):void 0);if(we(r,n,a),!ge(a))return;e.m=!1}if(ye(i)&&!Ae(i)){if(!e.h.N&&e._<1)return;Ve(e,i),t&&t.A.l||De(e,i)}}function De(e,t,r){void 0===r&&(r=!1),e.h.N&&e.m&&xe(t,r)}function Le(e,t){var r=e[tt];return(r?qe(r):e)[t]}function Ne(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function Ue(e){e.P||(e.P=!0,e.l&&Ue(e.l))}function ze(e){e.o||(e.o=Ee(e.t))}function He(e,t,r){var n=Oe(t)?Re("MapSet").T(t,r):Ce(t)?Re("MapSet").F(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:je(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,o=ot;r&&(i=[n],o=at);var a=Proxy.revocable(i,o),s=a.revoke,u=a.proxy;return n.k=u,n.j=s,u}(t,r):Re("ES5").J(t,r);return(r?r.A:je()).p.push(n),n}function Qe(e){return ge(e)||he(22,e),function e(t){if(!ye(t))return t;var r,n=t[tt],i=ve(t);if(n){if(!n.P&&(n.i<4||!Re("ES5").K(n)))return n.t;n.I=!0,r=Be(t,i),n.I=!1}else r=Be(t,i);return me(r,(function(t,i){n&&function(e,t){return 2===ve(e)?e.get(t):e[t]}(n.t,t)===i||we(r,t,e(i))})),3===i?new Set(r):r}(e)}function Be(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Ee(e)}var Ye,We,Je="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Ke="undefined"!=typeof Map,Ze="undefined"!=typeof Set,Xe="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Ge=Je?Symbol.for("immer-nothing"):((Ye={})["immer-nothing"]=!0,Ye),et=Je?Symbol.for("immer-draftable"):"__$immer_draftable",tt=Je?Symbol.for("immer-state"):"__$immer_state",rt="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,nt=Object.getOwnPropertyDescriptors||function(e){var t={};return rt(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},it={},ot={get:function(e,t){if(t===tt)return e;var r=qe(e);if(!be(r,t))return function(e,t,r){var n,i=Ne(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.k):void 0}(e,r,t);var n=r[t];return e.I||!ye(n)?n:n===Le(e.t,t)?(ze(e),e.o[t]=He(e.A.h,n,e)):n},has:function(e,t){return t in qe(e)},ownKeys:function(e){return Reflect.ownKeys(qe(e))},set:function(e,t,r){var n=Ne(qe(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=Le(qe(e),t),o=null==i?void 0:i[tt];if(o&&o.t===r)return e.o[t]=r,e.D[t]=!1,!0;if(Se(r,i)&&(void 0!==r||be(e.t,t)))return!0;ze(e),Ue(e)}return e.o[t]=r,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==Le(e.t,t)||t in e.t?(e.D[t]=!1,ze(e),Ue(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=qe(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){he(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){he(12)}},at={};me(ot,(function(e,t){at[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),at.deleteProperty=function(e,t){return ot.deleteProperty.call(this,e[0],t)},at.set=function(e,t,r){return ot.set.call(this,e[0],t,r,e[0])};var st=new(function(){function e(e){this.O=Xe,this.N=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,r){if("function"==typeof e&&"function"!=typeof t){var n=t;t=e;var i=this;return function(e){var r=this;void 0===e&&(e=n);for(var o=arguments.length,a=Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];return i.produce(e,(function(e){var n;return(n=t).call.apply(n,[r,e].concat(a))}))}}var o;if("function"!=typeof t&&he(6),void 0!==r&&"function"!=typeof r&&he(7),ye(e)){var a=Fe(this),s=He(this,e,void 0),u=!0;try{o=t(s),u=!1}finally{u?Pe(a):Te(a)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return ke(a,r),Me(e,a)}),(function(e){throw Pe(a),e})):(ke(a,r),Me(o,a))}if(!e||"object"!=typeof e){if((o=t(e))===Ge)return;return void 0===o&&(o=e),this.N&&xe(o,!0),o}he(21,e)},t.produceWithPatches=function(e,t){var r,n,i=this;return"function"==typeof e?function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return i.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(n))}))}:[this.produce(e,t,(function(e,t){r=e,n=t})),r,n]},t.createDraft=function(e){ye(e)||he(8),ge(e)&&(e=Qe(e));var t=Fe(this),r=He(this,e,void 0);return r[tt].C=!0,Te(t),r},t.finishDraft=function(e,t){var r=(e&&e[tt]).A;return ke(r,t),Me(void 0,r)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!Xe&&he(20),this.O=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}var i=Re("Patches").$;return ge(e)?i(e,t):this.produce(e,(function(e){return i(e,t.slice(r+1))}))},e}()),ut=st.produce;st.produceWithPatches.bind(st),st.setAutoFreeze.bind(st),st.setUseProxies.bind(st),st.applyPatches.bind(st),st.createDraft.bind(st),st.finishDraft.bind(st);var ct=function(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),lt=function(){return Math.random().toString(36).substring(7).split("").join(".")},dt={INIT:"@@redux/INIT"+lt(),REPLACE:"@@redux/REPLACE"+lt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+lt()}};function ft(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function pt(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(pt)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,o=t,a=[],s=a,u=!1;function c(){s===a&&(s=a.slice())}function l(){if(u)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function d(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(u)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return c(),s.push(e),function(){if(t){if(u)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,c();var r=s.indexOf(e);s.splice(r,1),a=null}}}function f(e){if(!ft(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,o=i(o,e)}finally{u=!1}for(var t=a=s,r=0;r<t.length;r++){(0,t[r])()}return e}function p(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,f({type:dt.REPLACE})}function h(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(l())}return r(),{unsubscribe:t(r)}}})[ct]=function(){return this},e}return f({type:dt.INIT}),(n={dispatch:f,subscribe:d,getState:l,replaceReducer:p})[ct]=h,n}function ht(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function gt(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];"function"==typeof e[i]&&(r[i]=e[i])}var o,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:dt.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:dt.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+dt.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var n=!1,i={},s=0;s<a.length;s++){var u=a[s],c=r[u],l=e[u],d=c(l,t);if(void 0===d){var f=ht(u,t);throw new Error(f)}i[u]=d,n=n||d!==l}return(n=n||a.length!==Object.keys(e).length)?i:e}}function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mt(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(r,!0).forEach((function(t){yt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function wt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},o=t.map((function(e){return e(i)}));return vt({},r,{dispatch:n=bt.apply(void 0,o)(r.dispatch)})}}}function St(e,t){return e===t}function Ot(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,i=0;i<n;i++)if(!e(t[i],r[i]))return!1;return!0}function Ct(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(i){return"function"==typeof i?i(r,n,e):t(i)}}}}!function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n]}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:St,r=null,n=null;return function(){return Ot(t,r,arguments)||(n=e.apply(null,arguments)),r=arguments,n}}));var qt=Ct();function Et(){return(Et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function xt(e){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function It(e,t){return(It=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function At(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Rt(e,t,r){return(Rt=At()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&It(i,r.prototype),i}).apply(null,arguments)}function jt(e){var t="function"==typeof Map?new Map:void 0;return(jt=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Rt(e,arguments,xt(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),It(n,e)})(e)}qt.withExtraArgument=Ct;var kt="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?bt:bt.apply(null,arguments)};var Pt=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=n.prototype;return i.concat=function(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,(t=e.prototype.concat).call.apply(t,[this].concat(i)))},i.prepend=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 1===t.length&&Array.isArray(t[0])?Rt(n,t[0].concat(this)):Rt(n,t.concat(this))},n}(jt(Array));function Tt(){return function(e){return function(e){void 0===e&&(e={});var t=e,r=t.thunk,n=void 0===r||r;t.immutableCheck,t.serializableCheck;var i=new Pt;n&&(!function(e){return"boolean"==typeof e}(n)?i.push(qt.withExtraArgument(n.extraArgument)):i.push(qt));return i}(e)}}function Ft(e){var t,r=Tt(),n=e||{},i=n.reducer,o=void 0===i?void 0:i,a=n.middleware,s=void 0===a?r():a,u=n.devTools,c=void 0===u||u,l=n.preloadedState,d=void 0===l?void 0:l,f=n.enhancers,p=void 0===f?void 0:f;if("function"==typeof o)t=o;else{if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(o))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=gt(o)}var h=wt.apply(void 0,"function"==typeof s?s(r):s),g=bt;c&&(g=kt(Et({trace:!1},"object"==typeof c&&c)));var y=[h];return Array.isArray(p)?y=[h].concat(p):"function"==typeof p&&(y=p(y)),pt(t,d,g.apply(void 0,y))}function _t(e,t){function r(){if(t){var r=t.apply(void 0,arguments);if(!r)throw new Error("prepareAction did not return an object");return Et({type:e,payload:r.payload},"meta"in r&&{meta:r.meta},{},"error"in r&&{error:r.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(t){return t.type===e},r}function Mt(e,t,r,n){void 0===r&&(r=[]);var i="function"==typeof t?function(e){var t,r={},n=[],i={addCase:function(e,t){var n="string"==typeof e?e:e.type;if(n in r)throw new Error("addCase cannot be called with two reducers for the same action type");return r[n]=t,i},addMatcher:function(e,t){return n.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[r,n,t]}(t):[t,r,n],o=i[0],a=i[1],s=i[2];return function(t,r){void 0===t&&(t=e);var n=[o[r.type]].concat(a.filter((function(e){return(0,e.matcher)(r)})).map((function(e){return e.reducer})));return 0===n.filter((function(e){return!!e})).length&&(n=[s]),n.reduce((function(e,t){if(t){if(ge(e)){var n=t(e,r);return void 0===n?e:n}if(ye(e))return ut(e,(function(e){return t(e,r)}));var i=t(e,r);if(void 0===i){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}return e}),t)}}"undefined"==typeof Symbol||(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"==typeof Symbol||(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var Vt=["name","message","stack","code"],$t=function(e){this.payload=e,this.name="RejectWithValue",this.message="Rejected"},Dt=function(e){if("object"==typeof e&&null!==e){var t={},r=Vt,n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var o;if(n){if(i>=r.length)break;o=r[i++]}else{if((i=r.next()).done)break;o=i.value}var a=o;"string"==typeof e[a]&&(t[a]=e[a])}return t}return{message:String(e)}};function Lt(e,t,r){var n=_t(e+"/fulfilled",(function(e,t,r){return{payload:e,meta:{arg:r,requestId:t,requestStatus:"fulfilled"}}})),i=_t(e+"/pending",(function(e,t){return{payload:void 0,meta:{arg:t,requestId:e,requestStatus:"pending"}}})),o=_t(e+"/rejected",(function(e,t,n){var i=e instanceof $t,o=!!e&&"AbortError"===e.name,a=!!e&&"ConditionError"===e.name;return{payload:e instanceof $t?e.payload:void 0,error:(r&&r.serializeError||Dt)(e||"Rejected"),meta:{arg:n,requestId:t,rejectedWithValue:i,requestStatus:"rejected",aborted:o,condition:a}}})),a="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(s,u,c){var l,d=function(e){void 0===e&&(e=21);for(var t="",r=e;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),f=new a,p=new Promise((function(e,t){return f.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:l||"Aborted"})}))})),h=!1;var g=function(){try{var a,l=function(e){return g?e:(r&&!r.dispatchConditionRejection&&o.match(a)&&a.meta.condition||s(a),a)},g=!1,y=function(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}((function(){if(r&&r.condition&&!1===r.condition(e,{getState:u,extra:c}))throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return h=!0,s(i(d,e)),Promise.resolve(Promise.race([p,Promise.resolve(t(e,{dispatch:s,getState:u,extra:c,requestId:d,signal:f.signal,rejectWithValue:function(e){return new $t(e)}})).then((function(t){return t instanceof $t?o(t,d,e):n(t,d,e)}))])).then((function(e){a=e}))}),(function(t){a=o(t,d,e)}));return Promise.resolve(y&&y.then?y.then(l):l(y))}catch(e){return Promise.reject(e)}}();return Object.assign(g,{abort:function(e){h&&(l=e,f.abort())},requestId:d,arg:e})}}),{pending:i,rejected:o,fulfilled:n,typePrefix:e})}!function(){function e(e,t){var r=i[e];return r?r.enumerable=t:i[e]=r={configurable:!0,enumerable:t,get:function(){var t=this[tt];return ot.get(t,e)},set:function(t){var r=this[tt];ot.set(r,e,t)}},r}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][tt];if(!i.P)switch(i.i){case 5:n(i)&&Ue(i);break;case 4:r(i)&&Ue(i)}}}function r(e){for(var t=e.t,r=e.k,n=rt(r),i=n.length-1;i>=0;i--){var o=n[i];if(o!==tt){var a=t[o];if(void 0===a&&!be(t,o))return!0;var s=r[o],u=s&&s[tt];if(u?u.t!==a:!Se(s,a))return!0}}var c=!!t[tt];return n.length!==rt(t).length+(c?0:1)}function n(e){var t=e.k;if(t.length!==e.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}var i={};!function(e,t){it[e]||(it[e]=t)}("ES5",{J:function(t,r){var n=Array.isArray(t),i=function(t,r){if(t){for(var n=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(n,""+i,e(i,!0));return n}var o=nt(r);delete o[tt];for(var a=rt(o),s=0;s<a.length;s++){var u=a[s];o[u]=e(u,t||!!o[u].enumerable)}return Object.create(Object.getPrototypeOf(r),o)}(n,t),o={i:n?5:4,A:r?r.A:je(),P:!1,I:!1,D:{},l:r,t:t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,tt,{value:o,writable:!0}),i},S:function(e,r,i){i?ge(r)&&r[tt].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var r=t[tt];if(r){var i=r.t,o=r.k,a=r.D,s=r.i;if(4===s)me(o,(function(t){t!==tt&&(void 0!==i[t]||be(i,t)?a[t]||e(o[t]):(a[t]=!0,Ue(r)))})),me(i,(function(e){void 0!==o[e]||be(o,e)||(a[e]=!1,Ue(r))}));else if(5===s){if(n(r)&&(Ue(r),a.length=!0),o.length<i.length)for(var u=o.length;u<i.length;u++)a[u]=!1;else for(var c=i.length;c<o.length;c++)a[c]=!0;for(var l=Math.min(o.length,i.length),d=0;d<l;d++)void 0===a[d]&&e(o[d])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?r(e):n(e)}})}();const Nt=new Z({required:!0,emptyAllowed:!1}),Ut=new Z({required:!0,emptyAllowed:!0}),zt=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),Ht=(e,t)=>"required"in t?{payload:new U({value:t}).validate({value:e}).value}:{payload:new U(t).validate(e)},Qt=(e,t)=>{try{return Ht(e,t)}catch(t){return{payload:e,error:zt(t)}}},Bt=(e,t,r,n)=>Yt(e,t,r,"Check the options of "+n,"Controller initialization error"),Yt=(e,t,r,n,i)=>{try{return t.validate(r,n)}catch(t){throw e.logger.error(t,i),t}},Wt=new Z({emptyAllowed:!1,required:!1}),Jt=()=>new Z({emptyAllowed:!1,required:!1}),Kt=()=>new Z({emptyAllowed:!1,required:!0}),Zt=_t("configuration/updateBasicConfiguration",(e=>Qt(e,{accessToken:new Z({emptyAllowed:!1}),organizationId:new Z({emptyAllowed:!1}),platformUrl:new Z({url:!0,emptyAllowed:!1})}))),Xt=_t("configuration/updateSearchConfiguration",(e=>Qt(e,{apiBaseUrl:new Z({url:!0,emptyAllowed:!1}),pipeline:new Z({emptyAllowed:!1}),searchHub:new Z({emptyAllowed:!1}),locale:Wt}))),Gt=_t("configuration/updateAnalyticsConfiguration",(e=>Qt(e,{enabled:new W({default:!0}),originLevel2:Jt(),originLevel3:Jt(),apiBaseUrl:new Z({url:!0,emptyAllowed:!1}),runtimeEnvironment:new z}))),er=_t("configuration/analytics/disable"),tr=_t("configuration/analytics/enable"),rr=_t("configuration/analytics/originlevel2",(e=>Qt(e,{originLevel2:Kt()}))),nr=_t("configuration/analytics/originlevel3",(e=>Qt(e,{originLevel3:Kt()})));const ir=e=>()=>t=>r=>{if(!r.error)return t(r);const n=r.error;return e.error(n.stack||n.message||n.name||"Error","Action dispatch error "+r.type,r),"SchemaValidationError"!==r.error.name?t(r):void 0};const or=_t("history/undo"),ar=_t("history/redo"),sr=_t("history/snapshot");Lt("history/back",(async(e,{dispatch:t})=>{t(or()),await t(ur())})),Lt("history/forward",(async(e,{dispatch:t})=>{t(ar()),await t(ur())}));const ur=Lt("history/change",(async(e,{getState:t})=>t().history.present)),cr=_t("advancedSearchQueries/update",(e=>Qt(e,{aq:new Z({required:!1,emptyAllowed:!0}),cq:new Z({required:!1,emptyAllowed:!0})}))),lr=_t("advancedSearchQueries/register",(e=>Qt(e,{aq:new Z({required:!1,emptyAllowed:!0}),cq:new Z({required:!1,emptyAllowed:!0})}))),dr={q:new Z,enableQuerySyntax:new W,aq:new Z,cq:new Z,firstResult:new B({min:0}),numberOfResults:new B({min:0}),sortCriteria:new Z,f:new G,cf:new G,nf:new G,df:new G,debug:new W},fr=_t("searchParameters/restore",(e=>Qt(e,dr)));Mt({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},(e=>{e.addCase(cr,((e,t)=>{const{aq:r,cq:n}=t.payload;H(r)||(e.aq=r,e.aqWasSet=!0),H(n)||(e.cq=n,e.cqWasSet=!0)})).addCase(lr,((e,t)=>{const{aq:r,cq:n}=t.payload;H(r)||(e.defaultFilters.aq=r,e.aqWasSet||(e.aq=r)),H(n)||(e.defaultFilters.cq=n,e.cqWasSet||(e.cq=n))})).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.advancedSearchQueries)&&void 0!==n?n:e})).addCase(fr,((e,t)=>{const{aq:r,cq:n}=t.payload;H(r)||(e.aq=r,e.aqWasSet=!0),H(n)||(e.cq=n,e.cqWasSet=!0)}))}));const pr=Mt({organizationId:"",accessToken:"",platformUrl:M(),search:{apiBaseUrl:M()+"/rest/search/v2",locale:"en-US"},analytics:{enabled:!0,apiBaseUrl:M()+"/rest/ua",originLevel2:"default",originLevel3:"default"}},(e=>e.addCase(Zt,((e,t)=>{t.payload.accessToken&&(e.accessToken=t.payload.accessToken),t.payload.organizationId&&(e.organizationId=t.payload.organizationId),t.payload.platformUrl&&(e.platformUrl=t.payload.platformUrl,e.search.apiBaseUrl=t.payload.platformUrl+"/rest/search/v2",e.analytics.apiBaseUrl=t.payload.platformUrl+"/rest/ua")})).addCase(Xt,((e,t)=>{t.payload.apiBaseUrl&&(e.search.apiBaseUrl=t.payload.apiBaseUrl),t.payload.locale&&(e.search.locale=t.payload.locale)})).addCase(Gt,((e,t)=>{void 0!==t.payload.enabled&&(e.analytics.enabled=t.payload.enabled),void 0!==t.payload.originLevel2&&(e.analytics.originLevel2=t.payload.originLevel2),void 0!==t.payload.originLevel3&&(e.analytics.originLevel3=t.payload.originLevel3),void 0!==t.payload.apiBaseUrl&&(e.analytics.apiBaseUrl=t.payload.apiBaseUrl),void 0!==t.payload.runtimeEnvironment&&(e.analytics.runtimeEnvironment=t.payload.runtimeEnvironment)})).addCase(er,(e=>{e.analytics.enabled=!1})).addCase(tr,(e=>{e.analytics.enabled=!0})).addCase(rr,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(nr,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})))),hr=new te({each:Nt,required:!0}),gr=(e,t)=>(Qt(e,Nt),X(t)?Qt(t,Nt):Qt(t,hr),{payload:{contextKey:e,contextValue:t}}),yr=_t("context/set",(e=>{for(const[t,r]of Object.entries(e))gr(t,r);return{payload:e}})),mr=_t("context/add",(e=>gr(e.contextKey,e.contextValue))),vr=_t("context/remove",(e=>Qt(e,Nt)));const br=Mt({contextValues:{}},(e=>{e.addCase(yr,((e,t)=>{e.contextValues=t.payload})).addCase(mr,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase(vr,((e,t)=>{delete e.contextValues[t.payload]})).addCase(ur.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.context.contextValues)}))})),wr=_t("debug/enable"),Sr=_t("debug/disable");Mt(!1,(e=>{e.addCase(wr,(()=>!0)).addCase(Sr,(()=>!1)).addCase(fr,((e,t)=>{var r;return null!==(r=t.payload.debug)&&void 0!==r?r:e}))}));const Or=Mt("1.7.0",(e=>e)),Cr=_t("didYouMean/enable"),qr=_t("didYouMean/disable"),Er=_t("didYouMean/correction",(e=>Qt(e,Nt)));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function xr(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function Ir(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}var Ar;!function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"}(Ar||(Ar={}));const Rr=window.fetch;class jr{constructor(e){this.opts=e}sendEvent(e,t){return Ir(this,void 0,void 0,(function*(){const{baseUrl:r,visitorIdProvider:n,preprocessRequest:i}=this.opts,o=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",a={url:`${r}/analytics/${e}${o}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},s=Object.assign(Object.assign({},a),i?yield i(a,"analyticsFetch"):{}),{url:u}=s,c=xr(s,["url"]),l=yield Rr(u,c);if(l.ok){const e=yield l.json();return e.visitorId&&n.setCurrentVisitorId(e.visitorId),e}try{l.json()}catch(e){}throw console.error(`An error has occured when sending the "${e}" event.`,l,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}))}shouldAppendVisitorId(e){return-1!==[Ar.click,Ar.custom,Ar.search,Ar.view].indexOf(e)}getVisitorIdParam(){return Ir(this,void 0,void 0,(function*(){const{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?"?visitor="+t:""}))}getHeaders(){const{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:"Bearer "+e}:{}),{"Content-Type":"application/json"})}}function kr(){return"undefined"!=typeof navigator}function Pr(){return"undefined"!=typeof document}function Tr(){return"undefined"!=typeof localStorage}function Fr(){return kr()&&navigator.cookieEnabled}function _r(){return"undefined"!=typeof crypto&&void 0!==crypto.getRandomValues}const Mr=[Ar.click,Ar.custom,Ar.search,Ar.view],Vr=(e,t)=>-1!==Mr.indexOf(e)?Object.assign({language:Pr()?document.documentElement.lang:"unknown",userAgent:kr()?navigator.userAgent:"unknown"},t):t;class $r{static set(e,t,r){var n,i,o,a;r?((i=new Date).setTime(i.getTime()+r),o="; expires="+i.toGMTString()):o="",-1===(a=location.hostname).indexOf(".")?document.cookie=e+"="+t+o+"; path=/":((n=a.split(".")).shift(),Dr({name:e,value:t,expires:o,domain:"."+n.join(".")}),null!=$r.get(e)&&$r.get(e)==t||Dr({name:e,value:t,expires:o,domain:"."+a}))}static get(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var i=r[n];if(0==(i=i.replace(/^\s+/,"")).indexOf(t))return i.substring(t.length,i.length)}return null}static erase(e){$r.set(e,"",-1)}}function Dr(e){const{name:t,value:r,expires:n,domain:i}=e;document.cookie=`${t}=${r}${n}; path=/; domain=${i}; SameSite=Lax`}function Lr(){return Tr()?localStorage:Fr()?new Nr:"undefined"!=typeof sessionStorage?sessionStorage:new zr}class Nr{getItem(e){return $r.get(`${Nr.prefix}${e}`)}removeItem(e){$r.erase(`${Nr.prefix}${e}`)}setItem(e,t){$r.set(`${Nr.prefix}${e}`,t)}}Nr.prefix="coveo_";class Ur{constructor(){this.cookieStorage=new Nr}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t)}}class zr{getItem(e){return null}removeItem(e){}setItem(e,t){}}const Hr="__coveo.analytics.history";class Qr{constructor(e){this.store=e||Lr()}addElement(e){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=this.getHistoryWithInternalTime();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return Ir(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),this.cropQueryElement(e);let t=yield this.getHistoryWithInternalTimeAsync();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){const e=this.getHistoryWithInternalTime();return this.stripInternalTime(e)}getHistoryAsync(){return Ir(this,void 0,void 0,(function*(){const e=yield this.getHistoryWithInternalTimeAsync();return this.stripInternalTime(e)}))}getHistoryWithInternalTime(){try{const e=this.store.getItem(Hr);return e&&"string"==typeof e?JSON.parse(e):[]}catch(e){return[]}}getHistoryWithInternalTimeAsync(){return Ir(this,void 0,void 0,(function*(){try{const e=yield this.store.getItem(Hr);return e?JSON.parse(e):[]}catch(e){return[]}}))}setHistory(e){try{this.store.setItem(Hr,JSON.stringify(e.slice(0,20)))}catch(e){}}clear(){try{this.store.removeItem(Hr)}catch(e){}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();if(null!=e){return e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]}return null}cropQueryElement(e){e.name&&"query"==e.name.toLowerCase()&&null!=e.value&&(e.value=e.value.slice(0,75))}isValidEntry(e){let t=this.getMostRecentElement();return!t||t.value!=e.value||(e.internalTime||0)-(t.internalTime||0)>6e4}stripInternalTime(e){return e.map((e=>{const{name:t,time:r,value:n}=e;return{name:t,time:r,value:n}}))}}var Br=Object.freeze({__proto__:null,STORE_KEY:Hr,MAX_NUMBER_OF_HISTORY_ELEMENTS:20,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:6e4,MAX_VALUE_SIZE:75,HistoryStore:Qr,default:Qr});const Yr=(e,t)=>Ir(void 0,void 0,void 0,(function*(){return e===Ar.view?(yield Wr(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),Wr=e=>Ir(void 0,void 0,void 0,(function*(){const t=new Qr,r={name:"PageView",value:e,time:JSON.stringify(new Date)};yield t.addElementAsync(r)})),Jr=e=>e?(Number(e)^Kr(new Uint8Array(1))[0]%16>>Number(e)/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,Jr),Kr=e=>{if(_r())return crypto.getRandomValues(e);for(var t=0,r=0;t<e.length;t++)0==(3&t)&&(r=4294967296*Math.random()),e[t]=r>>>((3&t)<<3)&255;return e},Zr=Object.keys,Xr={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},Gr=[...Zr(Xr).map((e=>Xr[e]))].join("|"),en=new RegExp(`^(${Gr}$)`),tn=[e=>en.test(e)],rn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},nn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr"},on={action:"pa",list:"pal",listSource:"pls"},an={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},sn={id:"quoteId",affiliation:"quoteAffiliation"},un={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},cn={add:on,bookmark_add:on,bookmark_remove:on,click:on,checkout:on,checkout_option:on,detail:on,impression:on,remove:on,refund:Object.assign(Object.assign({},on),an),purchase:Object.assign(Object.assign({},on),an),quickview:on,quote:Object.assign(Object.assign({},on),sn),review:Object.assign(Object.assign({},on),un)},ln=Zr(rn).map((e=>rn[e])),dn=Zr(nn).map((e=>nn[e])),fn=Zr(on).map((e=>on[e])),pn=Zr(an).map((e=>an[e])),hn=Zr(un).map((e=>un[e])),gn=Zr(sn).map((e=>sn[e])),yn=[...ln,"custom"].join("|"),mn=[...dn,"custom"].join("|"),vn=new RegExp(`^(pr[0-9]+)(${yn})$`),bn=new RegExp(`^((il[0-9]+pi[0-9]+)(${mn}))|(il[0-9]+nm)$`),wn=new RegExp(`^(${fn.join("|")})$`),Sn=new RegExp(`^(${pn.join("|")})$`),On=new RegExp("^(pr[0-9]+)custom$"),Cn=new RegExp("^(il[0-9]+pi[0-9]+)custom$"),qn=new RegExp(`^(${["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit",...hn,...gn].join("|")})$`),En=[e=>bn.test(e),e=>vn.test(e),e=>wn.test(e),e=>Sn.test(e),e=>qn.test(e)],xn=[On,Cn],In=Object.assign(Object.assign(Object.assign({},{anonymizeIp:"aip"}),{eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"}),{hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"}),An=Object.assign(Object.assign({},In),{svcAction:"svc_action",svcActionData:"svc_action_data"}),Rn=Zr(An).map((e=>An[e])),jn=e=>-1!==Rn.indexOf(e),kn=e=>"custom"===e,Pn=e=>{let t=void 0;return[...xn].every((r=>{var n;return t=null===(n=r.exec(e))||void 0===n?void 0:n[1],!Boolean(t)})),t},Tn=(e,t)=>Zr(t).reduce(((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]})),{});class Fn{constructor(e){this.opts=e}sendEvent(e,t){return Ir(this,void 0,void 0,(function*(){if(!navigator.sendBeacon)throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');const{baseUrl:r,preprocessRequest:n}=this.opts,i=this.encodeForEventType(e,t),o=yield this.getQueryParamsForEventType(e),a={url:`${r}/analytics/${e}?${o}`,body:new Blob([i],{type:"application/x-www-form-urlencoded"})},{url:s,body:u}=Object.assign(Object.assign({},a),n?yield n(a,"analyticsBeacon"):{});console.log(`Sending beacon for "${e}" with: `,JSON.stringify(t)),navigator.sendBeacon(s,u)}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeForLegacyType(e,t):this.encodeForFormUrlEncoded(Object.assign({access_token:this.opts.token},t))}getQueryParamsForEventType(e){return Ir(this,void 0,void 0,(function*(){const{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?"access_token="+t:"",n?"visitorId="+n:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return-1!==[Ar.click,Ar.custom,Ar.search,Ar.view].indexOf(e)}encodeForLegacyType(e,t){return`${e}Event=${encodeURIComponent(JSON.stringify(t))}`}encodeForFormUrlEncoded(e){return Object.keys(e).filter((t=>!!e[t])).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(this.encodeValue(e[t]))}`)).join("&")}encodeValue(e){return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e:JSON.stringify(e)}}class _n{sendEvent(e,t){return Ir(this,void 0,void 0,(function*(){return Promise.resolve()}))}}class Mn{constructor(e,t){Tr()&&Fr()?this.storage=new Ur:Tr()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new zr),this.beaconClient=new Fn(e),window.addEventListener("beforeunload",(()=>t()))}}class Vn{constructor(e,t){this.storage=t||new zr,this.beaconClient=new jr(e)}}class $n{constructor(){this.storage=new zr,this.beaconClient=new _n}}const Dn="https://analytics.cloud.coveo.com/rest/ua";class Ln{constructor(e){if(!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Yr,Vr].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};const t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.analyticsFetchClient=new jr(t)}get defaultOptions(){return{endpoint:Dn,token:"",version:"v15",beforeSendHooks:[],afterSendHooks:[]}}initRuntime(e){return"undefined"!=typeof window&&Pr()?new Mn(e,(()=>this.flushBufferWithBeacon())):("undefined"!=typeof navigator&&"ReactNative"==navigator.product&&console.warn("\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please install @react-native-async-storage/async-storage and instantiate \n        your analytics client as follows:\n        \n        import {ReactNativeRuntime} from 'coveo.analytics/react-native';\n        \n        const analytics = new CoveoAnalytics({\n            ...your options,\n            runtimeEnvironment: new ReactNativeRuntime();\n        })\n    "),new Vn(e))}get analyticsBeaconClient(){return this.runtime.beaconClient}get storage(){return this.runtime.storage}determineVisitorId(){return Ir(this,void 0,void 0,(function*(){try{return(yield this.storage.getItem("visitorId"))||Jr()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Jr()}}))}getCurrentVisitorId(){return Ir(this,void 0,void 0,(function*(){if(!this.visitorId){const e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return Ir(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}getParameters(e,...t){return Ir(this,void 0,void 0,(function*(){return yield this.resolveParameters(e,...t)}))}getPayload(e,...t){return Ir(this,void 0,void 0,(function*(){const r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)}))}get currentVisitorId(){return"string"!=typeof(this.visitorId||this.storage.getItem("visitorId"))&&this.setCurrentVisitorId(Jr()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}resolveParameters(e,...t){return Ir(this,void 0,void 0,(function*(){const{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:i=!1}=this.eventTypeMapping[e]||{};return yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>Ir(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{visitorId:n?yield this.getCurrentVisitorId():""})})),e=>i?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,r)=>Ir(this,void 0,void 0,(function*(){const n=yield t;return yield r(e,n)}))),t)].reduce(((e,t)=>Ir(this,void 0,void 0,(function*(){const r=yield e;return yield t(r)}))),Promise.resolve(t))}))}resolvePayloadForParameters(e,t){return Ir(this,void 0,void 0,(function*(){const{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[t=>this.removeEmptyPayloadValues(t,e),e=>this.validateParams(e),e=>r?(e=>{const t=!!e.action&&cn[e.action]||{};return Zr(e).reduce(((r,n)=>{const i=t[n]||An[n]||n;return Object.assign(Object.assign({},r),{[i]:e[n]})}),{})})(e):e,e=>r?this.removeUnknownParameters(e):e,e=>r?this.processCustomParameters(e):e].reduce(((e,t)=>Ir(this,void 0,void 0,(function*(){const r=yield e;return yield t(r)}))),Promise.resolve(t))}))}sendEvent(e,...t){return Ir(this,void 0,void 0,(function*(){const{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),i=yield this.resolvePayloadForParameters(e,n);return this.bufferedRequests.push({eventType:r,payload:i,handled:!1}),yield Promise.all(this.afterSendHooks.map((t=>t(e,n)))),yield this.deferExecution(),yield this.sendFromBufferWithFetch()}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}flushBufferWithBeacon(){for(;this.hasPendingRequests();){const{eventType:e,payload:t}=this.bufferedRequests.pop();this.analyticsBeaconClient.sendEvent(e,t)}}sendFromBufferWithFetch(){return Ir(this,void 0,void 0,(function*(){const e=this.bufferedRequests.shift();if(e){const{eventType:t,payload:r}=e;return this.analyticsFetchClient.sendEvent(t,r)}}))}hasPendingRequests(){return this.bufferedRequests.length>0}clear(){this.storage.removeItem("visitorId");(new Qr).clear()}sendSearchEvent(e){return Ir(this,void 0,void 0,(function*(){return this.sendEvent(Ar.search,e)}))}sendClickEvent(e){return Ir(this,void 0,void 0,(function*(){return this.sendEvent(Ar.click,e)}))}sendCustomEvent(e){return Ir(this,void 0,void 0,(function*(){return this.sendEvent(Ar.custom,e)}))}sendViewEvent(e){return Ir(this,void 0,void 0,(function*(){return this.sendEvent(Ar.view,e)}))}getVisit(){return Ir(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/visit"),t=yield e.json();return this.visitorId=t.visitorId,t}))}getHealth(){return Ir(this,void 0,void 0,(function*(){const e=yield fetch(this.baseUrl+"/analytics/monitoring/health");return yield e.json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}parseVariableArgumentsPayload(e,t){const r={};for(let n=0,i=t.length;n<i;n++){const i=t[n];if("string"==typeof i)r[e[n]]=i;else if("object"==typeof i)return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return-1!==({[Ar.search]:["queryText"]}[e]||[]).indexOf(t)}removeEmptyPayloadValues(e,t){return Object.keys(e).filter((r=>{return this.isKeyAllowedEmpty(t,r)||null!=(n=e[r])&&""!==n;var n})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if((e=>[...En,...tn,jn,kn].some((t=>t(e))))(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}processCustomParameters(e){const{custom:t}=e,r=xr(e,["custom"]),n=this.lowercaseKeys(t),i=Zr(o=r).reduce(((e,t)=>{const r=Pn(t);return r?Object.assign(Object.assign({},e),Tn(r,o[t])):Object.assign(Object.assign({},e),{[t]:o[t]})}),{});var o;return Object.assign(Object.assign({},n),i)}lowercaseKeys(e){return Object.keys(e||{}).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r.toLowerCase()]:e[r]})),{})}validateParams(e){const{anonymizeIp:t}=e,r=xr(e,["anonymizeIp"]);return void 0!==t&&-1==["0","false","undefined","null","{}","[]",""].indexOf((""+t).toLowerCase())&&(r.anonymizeIp=1),r}ensureAnonymousUserWhenUsingApiKey(e){const{userId:t}=e,r=xr(e,["userId"]);return(null==(n=this.options.token)?void 0:n.startsWith("xx"))&&!t?(r.userId="anonymous",r):e;var n}get baseUrl(){const{version:e,endpoint:t}=this.options,r=-1!==t.indexOf(".cloud.coveo.com");return`${t}${r?"":"/rest"}/${e}`}}var Nn;!function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion"}(Nn||(Nn={}));const Un={[Nn.triggerNotify]:"queryPipelineTriggers",[Nn.triggerExecute]:"queryPipelineTriggers",[Nn.triggerQuery]:"queryPipelineTriggers",[Nn.triggerRedirect]:"queryPipelineTriggers",[Nn.queryError]:"errors",[Nn.queryErrorBack]:"errors",[Nn.queryErrorClear]:"errors",[Nn.queryErrorRetry]:"errors",[Nn.pagerNext]:"getMoreResults",[Nn.pagerPrevious]:"getMoreResults",[Nn.pagerNumber]:"getMoreResults",[Nn.pagerResize]:"getMoreResults",[Nn.pagerScrolling]:"getMoreResults",[Nn.facetSearch]:"facet",[Nn.facetShowLess]:"facet",[Nn.facetShowMore]:"facet",[Nn.recommendation]:"recommendation",[Nn.likeSmartSnippet]:"smartSnippet",[Nn.dislikeSmartSnippet]:"smartSnippet",[Nn.expandSmartSnippet]:"smartSnippet",[Nn.collapseSmartSnippet]:"smartSnippet",[Nn.openSmartSnippetFeedbackModal]:"smartSnippet",[Nn.closeSmartSnippetFeedbackModal]:"smartSnippet",[Nn.sendSmartSnippetReason]:"smartSnippet",[Nn.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[Nn.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions"};var zn;!function(e){e.DoesNotAnswer="does_not_answer",e.PartiallyAnswers="partially_answers",e.WasNotAQuestion="was_not_a_question",e.Other="other"}(zn||(zn={}));class Hn{constructor(){this.runtime=new $n,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}sendEvent(){return Promise.resolve()}sendSearchEvent(){return Promise.resolve()}sendClickEvent(){return Promise.resolve()}sendCustomEvent(){return Promise.resolve()}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}}function Qn(e){const t=e.join(";");return t.length<=256?t:Qn(e.slice(1))}const Bn=e=>Qn(function(e){let t="";return e.filter((e=>{const r=e!==t;return t=e,r}))}(function(e){return e.map((e=>e.replace(/;/g,"")))}(e)));function Yn(e){const t="string"==typeof e.partialQueries?e.partialQueries:Bn(e.partialQueries),r="string"==typeof e.suggestions?e.suggestions:Bn(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}class Wn{constructor(e,t){this.opts=e,this.provider=t,this.coveoAnalyticsClient=!1===e.enableAnalytics?new Hn:new Ln(e)}disable(){this.coveoAnalyticsClient instanceof Ln&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new Hn}enable(){this.coveoAnalyticsClient=new Ln(this.opts)}logInterfaceLoad(){return this.logSearchEvent(Nn.interfaceLoad)}logRecommendationInterfaceLoad(){return this.logSearchEvent(Nn.recommendationInterfaceLoad)}logRecommendation(){return this.logCustomEvent(Nn.recommendation)}logRecommendationOpen(e,t){return this.logClickEvent(Nn.recommendationOpen,e,t)}logFetchMoreResults(){return this.logCustomEvent(Nn.pagerScrolling,{type:"getMoreResults"})}logInterfaceChange(e){return this.logSearchEvent(Nn.interfaceChange,e)}logDidYouMeanAutomatic(){return this.logSearchEvent(Nn.didyoumeanAutomatic)}logDidYouMeanClick(){return this.logSearchEvent(Nn.didyoumeanClick)}logResultsSort(e){return this.logSearchEvent(Nn.resultsSort,e)}logSearchboxSubmit(){return this.logSearchEvent(Nn.searchboxSubmit)}logSearchboxClear(){return this.logSearchEvent(Nn.searchboxClear)}logSearchboxAsYouType(){return this.logSearchEvent(Nn.searchboxAsYouType)}logBreadcrumbFacet(e){return this.logSearchEvent(Nn.breadcrumbFacet,e)}logBreadcrumbResetAll(){return this.logSearchEvent(Nn.breadcrumbResetAll)}logDocumentQuickview(e,t){return this.logClickEvent(Nn.documentQuickview,e,t)}logDocumentOpen(e,t){return this.logClickEvent(Nn.documentOpen,e,t)}logOmniboxAnalytics(e){return this.logSearchEvent(Nn.omniboxAnalytics,Yn(e))}logOmniboxFromLink(e){return this.logSearchEvent(Nn.omniboxFromLink,Yn(e))}logSearchFromLink(){return this.logSearchEvent(Nn.searchFromLink)}logTriggerNotify(e){return this.logCustomEvent(Nn.triggerNotify,e)}logTriggerExecute(e){return this.logCustomEvent(Nn.triggerExecute,e)}logTriggerQuery(){const e={query:this.provider.getSearchEventRequestPayload().queryText};return this.logCustomEvent(Nn.triggerQuery,e)}logTriggerRedirect(e){const t=Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText});return this.logCustomEvent(Nn.triggerRedirect,t)}logPagerResize(e){return this.logCustomEvent(Nn.pagerResize,e)}logPagerNumber(e){return this.logCustomEvent(Nn.pagerNumber,e)}logPagerNext(e){return this.logCustomEvent(Nn.pagerNext,e)}logPagerPrevious(e){return this.logCustomEvent(Nn.pagerPrevious,e)}logPagerScrolling(){return this.logCustomEvent(Nn.pagerScrolling)}logFacetClearAll(e){return this.logSearchEvent(Nn.facetClearAll,e)}logFacetSearch(e){return this.logSearchEvent(Nn.facetSearch,e)}logFacetSelect(e){return this.logSearchEvent(Nn.facetSelect,e)}logFacetDeselect(e){return this.logSearchEvent(Nn.facetDeselect,e)}logFacetExclude(e){return this.logSearchEvent(Nn.facetExclude,e)}logFacetUnexclude(e){return this.logSearchEvent(Nn.facetUnexclude,e)}logFacetSelectAll(e){return this.logSearchEvent(Nn.facetSelectAll,e)}logFacetUpdateSort(e){return this.logSearchEvent(Nn.facetUpdateSort,e)}logFacetShowMore(e){return this.logCustomEvent(Nn.facetShowMore,e)}logFacetShowLess(e){return this.logCustomEvent(Nn.facetShowLess,e)}logQueryError(e){return this.logCustomEvent(Nn.queryError,e)}logQueryErrorBack(){return Ir(this,void 0,void 0,(function*(){return yield this.logCustomEvent(Nn.queryErrorBack),this.logSearchEvent(Nn.queryErrorBack)}))}logQueryErrorRetry(){return Ir(this,void 0,void 0,(function*(){return yield this.logCustomEvent(Nn.queryErrorRetry),this.logSearchEvent(Nn.queryErrorRetry)}))}logQueryErrorClear(){return Ir(this,void 0,void 0,(function*(){return yield this.logCustomEvent(Nn.queryErrorClear),this.logSearchEvent(Nn.queryErrorClear)}))}logLikeSmartSnippet(){return this.logCustomEvent(Nn.likeSmartSnippet)}logDislikeSmartSnippet(){return this.logCustomEvent(Nn.dislikeSmartSnippet)}logExpandSmartSnippet(){return this.logCustomEvent(Nn.expandSmartSnippet)}logCollapseSmartSnippet(){return this.logCustomEvent(Nn.collapseSmartSnippet)}logOpenSmartSnippetFeedbackModal(){return this.logCustomEvent(Nn.openSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return this.logCustomEvent(Nn.closeSmartSnippetFeedbackModal)}logSmartSnippetFeedbackReason(e,t){return this.logCustomEvent(Nn.sendSmartSnippetReason,{reason:e,details:t})}logExpandSmartSnippetSuggestion(e){return this.logCustomEvent(Nn.expandSmartSnippetSuggestion,{documentId:e})}logCollapseSmartSnippetSuggestion(e){return this.logCustomEvent(Nn.collapseSmartSnippetSuggestion,{documentId:e})}logCustomEvent(e,t){const r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),n=Object.assign(Object.assign({},this.getBaseCustomEventRequest(r)),{eventType:Un[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(n)}logCustomEventWithType(e,t,r){const n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},this.getBaseCustomEventRequest(n)),{eventType:t,eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(i)}logSearchEvent(e,t){return this.coveoAnalyticsClient.sendSearchEvent(this.getBaseSearchEventRequest(e,t))}logClickEvent(e,t,r,n){const i=Object.assign(Object.assign(Object.assign({},t),this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(i)}getBaseSearchEventRequest(e,t){return Object.assign(Object.assign(Object.assign({},this.getBaseEventRequest(t)),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})}getBaseCustomEventRequest(e){return Object.assign(Object.assign({},this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})}getBaseEventRequest(e){const t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[]})}getOrigins(){return{originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}}const Jn=e=>{const t=e.configuration.search.locale.split("-")[0];return t&&2===t.length?t:"en"};function Kn(e){if(!e)return{parents:[],values:[]};let t=[],r=e;for(;r.length&&r[0].children.length;)t=[...t,...r],r=r[0].children;const n=r.find((e=>"selected"===e.state));return n&&(t=[...t,n],r=[]),{parents:t,values:r}}const Zn=(e,t)=>{const r=((e,t)=>{const r=((e,t)=>e.search.response.facets.find((e=>e.facetId===t)))(e,t);if(function(e,t){return!!t&&t.facetId in e.categoryFacetSet}(e,r))return r})(e,t);return Kn(null==r?void 0:r.values).parents};function Xn(e){return{facetSet:e.facetSet||{},categoryFacetSet:e.categoryFacetSet||{},dateFacetSet:e.dateFacetSet||{},numericFacetSet:e.numericFacetSet||{},search:e.search||{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]}}}const Gn=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),ei=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),ti=e=>({displayValue:e.value,value:e.value}),ri=(e,t)=>{const r=((e,t)=>Zn(e,t).map((e=>e.value)).join(";"))(e,t);return{value:r,valuePosition:1,displayValue:r}},ni=(e,t)=>({title:`${e.field}_${e.facetId}`,field:e.field,id:e.facetId,facetPosition:t}),ii=(e,t)=>{var r;return e.facetSet[t]||(null===(r=e.categoryFacetSet[t])||void 0===r?void 0:r.request)||e.dateFacetSet[t]||e.numericFacetSet[t]},oi=(e,t)=>{const r=ii(e,t);return r?r.type:"specific"};class ai{constructor(e){this.state=e}getLanguage(){return Jn(this.state)}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults,getBaseMetadata:this.getBaseMetadata()}}getBaseMetadata(){const{context:e}=this.state,t=(null==e?void 0:e.contextValues)||{},r={};for(const[e,n]of Object.entries(t)){r["context_"+e]=n}return r}getSearchUID(){var e,t;return(null===(e=this.state.search)||void 0===e?void 0:e.response.searchUid)||(null===(t=this.state.recommendation)||void 0===t?void 0:t.searchUid)||""}getPipeline(){return this.state.pipeline||"default"}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}getFacetState(){return(e=>{const t=[];return e.search.response.facets.forEach(((r,n)=>{const i=oi(e,r.facetId),o=ni(r,n+1);if("hierarchical"!==i)r.values.forEach(((e,r)=>{if("idle"===e.state)return;const n=Gn(e,r+1,i),a="specific"===i?ti(e):ei(e);t.push({...o,...n,...a})}));else{if(!Zn(e,r.facetId).length)return;t.push({...o,...ri(e,r.facetId),facetType:i,state:"selected"})}})),t})(Xn(this.state))}mapResultsToAnalyticsDocument(){var e;return null===(e=this.state.search)||void 0===e?void 0:e.response.results.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get queryText(){var e;return(null===(e=this.state.query)||void 0===e?void 0:e.q)||""}get responseTime(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.duration)||0}get numberOfResults(){var e;return(null===(e=this.state.search)||void 0===e?void 0:e.response.results.length)||[].length}}const si=()=>new Ln({}).currentVisitorId,ui=new Br.HistoryStore;var ci;!function(e){e[e.Search=0]="Search",e[e.Custom=1]="Custom",e[e.Click=2]="Click"}(ci||(ci={}));const li=(e,t,r,n=(e=>new ai(e)))=>Lt(e,(async(e,{getState:i,extra:{analyticsClientMiddleware:o,preprocessRequest:a,logger:s}})=>{const u=(e=>e())(i),c=(({logger:e,state:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new ai(t)})=>{const o=t.configuration.accessToken,a=t.configuration.analytics.apiBaseUrl,s=t.configuration.analytics.runtimeEnvironment,u=new Wn({token:o,endpoint:a,runtimeEnvironment:s,preprocessRequest:n,beforeSendHooks:[r,(t,r)=>(e.info({...r,type:t,endpoint:a,token:o},"Analytics request"),r)]},i);return!1===t.configuration.analytics.enabled&&u.disable(),u})({state:u,logger:s,analyticsClientMiddleware:o,preprocessRequest:a,provider:n(u)}),l=await r(c,u);return s.info({client:c.coveoAnalyticsClient,response:l},"Analytics response"),{analyticsType:t}}));li("analytics/didyoumean/click",ci.Search,(e=>e.logDidYouMeanClick()));const di=li("analytics/didyoumean/automatic",ci.Search,(e=>e.logDidYouMeanAutomatic())),fi=_t("query/updateQuery",(e=>Qt(e,{q:new Z,enableQuerySyntax:new W})));var pi,hi;!function(e){e.Ascending="ascending",e.Descending="descending"}(pi||(pi={})),function(e){e.Relevancy="relevancy",e.QRE="qre",e.Date="date",e.Field="field",e.NoSort="nosort"}(hi||(hi={}));const gi=e=>{if(re(e))return e.map((e=>gi(e))).join(",");switch(e.by){case hi.Relevancy:case hi.QRE:case hi.NoSort:return e.by;case hi.Date:return"date "+e.order;case hi.Field:return`@${e.field} ${e.order}`;default:return""}};function yi(){return gi({by:hi.Relevancy})}function mi(e){var t,r;return{context:e.context||{contextValues:{}},facetSet:e.facetSet||{},numericFacetSet:e.numericFacetSet||{},dateFacetSet:e.dateFacetSet||{},categoryFacetSet:e.categoryFacetSet||{},pagination:e.pagination||{firstResult:0,numberOfResults:10,totalCountFiltered:0},query:e.query||{q:"",enableQuerySyntax:!1},advancedSearchQueries:e.advancedSearchQueries||{cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,defaultFilters:{cq:"",aq:""}},querySet:e.querySet||{},sortCriteria:e.sortCriteria||yi(),pipeline:e.pipeline||"default",searchHub:e.searchHub||"default",facetOptions:e.facetOptions||{freezeFacetOrder:!1},facetOrder:null!==(t=e.facetOrder)&&void 0!==t?t:[],debug:null!==(r=e.debug)&&void 0!==r&&r}}const vi=li("search/logFetchMoreResults",ci.Search,(e=>e.logFetchMoreResults())),bi=e=>li("search/queryError",ci.Search,((t,r)=>{var n,i,o;return t.logQueryError({query:(null===(n=r.query)||void 0===n?void 0:n.q)||"",aq:(null===(i=r.advancedSearchQueries)||void 0===i?void 0:i.aq)||"",cq:(null===(o=r.advancedSearchQueries)||void 0===o?void 0:o.cq)||"",dq:"",errorType:e.type,errorMessage:e.message})}))(),wi=async(e,t,r)=>{var n;const i=(new Date).getTime();return{response:await e.search(r),duration:(new Date).getTime()-i,queryExecuted:(null===(n=t.query)||void 0===n?void 0:n.q)||"",requestExecuted:r}},Si=Lt("search/executeSearch",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:i})=>{const o=t();ji(o);const a=await wi(i.searchAPIClient,o,xi(o));if(ue(a.response))return r(bi(a.response.error)),n(a.response.error);if(!Ei(o,a.response.success))return r(sr(mi(o))),{...a,response:a.response.success,automaticallyCorrected:!1,originalQuery:ki(o),analyticsAction:e};const{correctedQuery:s}=a.response.success.queryCorrections[0],u=await qi(i.searchAPIClient,s,t,r);if(ue(u.response))return r(bi(u.response.error)),n(u.response.error);const c=a.response.success;return e(r,(()=>Ci(a.queryExecuted,a.duration,o,c)),i),r(sr(mi(t()))),{...u,response:{...u.response.success,queryCorrections:a.response.success.queryCorrections},automaticallyCorrected:!0,originalQuery:ki(o),analyticsAction:di()}})),Oi=Lt("search/fetchMoreResults",(async(e,{getState:t,dispatch:r,rejectWithValue:n,extra:{searchAPIClient:i}})=>{const o=t(),a=await wi(i,o,Ii(o));return ue(a.response)?(r(bi(a.response.error)),n(a.response.error)):(r(sr(mi(o))),{...a,response:a.response.success,automaticallyCorrected:!1,originalQuery:ki(o),analyticsAction:vi()})})),Ci=(e,t,r,n)=>{var i,o;return{...r,query:{q:e,enableQuerySyntax:null!==(o=null===(i=r.query)||void 0===i?void 0:i.enableQuerySyntax)&&void 0!==o&&o},search:{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],duration:t,response:n,results:n.results}}},qi=async(e,t,r,n)=>{n(fi({q:t}));const i=await wi(e,r(),xi(r()));return n(Er(t)),i},Ei=(e,t)=>{var r;return!0===(null===(r=e.didYouMean)||void 0===r?void 0:r.enableDidYouMean)&&0===t.results.length&&0!==t.queryCorrections.length},xi=e=>{var t;const r=function(e){var t;return function(e,t){const r={};e.forEach((e=>r[e.facetId]=e));const n=[];t.forEach((e=>{e in r&&(n.push(r[e]),delete r[e])}));const i=Object.values(r);return[...n,...i]}(function(e){return[...Ri(e.facetSet),...Ri(e.numericFacetSet),...Ri(e.dateFacetSet),...Ai(e.categoryFacetSet)]}(e),null!==(t=e.facetOrder)&&void 0!==t?t:[])}(e);return{accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,...e.configuration.analytics.enabled&&{visitorId:si()},...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.context&&{context:e.context.contextValues},...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},...r.length&&{facets:r},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.pagination&&{numberOfResults:e.pagination.numberOfResults,firstResult:e.pagination.firstResult},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.facetOptions&&{facetOptions:e.facetOptions},...(null===(t=e.folding)||void 0===t?void 0:t.enabled)&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange}}},Ii=e=>{var t,r,n,i;return{...xi(e),firstResult:(null!==(r=null===(t=e.pagination)||void 0===t?void 0:t.firstResult)&&void 0!==r?r:0)+(null!==(i=null===(n=e.search)||void 0===n?void 0:n.results.length)&&void 0!==i?i:0)}};function Ai(e){return Object.values(e||{}).map((e=>e.request))}function Ri(e={}){return Object.keys(e).map((t=>e[t]))}const ji=e=>{var t;e.configuration.analytics.enabled&&ui.addElement({name:"Query",value:(null===(t=e.query)||void 0===t?void 0:t.q)||"",time:JSON.stringify(new Date)})},ki=e=>{var t;return void 0!==(null===(t=e.query)||void 0===t?void 0:t.q)?e.query.q:""};Mt({enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:{correctedQuery:"",wordCorrections:[],originalQuery:""},originalQuery:""},(e=>{e.addCase(Cr,(e=>{e.enableDidYouMean=!0})).addCase(qr,(e=>{e.enableDidYouMean=!1})).addCase(Si.pending,(e=>{e.queryCorrection={correctedQuery:"",wordCorrections:[],originalQuery:""},e.wasAutomaticallyCorrected=!1,e.wasCorrectedTo=""})).addCase(Si.fulfilled,((e,t)=>{e.queryCorrection=t.payload.response.queryCorrections[0]||{correctedQuery:"",wordCorrections:[],originalQuery:""},e.originalQuery=t.payload.originalQuery,e.wasAutomaticallyCorrected=t.payload.automaticallyCorrected})).addCase(Er,((e,t)=>{e.wasCorrectedTo=t.payload}))}));const Pi=_t("facetOptions/update",(e=>Qt(e,{freezeFacetOrder:new W({required:!1})})));Mt({freezeFacetOrder:!1},(e=>{e.addCase(Pi,((e,t)=>({...e,...t.payload}))).addCase(Si.fulfilled,(e=>{e.freezeFacetOrder=!1})).addCase(Si.rejected,(e=>{e.freezeFacetOrder=!1})).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.facetOptions)&&void 0!==n?n:e}))}));const Ti=Nt,Fi={state:new z({required:!0}),numberOfResults:new B({required:!0,min:0}),value:new Z({required:!0,emptyAllowed:!0}),path:new te({required:!0,each:Nt}),moreValuesAvailable:new W({required:!1})};function _i(e){e.children.forEach((e=>{_i(e)})),Ht({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},Fi)}const Mi={facetId:Ti,field:Nt,delimitingCharacter:new Z({required:!1,emptyAllowed:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new z({required:!1}),basePath:new te({required:!1,each:Nt}),filterByBasePath:new W({required:!1})},Vi=_t("categoryFacet/register",(e=>Qt(e,Mi))),$i=_t("categoryFacet/toggleSelectValue",(e=>{try{return Ht(e.facetId,Nt),_i(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:zt(t)}}})),Di=_t("categoryFacet/deselectAll",(e=>Qt(e,Ti))),Li=_t("categoryFacet/updateNumberOfValues",(e=>Qt(e,{facetId:Ti,numberOfValues:new B({required:!0,min:1})}))),Ni=_t("categoryFacet/updateSortCriterion",(e=>Qt(e,{facetId:Ti,criterion:new z})));function Ui(e,t){const{facetId:r,criterion:n}=t,i=e[r];i&&(i.sortCriteria=n)}function zi(e){e&&(e.currentValues=e.currentValues.map((e=>({...e,state:"idle"}))),e.preventAutoSelect=!0)}function Hi(e,t){e&&(e.numberOfValues=t)}const Qi={facetId:Ti,captions:new G({options:{required:!1}}),numberOfValues:new B({required:!1,min:1}),query:new Z({required:!1,emptyAllowed:!0})},Bi={path:new te({required:!0,each:Nt}),displayValue:Ut,rawValue:Ut,count:new B({required:!0,min:0})},Yi=_t("categoryFacet/selectSearchResult",(e=>Qt(e,{facetId:Ti,value:new G({values:Bi})}))),Wi=_t("categoryFacetSearch/register",(e=>Qt(e,Qi))),Ji=_t("facet/deselectAllFacets");function Ki(e,t,r){e.currentValues=function(e,t){if(!e.length)return[];const r=Zi(e[0],t);let n=r;for(const r of e.splice(1)){const e=Zi(r,t);n.children.push(e),n=e}return n.state="selected",n.retrieveChildren=!0,[r]}(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function Zi(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}Mt({},(e=>{e.addCase(Vi,((e,t)=>{const r=t.payload,{facetId:n}=r;if(n in e)return;const i=(o=r,{...Xi,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...o});var o;const a=i.numberOfValues;e[n]={request:i,initialNumberOfValues:a}})).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.categoryFacetSet)&&void 0!==n?n:e})).addCase(fr,((e,t)=>{const r=t.payload.cf||{};Object.keys(e).forEach((t=>{Ki(e[t].request,r[t]||[],e[t].initialNumberOfValues)}))})).addCase(Ni,((e,t)=>{var r;const{facetId:n,criterion:i}=t.payload,o=null===(r=e[n])||void 0===r?void 0:r.request;o&&(o.sortCriteria=i)})).addCase($i,((e,t)=>{var r;const{facetId:n,selection:i,retrieveCount:o}=t.payload,a=null===(r=e[n])||void 0===r?void 0:r.request;if(!a)return;let s=a.currentValues;const{path:u}=i,c=u.slice(0,u.length-1);for(const e of c){const t=s[0];if(e!==t.value)return;t.retrieveChildren=!1,t.state="idle",s=t.children}if(s.length){const e=s[0];return e.retrieveChildren=!0,e.state="selected",void(e.children=[])}const l=function(e,t){const{value:r}=e;return{value:r,state:"selected",children:[],retrieveChildren:!0,retrieveCount:t}}(i,o);s.push(l),a.numberOfValues=1})).addCase(Di,((e,t)=>{Gi(e,t.payload)})).addCase(Ji,(e=>{Object.keys(e).forEach((t=>Gi(e,t)))})).addCase(Li,((e,t)=>{var r;const{facetId:n,numberOfValues:i}=t.payload,o=null===(r=e[n])||void 0===r?void 0:r.request;if(o)return o.currentValues.length?void function(e,t){var r;const{facetId:n,numberOfValues:i}=t;let o=null===(r=e[n])||void 0===r?void 0:r.request.currentValues[0];if(!o)return;for(;o.children.length&&"selected"!==(null==o?void 0:o.state);)o=o.children[0];o.retrieveCount=i}(e,t.payload):Hi(o,i)})).addCase(Yi,((e,t)=>{const{facetId:r,value:n}=t.payload,i=e[r];if(!i)return;const o=[...n.path,n.rawValue];Ki(i.request,o,i.initialNumberOfValues)})).addCase(Si.fulfilled,((e,t)=>{const{facets:r}=t.payload.response;r.forEach((t=>{var r;if(!function(e,t){return t.facetId in e}(e,t))return;const n=t.facetId,i=null===(r=e[n])||void 0===r?void 0:r.request;if(!i)return;const o=function(e,t){const r=Kn(e.currentValues).parents,n=Kn(t.values).parents;return r.length!==n.length}(i,t);i.currentValues=o?[]:i.currentValues,i.preventAutoSelect=!1}))}))}));const Xi={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0};function Gi(e,t){const r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function eo(e,t,r){const{facetId:n}=t;if(e[n])return;const i={...so,...t},o=r();e[n]={options:i,isLoading:!1,response:o,initialNumberOfValues:i.numberOfValues,requestId:""}}function to(e,t){const{facetId:r,...n}=t,i=e[r];i&&(i.options={...i.options,...n})}function ro(e,t,r){const n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function no(e,t){const r=e[t];r&&(r.isLoading=!1)}function io(e,t,r){const{facetId:n,response:i}=t,o=e[n];o&&o.requestId===r&&(o.isLoading=!1,o.response=i)}function oo(e,t,r){const{facetId:n}=t,i=e[n];i&&(i.requestId="",i.isLoading=!1,i.response=r(),i.options.numberOfValues=i.initialNumberOfValues,i.options.query=so.query)}function ao(e,t){Object.keys(e).forEach((r=>oo(e,{facetId:r},t)))}Mt([],(e=>{e.addCase(Si.fulfilled,((e,t)=>t.payload.response.facets.map((e=>e.facetId)))).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.facetOrder)&&void 0!==n?n:e}))}));const so={captions:{},numberOfValues:10,query:""},uo={facetId:Ti,value:new G({values:{displayValue:Ut,rawValue:Ut,count:new B({required:!0,min:0})}})},co=_t("facetSearch/register",(e=>Qt(e,Qi))),lo=_t("facetSearch/update",(e=>Qt(e,Qi))),fo=_t("facetSearch/toggleSelectValue",(e=>Qt(e,uo)));const po=e=>li("analytics/facet/search",ci.Search,((t,r)=>{Qt(e,Ti);const n=Xn(r),i=((e,t)=>{const r=ii(t,e),n=r?r.field:"";return{facetId:e,facetField:n,facetTitle:`${n}_${e}`}})(e,n);return t.logFacetSearch(i)}))(),ho=e=>{const t=[];let r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t},go=Lt("facetSearch/executeSearch",(async(e,{dispatch:t,getState:r,extra:{searchAPIClient:n,validatePayload:i}})=>{const o=r();let a;i(e,Nt),a=mo(o,e)?((e,t)=>{const{captions:r,query:n,numberOfValues:i}=t.facetSearchSet[e].options,{field:o,delimitingCharacter:a,currentValues:s}=t.facetSet[e],u=xi(t),c=s.filter((e=>"idle"!==e.state)).map((e=>e.value)),l=`*${n}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,captions:r,numberOfValues:i,query:l,field:o,delimitingCharacter:a,ignoreValues:c,searchContext:u,type:"specific"}})(e,o):((e,t)=>{const r=t.categoryFacetSearchSet[e].options,n=t.categoryFacetSet[e].request,{captions:i,query:o,numberOfValues:a}=r,{field:s,delimitingCharacter:u,basePath:c}=n,l=xi(t),d=ho(n),f=d.length?[d]:[],p=`*${o}*`;return{url:t.configuration.search.apiBaseUrl,accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,basePath:c,captions:i,numberOfValues:a,query:p,field:s,delimitingCharacter:u,ignorePaths:f,searchContext:l,type:"hierarchical"}})(e,o);const s=await n.facetSearch(a);return t(po(e)),{facetId:e,response:s}})),yo=_t("facetSearch/clearResults",(e=>Qt(e,{facetId:Ti}))),mo=(e,t)=>void 0!==e.facetSearchSet&&void 0!==e.facetSet&&void 0!==e.facetSet[t];function vo(){return{moreValuesAvailable:!1,values:[]}}function bo(){return{moreValuesAvailable:!1,values:[]}}Mt({},(e=>{e.addCase(Wi,((e,t)=>{eo(e,t.payload,vo)})).addCase(lo,((e,t)=>{to(e,t.payload)})).addCase(go.pending,((e,t)=>{ro(e,t.meta.arg,t.meta.requestId)})).addCase(go.rejected,((e,t)=>{no(e,t.meta.arg)})).addCase(go.fulfilled,((e,t)=>{io(e,t.payload,t.meta.requestId)})).addCase(yo,((e,{payload:{facetId:t}})=>{oo(e,{facetId:t},vo)})).addCase(Si.fulfilled,(e=>{ao(e,vo)}))})),Mt({},(e=>{e.addCase(co,((e,t)=>{eo(e,t.payload,bo)})).addCase(lo,((e,t)=>{to(e,t.payload)})).addCase(go.pending,((e,t)=>{ro(e,t.meta.arg,t.meta.requestId)})).addCase(go.rejected,((e,t)=>{no(e,t.meta.arg)})).addCase(go.fulfilled,((e,t)=>{io(e,t.payload,t.meta.requestId)})).addCase(yo,((e,{payload:t})=>{oo(e,t,bo)})).addCase(Si.fulfilled,(e=>{ao(e,bo)}))}));const wo={value:Nt,numberOfResults:new B({min:0}),state:Nt},So={facetId:Ti,field:new Z({required:!0,emptyAllowed:!0}),delimitingCharacter:new Z({required:!1,emptyAllowed:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new z({required:!1})},Oo=_t("facet/register",(e=>Qt(e,So))),Co=_t("facet/toggleSelectValue",(e=>Qt(e,{facetId:Ti,selection:new G({values:wo})}))),qo=_t("facet/deselectAll",(e=>Qt(e,Ti))),Eo=_t("facet/updateSortCriterion",(e=>Qt(e,{facetId:Ti,criterion:new z({required:!0})}))),xo=_t("facet/updateNumberOfValues",(e=>Qt(e,{facetId:Ti,numberOfValues:new B({required:!0,min:1})}))),Io=_t("facet/updateIsFieldExpanded",(e=>Qt(e,{facetId:Ti,isFieldExpanded:new W({required:!0})}))),Ao=_t("facet/updateFreezeCurrentValues",(e=>Qt(e,{facetId:Ti,freezeCurrentValues:new W({required:!0})})));Mt({},(e=>{e.addCase(Oo,((e,t)=>{const{facetId:r}=t.payload;var n;r in e||(e[r]=(n=t.payload,{...Ro,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...n}))})).addCase(ur.fulfilled,((e,t)=>{if(t.payload&&0!==Object.keys(t.payload.facetSet).length)return t.payload.facetSet})).addCase(fr,((e,t)=>{const r=t.payload.f||{};Object.keys(e).forEach((t=>{const n=e[t],i=r[t]||[];n.currentValues=i.map(ko),n.preventAutoSelect=!0,n.numberOfValues=Math.max(i.length,n.numberOfValues)}))})).addCase(Co,((e,t)=>{const{facetId:r,selection:n}=t.payload,i=e[r];if(!i)return;const o=i.currentValues.find((e=>e.value===n.value));if(!o)return;const a="selected"===o.state;o.state=a?"idle":"selected",i.freezeCurrentValues=!0,i.preventAutoSelect=!0})).addCase(Ao,((e,t)=>{const{facetId:r,freezeCurrentValues:n}=t.payload,i=e[r];i&&(i.freezeCurrentValues=n)})).addCase(qo,((e,t)=>{zi(e[t.payload])})).addCase(Ji,(e=>{Object.keys(e).forEach((t=>{zi(e[t])}))})).addCase(Eo,((e,t)=>{Ui(e,t.payload)})).addCase(xo,((e,t)=>{const{facetId:r,numberOfValues:n}=t.payload;Hi(e[r],n)})).addCase(Io,((e,t)=>{const{facetId:r,isFieldExpanded:n}=t.payload,i=e[r];i&&(i.isFieldExpanded=n)})).addCase(Si.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>{const r=t.facetId,n=e[r];n&&(n.currentValues=t.values.map(jo),n.freezeCurrentValues=!1,n.preventAutoSelect=!1)}))})).addCase(fo,((e,t)=>{const{facetId:r,value:n}=t.payload,i=e[r];if(!i)return;const{rawValue:o}=n,{currentValues:a}=i,s=a.find((e=>e.value===o));if(s)return void(s.state="selected");const u=ko(o),c=a.findIndex((e=>"idle"===e.state)),l=-1===c?a.length:c,d=a.slice(0,l),f=a.slice(l+1);i.currentValues=[...d,u,...f],i.numberOfValues=i.currentValues.length,i.freezeCurrentValues=!0,i.preventAutoSelect=!0}))}));const Ro={delimitingCharacter:">",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic"};function jo(e){const{value:t,state:r}=e;return{value:t,state:r}}function ko(e){return{value:e,state:"selected"}}var Po=n((function(e,t){e.exports=function(){var e=1e3,t=6e4,r=36e5,n="millisecond",i="second",o="minute",a="hour",s="day",u="week",c="month",l="quarter",d="year",f="date",p="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},v={s:m,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+m(n,2,"0")+":"+m(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),o=r-i<0,a=t.clone().add(n+(o?-1:1),c);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:u,d:s,D:f,h:a,m:o,s:i,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=y;var S=function(e){return e instanceof E},O=function(e,t,r){var n;if(!e)return b;if("string"==typeof e)w[e]&&(n=e),t&&(w[e]=t,n=e);else{var i=e.name;w[i]=e,n=i}return!r&&n&&(b=n),n||!r&&b},C=function(e,t){if(S(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new E(r)},q=v;q.l=O,q.i=S,q.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function y(e){this.$L=O(e.locale,null,!0),this.parse(e)}var m=y.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(q.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(h);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return q},m.isValid=function(){return!(this.$d.toString()===p)},m.isSame=function(e,t){var r=C(e);return this.startOf(t)<=r&&r<=this.endOf(t)},m.isAfter=function(e,t){return C(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<C(e)},m.$g=function(e,t,r){return q.u(e)?this[t]:this.set(r,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var r=this,n=!!q.u(t)||t,l=q.p(e),p=function(e,t){var i=q.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return n?i:i.endOf(s)},h=function(e,t){return q.w(r.toDate()[e].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},g=this.$W,y=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(l){case d:return n?p(1,0):p(31,11);case c:return n?p(1,y):p(0,y+1);case u:var b=this.$locale().weekStart||0,w=(g<b?g+7:g)-b;return p(n?m-w:m+(6-w),y);case s:case f:return h(v+"Hours",0);case a:return h(v+"Minutes",1);case o:return h(v+"Seconds",2);case i:return h(v+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var r,u=q.p(e),l="set"+(this.$u?"UTC":""),p=(r={},r[s]=l+"Date",r[f]=l+"Date",r[c]=l+"Month",r[d]=l+"FullYear",r[a]=l+"Hours",r[o]=l+"Minutes",r[i]=l+"Seconds",r[n]=l+"Milliseconds",r)[u],h=u===s?this.$D+(t-this.$W):t;if(u===c||u===d){var g=this.clone().set(f,1);g.$d[p](h),g.init(),this.$d=g.set(f,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](h);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[q.p(e)]()},m.add=function(n,l){var f,p=this;n=Number(n);var h=q.p(l),g=function(e){var t=C(p);return q.w(t.date(t.date()+Math.round(e*n)),p)};if(h===c)return this.set(c,this.$M+n);if(h===d)return this.set(d,this.$y+n);if(h===s)return g(1);if(h===u)return g(7);var y=(f={},f[o]=t,f[a]=r,f[i]=e,f)[h]||1,m=this.$d.getTime()+n*y;return q.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this;if(!this.isValid())return p;var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=q.z(this),i=this.$locale(),o=this.$H,a=this.$m,s=this.$M,u=i.weekdays,c=i.months,l=function(e,n,i,o){return e&&(e[n]||e(t,r))||i[n].substr(0,o)},d=function(e){return q.s(o%12||12,e,"0")},f=i.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},h={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:q.s(s+1,2,"0"),MMM:l(i.monthsShort,s,c,3),MMMM:l(c,s),D:this.$D,DD:q.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,u,2),ddd:l(i.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(o),HH:q.s(o,2,"0"),h:d(1),hh:d(2),a:f(o,a,!0),A:f(o,a,!1),m:String(a),mm:q.s(a,2,"0"),s:String(this.$s),ss:q.s(this.$s,2,"0"),SSS:q.s(this.$ms,3,"0"),Z:n};return r.replace(g,(function(e,t){return t||h[e]||n.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(n,f,p){var h,g=q.p(f),y=C(n),m=(y.utcOffset()-this.utcOffset())*t,v=this-y,b=q.m(this,y);return b=(h={},h[d]=b/12,h[c]=b,h[l]=b/3,h[u]=(v-m)/6048e5,h[s]=(v-m)/864e5,h[a]=v/r,h[o]=v/t,h[i]=v/e,h)[g]||v,p?b:q.a(b)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return w[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=O(e,t,!0);return n&&(r.$L=n),r},m.clone=function(){return q.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},y}(),x=E.prototype;return C.prototype=x,[["$ms",n],["$s",i],["$m",o],["$H",a],["$W",s],["$M",c],["$y",d],["$D",f]].forEach((function(e){x[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,E,C),e.$i=!0),C},C.locale=O,C.isDayjs=S,C.unix=function(e){return C(1e3*e)},C.en=w[b],C.Ls=w,C.p={},C}()}));const To={state:Nt,start:new B({required:!0}),end:new B({required:!0}),endInclusive:new W({required:!0}),numberOfResults:new B({required:!0,min:0})},Fo={start:Nt,end:Nt,endInclusive:new W({required:!0}),state:Nt,numberOfResults:new B({required:!0,min:0})};var _o=n((function(e,t){e.exports=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,i,o){var a=i.prototype;o.utc=function(e){return new i({date:e,utc:!0,args:arguments})},a.utc=function(t){var r=o(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},a.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var u=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var c=a.utcOffset;a.utcOffset=function(n,i){var o=this.$utils().u;if(o(n))return this.$u?0:o(this.$offset)?c.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var i=(""+n[0]).match(r)||["-",0,0],o=i[0],a=60*+i[1]+ +i[2];return 0===a?0:"+"===o?a:-a}(n)))return this;var a=Math.abs(n)<=16?60*n:n,s=this;if(i)return s.$offset=a,s.$u=0===n,s;if(0!==n){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+u,e)).$offset=a,s.$x.$localOffset=u}else s=this.utc();return s};var l=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||(new Date).getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=a.diff;a.diff=function(e,t,r){if(e&&this.$u===e.$u)return f.call(this,e,t,r);var n=this.local(),i=o(e).local();return f.call(n,i,t,r)}}}()})),Mo=n((function(e,t){e.exports=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,i=/\d*[^\s\d-_:/()]+/,o={},a=function(e){return function(t){this[e]=+t}},s=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],u=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},c=function(e,t){var r,n=o.meridiem;if(n){for(var i=1;i<=24;i+=1)if(e.indexOf(n(i,0,t))>-1){r=i>12;break}}else r=e===(t?"pm":"PM");return r},l={A:[i,function(e){this.afternoon=c(e,!1)}],a:[i,function(e){this.afternoon=c(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,a("seconds")],ss:[n,a("seconds")],m:[n,a("minutes")],mm:[n,a("minutes")],H:[n,a("hours")],h:[n,a("hours")],HH:[n,a("hours")],hh:[n,a("hours")],D:[n,a("day")],DD:[r,a("day")],Do:[i,function(e){var t=o.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,a("month")],MM:[r,a("month")],MMM:[i,function(e){var t=u("months"),r=(u("monthsShort")||t.map((function(e){return e.substr(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[i,function(e){var t=u("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,a("year")],YY:[r,function(e){e=+e,this.year=e+(e>68?1900:2e3)}],YYYY:[/\d{4}/,a("year")],Z:s,ZZ:s};function d(r){var n,i;n=r,i=o&&o.formats;for(var a=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var o=n&&n.toUpperCase();return r||i[n]||e[n]||i[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),s=a.length,u=0;u<s;u+=1){var c=a[u],d=l[c],f=d&&d[0],p=d&&d[1];a[u]=p?{regex:f,parser:p}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<s;r+=1){var i=a[r];if("string"==typeof i)n+=i.length;else{var o=i.regex,u=i.parser,c=e.substr(n),l=o.exec(c)[0];u.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,r){r.p.customParseFormat=!0;var n=t.prototype,i=n.parse;n.parse=function(e){var t=e.date,n=e.utc,a=e.args;this.$u=n;var s=a[1];if("string"==typeof s){var u=!0===a[2],c=!0===a[3],l=u||c,f=a[2];c&&(f=a[2]),o=this.$locale(),!u&&f&&(o=r.Ls[f]),this.$d=function(e,t,r){try{var n=d(t)(e),i=n.year,o=n.month,a=n.day,s=n.hours,u=n.minutes,c=n.seconds,l=n.milliseconds,f=n.zone,p=new Date,h=a||(i||o?1:p.getDate()),g=i||p.getFullYear(),y=0;i&&!o||(y=o>0?o-1:p.getMonth());var m=s||0,v=u||0,b=c||0,w=l||0;return f?new Date(Date.UTC(g,y,h,m,v,b,w+60*f.offset*1e3)):r?new Date(Date.UTC(g,y,h,m,v,b,w)):new Date(g,y,h,m,v,b,w)}catch(e){return new Date("")}}(t,s,n),this.init(),f&&!0!==f&&(this.$L=this.locale(f).$L),l&&t!==this.format(s)&&(this.$d=new Date("")),o={}}else if(s instanceof Array)for(var p=s.length,h=1;h<=p;h+=1){a[1]=s[h-1];var g=r.apply(this,a);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}h===p&&(this.$d=new Date(""))}else i.call(this,e)}}}()}));function Vo(e,t){const{dateFormat:r,useLocalTime:n}=t,i=Po(e,r);if(!i.isValid())throw new Error(`Could not parse the provided date "${e}".\n      Please provide a dateFormat string in the configuration options.\n      See https://day.js.org/docs/en/parse/string-format for more information.\n       `);return function(e){const t="YYYY/MM/DD@HH:mm:ss";return e.format(t)}(n?i:i.utc())}Po.extend(_o),Po.extend(Mo);const $o=_t("rangeFacet/updateSortCriterion",(e=>Qt(e,{facetId:Ti,criterion:new z({required:!0})}))),Do={start:Nt,end:Nt,endInclusive:new W({required:!0}),state:Nt},Lo={facetId:Ti,field:Nt,currentValues:new te({required:!1,each:new G({values:Do})}),generateAutomaticRanges:new W({required:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new z({required:!1}),rangeAlgorithm:new z({required:!1})};function No(e){e.currentValues&&e.currentValues.forEach((e=>{const{start:t,end:r}={start:Vo((n=e).start,n),end:Vo(n.end,n),endInclusive:null!==(i=n.endInclusive)&&void 0!==i&&i,state:null!==(o=n.state)&&void 0!==o?o:"idle"};var n,i,o;if(Po(t).isAfter(Po(r)))throw new Error(`The start value is greater than the end value for the date range ${e.start} to ${e.end}`)}))}const Uo=_t("dateFacet/register",(e=>{try{return Ht(e,Lo),No(e),{payload:e,error:null}}catch(t){return{payload:e,error:zt(t)}}})),zo=_t("dateFacet/toggleSelectValue",(e=>Qt(e,{facetId:Ti,selection:new G({values:Fo})}))),Ho=_t("dateFacet/updateFacetValues",(e=>{try{return Ht(e,{facetId:Ti,values:new te({each:new G({values:Fo})})}),No({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:zt(t)}}})),Qo=$o,Bo=qo,Yo={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even"};function Wo(e,t){const{facetId:r}=t;if(r in e)return;const n=ta(t);e[r]={...t,numberOfValues:n}}function Jo(e,t,r){const n=e[t];n&&(n.currentValues=r,n.numberOfValues=ta(n))}function Ko(e,t,r){const n=e[t];if(!n)return;const i=ea(n.currentValues,r);if(!i)return;const o="selected"===i.state;i.state=o?"idle":"selected",n.preventAutoSelect=!0}function Zo(e,t){const r=e[t];r&&r.currentValues.forEach((e=>e.state="idle"))}function Xo(e,t){Object.entries(e).forEach((([e,r])=>{const n=t[e]||[];r.currentValues.forEach((e=>{const t=!!ea(n,e);return e.state=t?"selected":"idle",e}));const i=n.filter((e=>!ea(r.currentValues,e))),o=r.currentValues;o.push(...i),r.numberOfValues=Math.max(r.numberOfValues,o.length)}))}function Go(e,t,r){t.forEach((t=>{const n=t.facetId,i=e[n];if(!i)return;const o=r(t.values);i.currentValues=o,i.preventAutoSelect=!1}))}function ea(e,t){const{start:r,end:n}=t;return e.find((e=>e.start===r&&e.end===n))}function ta(e){const{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}function ra(e){return e.map((e=>{const{numberOfResults:t,...r}=e;return r}))}Mt({},(e=>{e.addCase(Uo,((e,t)=>{const{payload:r}=t;var n;Wo(e,(n=r,{...Yo,currentValues:[],preventAutoSelect:!1,type:"dateRange",...n}))})).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.dateFacetSet)&&void 0!==n?n:e})).addCase(fr,((e,t)=>{Xo(e,t.payload.df||{})})).addCase(zo,((e,t)=>{const{facetId:r,selection:n}=t.payload;Ko(e,r,n)})).addCase(Ho,((e,t)=>{const{facetId:r,values:n}=t.payload;Jo(e,r,n)})).addCase(Bo,((e,t)=>{Zo(e,t.payload)})).addCase(Ji,(e=>{Object.keys(e).forEach((t=>{Zo(e,t)}))})).addCase(Qo,((e,t)=>{Ui(e,t.payload)})).addCase(Si.fulfilled,((e,t)=>{Go(e,t.payload.response.facets,ra)}))}));const na={state:Nt,start:new B({required:!0}),end:new B({required:!0}),endInclusive:new W({required:!0})},ia={facetId:Ti,field:Nt,currentValues:new te({required:!1,each:new G({values:na})}),generateAutomaticRanges:new W({required:!0}),filterFacetCount:new W({required:!1}),injectionDepth:new B({required:!1,min:0}),numberOfValues:new B({required:!1,min:1}),sortCriteria:new z({required:!1}),rangeAlgorithm:new z({required:!1})};function oa(e){e.currentValues&&e.currentValues.forEach((({start:e,end:t})=>{if(e>t)throw new Error(`The start value is greater than the end value for the numeric range ${e} to ${t}`)}))}const aa=_t("numericFacet/register",(e=>{try{return Qt(e,ia),oa(e),{payload:e,error:null}}catch(t){return{payload:e,error:zt(t)}}})),sa=_t("numericFacet/toggleSelectValue",(e=>Qt(e,{facetId:Ti,selection:new G({values:To})}))),ua=_t("numericFacet/updateFacetValues",(e=>{try{return Ht(e,{facetId:Ti,values:new te({each:new G({values:To})})}),oa({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:zt(t)}}})),ca=$o,la=qo;function da(e){return e.map((e=>{const{numberOfResults:t,...r}=e;return r}))}Mt({},(e=>{e.addCase(aa,((e,t)=>{const{payload:r}=t;var n;Wo(e,(n=r,{...Yo,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...n}))})).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.numericFacetSet)&&void 0!==n?n:e})).addCase(fr,((e,t)=>{Xo(e,t.payload.nf||{})})).addCase(sa,((e,t)=>{const{facetId:r,selection:n}=t.payload;Ko(e,r,n)})).addCase(ua,((e,t)=>{const{facetId:r,values:n}=t.payload;Jo(e,r,n)})).addCase(la,((e,t)=>{Zo(e,t.payload)})).addCase(Ji,(e=>{Object.keys(e).forEach((t=>{Zo(e,t)}))})).addCase(ca,((e,t)=>{Ui(e,t.payload)})).addCase(Si.fulfilled,((e,t)=>{Go(e,t.payload.response.facets,da)}))}));const fa=new te({each:Nt,required:!0}),pa=_t("fields/registerFieldsToInclude",(e=>Qt(e,fa))),ha={collectionField:new Z,parentField:new Z,childField:new Z,numberOfFoldedResults:new B({min:0})},ga=_t("folding/register",(e=>Qt(e,ha))),ya=Lt("folding/loadCollection",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const{folding:{fields:i},configuration:{accessToken:o,organizationId:a,search:{apiBaseUrl:s}}}=t(),u=await n.search({tab:"",referrer:"",accessToken:o,organizationId:a,url:s,aq:`@${i.collection} = ${e}`,numberOfResults:100});return ue(u)?r(u.error):{collectionId:e,results:u.success.results}}));function ma(e,t){return e.raw[t.parent]}function va(e,t){const r=e.raw[t.child];return n=r,Array.isArray(n)?r[0]:r;var n}function ba(e){return e.childResults?e.childResults.flatMap((e=>[e,...ba(e)])):[]}function wa(e,t,r,n=[]){const i=va(e,r);return i?-1!==n.indexOf(i)?[]:t.filter((t=>{const n=va(t,r)===va(e,r);return ma(t,r)===i&&!n})).map((e=>({result:e,children:wa(e,t,r,[...n,i])}))):[]}function Sa(e,t){return e.find((e=>{const r=void 0===ma(e,t),n=(i=ma(e,t),o=va(e,t),void 0!==(i||o)&&i===o);var i,o;return r||n}))}function Oa(e){const t=ba(e),r=[e,...t].filter((e=>e.parentResult)).map((e=>e.parentResult));var n,i;return n=[e,...t,...r],i=e=>e.uniqueId,Object.values(n.reduce(((e,t,r)=>({...e,[i(t,r)]:t})),{}))}function Ca(e,t){const r={};return e.forEach((e=>{const n=function(e,t){return e.raw[t.collection]}(e,t);n&&va(e,t)&&(r[n]=function(e,t){var r;const n=Oa(e),i=null!==(r=Sa(n,t))&&void 0!==r?r:e;return{result:i,children:wa(i,n,t),moreResultsAvailable:!0,isLoadingMoreResults:!1}}(e,t))})),r}Mt({fieldsToInclude:["author","language","urihash","objecttype","collection","source","permanentid"]},(e=>e.addCase(pa,((e,t)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(t.payload))]})).addCase(ga,((e,{payload:t})=>{var r,n,i;const o={collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"};e.fieldsToInclude.push(null!==(r=t.collectionField)&&void 0!==r?r:o.collection,null!==(n=t.parentField)&&void 0!==n?n:o.parent,null!==(i=t.childField)&&void 0!==i?i:o.child)})))),Mt({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}},(e=>e.addCase(Si.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?Ca(t.response.results,e.fields):{}})).addCase(Oi.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?{...e.collections,...Ca(t.response.results,e.fields)}:{}})).addCase(ga,((e,{payload:t})=>{var r,n,i,o;return e.enabled?e:{enabled:!0,collections:{},fields:{collection:null!==(r=t.collectionField)&&void 0!==r?r:e.fields.collection,parent:null!==(n=t.parentField)&&void 0!==n?n:e.fields.parent,child:null!==(i=t.childField)&&void 0!==i?i:e.fields.child},filterFieldRange:null!==(o=t.numberOfFoldedResults)&&void 0!==o?o:e.filterFieldRange}})).addCase(ya.pending,((e,{meta:t})=>{const r=t.arg;e.collections[r].isLoadingMoreResults=!0})).addCase(ya.rejected,((e,{meta:t})=>{const r=t.arg;e.collections[r].isLoadingMoreResults=!1})).addCase(ya.fulfilled,((e,{payload:{collectionId:t,results:r}})=>{const n=Sa(r,e.fields);n&&(e.collections[t]={result:n,children:wa(n,r,e.fields),moreResultsAvailable:!1,isLoadingMoreResults:!1})})))),n((function(e,t){!function(e){var t="function"==typeof WeakSet,r=Object.keys;function n(e,t){return e===t||e!=e&&t!=t}function i(e){return e.constructor===Object||null==e.constructor}function o(e){return!!e&&"function"==typeof e.then}function a(e){return!(!e||!e.$$typeof)}function s(){var e=[];return{add:function(t){e.push(t)},has:function(t){return-1!==e.indexOf(t)}}}var u=t?function(){return new WeakSet}:s;function c(e){return function(t){var r=e||t;return function(e,t,n){void 0===n&&(n=u());var i=!!e&&"object"==typeof e,o=!!t&&"object"==typeof t;if(i||o){var a=i&&n.has(e),s=o&&n.has(t);if(a||s)return a&&s;i&&n.add(e),o&&n.add(t)}return r(e,t,n)}}}function l(e,t,r,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!r(e[i],t[i],n))return!1;return!0}function d(e,t,r,n){var i=e.size===t.size;return i&&e.size&&e.forEach((function(e,o){i&&(i=!1,t.forEach((function(t,a){!i&&r(o,a,n)&&(i=r(e,t,n))})))})),i}var f="_owner",p=Function.prototype.bind.call(Function.prototype.call,Object.prototype.hasOwnProperty);function h(e,t,n,i){var o=r(e),s=o.length;if(r(t).length!==s)return!1;if(s)for(var u=void 0;s-- >0;){if((u=o[s])===f){var c=a(e),l=a(t);if((c||l)&&c!==l)return!1}if(!p(t,u)||!n(e[u],t[u],i))return!1}return!0}function g(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex}function y(e,t,r,n){var i=e.size===t.size;return i&&e.size&&e.forEach((function(e){i&&(i=!1,t.forEach((function(t){i||(i=r(e,t,n))})))})),i}var m="function"==typeof Map,v="function"==typeof Set;function b(e){var t="function"==typeof e?e(r):r;function r(e,r,a){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(i(e)&&i(r))return h(e,r,t,a);var s=Array.isArray(e),u=Array.isArray(r);return s||u?s===u&&l(e,r,t,a):(s=e instanceof Date,u=r instanceof Date,s||u?s===u&&n(e.getTime(),r.getTime()):(s=e instanceof RegExp,u=r instanceof RegExp,s||u?s===u&&g(e,r):o(e)||o(r)?e===r:m&&(s=e instanceof Map,u=r instanceof Map,s||u)?s===u&&d(e,r,t,a):v&&(s=e instanceof Set,u=r instanceof Set,s||u)?s===u&&y(e,r,t,a):h(e,r,t,a)))}return e!=e&&r!=r}return r}var w=b(),S=b((function(){return n})),O=b(c()),C=b(c(n));e.circularDeepEqual=O,e.circularShallowEqual=C,e.createCustomEqual=b,e.deepEqual=w,e.sameValueZeroEqual=n,e.shallowEqual=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)})).createCustomEqual((e=>(t,r)=>Array.isArray(t)&&Array.isArray(r)?t.length===r.length&&t.every((t=>-1!==r.findIndex((r=>e(t,r))))):e(t,r))),Mt(mi({}),(e=>{e.addCase(sr,((e,t)=>qa(e,t.payload)?void 0:t.payload))}));const qa=(e,t)=>Ea(e.context,t.context)&&ja(e.advancedSearchQueries,t.advancedSearchQueries)&&xa(e.facetSet,t.facetSet)&&xa(e.dateFacetSet,t.dateFacetSet)&&xa(e.numericFacetSet,t.numericFacetSet)&&Ia(e.categoryFacetSet,t.categoryFacetSet)&&Aa(e.pagination,t.pagination)&&Ra(e.query,t.query)&&ka(e,t)&&Pa(e.pipeline,t.pipeline)&&Ta(e.searchHub,t.searchHub)&&Fa(e.facetOrder,t.facetOrder)&&_a(e.debug,t.debug),Ea=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),xa=(e,t)=>{for(const[r,n]of Object.entries(t)){if(!e[r])return!1;const t=e[r].currentValues.filter((e=>"selected"===e.state)),i=n.currentValues.filter((e=>"selected"===e.state));if(JSON.stringify(t)!==JSON.stringify(i))return!1}return!0},Ia=(e,t)=>{var r;for(const[n,i]of Object.entries(t)){if(!e[n])return!1;const t=Kn(null===(r=e[n])||void 0===r?void 0:r.request.currentValues).parents.map((({value:e})=>e)),o=Kn(null==i?void 0:i.request.currentValues).parents.map((({value:e})=>e));if(JSON.stringify(t)!==JSON.stringify(o))return!1}return!0},Aa=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,Ra=(e,t)=>JSON.stringify(e)===JSON.stringify(t),ja=(e,t)=>JSON.stringify(e)===JSON.stringify(t),ka=(e,t)=>e.sortCriteria===t.sortCriteria,Pa=(e,t)=>e===t,Ta=(e,t)=>e===t,Fa=(e,t)=>{return n=t,(r=e).length===n.length&&-1===r.findIndex(((e,t)=>n[t]!==e));var r,n},_a=(e,t)=>e===t,Ma=new B({required:!0,min:0}),Va=_t("pagination/registerNumberOfResults",(e=>Qt(e,Ma))),$a=_t("pagination/updateNumberOfResults",(e=>Qt(e,Ma))),Da=_t("pagination/registerPage",(e=>Qt(e,Ma))),La=_t("pagination/updatePage",(e=>Qt(e,Ma))),Na=_t("pagination/nextPage"),Ua=_t("pagination/previousPage");function za(e){e.firstResult=0}function Ha(e){const{firstResult:t,numberOfResults:r}=e;return function(e,t){return e/t+1}(t,r)}function Qa(e,t){return(e-1)*t}Mt({firstResult:0,numberOfResults:10,totalCountFiltered:0},(e=>{e.addCase(Va,((e,t)=>{const r=Ha(e),n=t.payload;e.numberOfResults=n,e.firstResult=Qa(r,n)})).addCase($a,((e,t)=>{e.numberOfResults=t.payload,e.firstResult=0})).addCase(Da,((e,t)=>{const r=t.payload;e.firstResult=Qa(r,e.numberOfResults)})).addCase(La,((e,t)=>{const r=t.payload;e.firstResult=Qa(r,e.numberOfResults)})).addCase(Ua,(e=>{const t=Ha(e),r=Math.max(t-1,1);e.firstResult=Qa(r,e.numberOfResults)})).addCase(Na,(e=>{const t=Ha(e),r=function(e){const{totalCountFiltered:t,numberOfResults:r}=e;return function(e,t){const r=Math.min(e,1e3);return Math.ceil(r/t)}(t,r)}(e),n=Math.min(t+1,r);e.firstResult=Qa(n,e.numberOfResults)})).addCase(ur.fulfilled,((e,t)=>{t.payload&&(e.numberOfResults=t.payload.pagination.numberOfResults,e.firstResult=t.payload.pagination.firstResult)})).addCase(fr,((e,t)=>{var r,n;e.firstResult=null!==(r=t.payload.firstResult)&&void 0!==r?r:e.firstResult,e.numberOfResults=null!==(n=t.payload.numberOfResults)&&void 0!==n?n:e.numberOfResults})).addCase(Si.fulfilled,((e,t)=>{const{response:r}=t.payload;e.totalCountFiltered=r.totalCountFiltered})).addCase(qo,(e=>{za(e)})).addCase(Co,(e=>{za(e)})).addCase(Di,(e=>{za(e)})).addCase($i,(e=>{za(e)})).addCase(Yi,(e=>{za(e)})).addCase(zo,(e=>{za(e)})).addCase(sa,(e=>{za(e)})).addCase(Ji,(e=>{za(e)})).addCase(Ho,(e=>{za(e)})).addCase(ua,(e=>{za(e)})).addCase(fo,(e=>{za(e)}))}));const Ba=_t("pipeline/set",(e=>Qt(e,new Z({required:!0,emptyAllowed:!0}))));Mt("default",(e=>{e.addCase(Ba,((e,t)=>t.payload)).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.pipeline)&&void 0!==n?n:e})).addCase(Xt,((e,t)=>t.payload.pipeline||e))}));const Ya=["permanentid","ec_name","ec_brand","ec_category","ec_price","ec_promo_price","ec_shortdesc","ec_thumbnails","ec_images","ec_in_stock","ec_rating"];class Wa{constructor(e){this.state=e,this.initialState={id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0}}getLanguage(){return Jn(this.state)}getSearchEventRequestPayload(){return{queryText:"",responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getBaseMetadata(){var e;return{recommendation:(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.id)||this.initialState.id}}getSearchUID(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.searchUid)||this.initialState.searchUid}getPipeline(){return""}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2||"default"}getOriginLevel3(){return this.state.configuration.analytics.originLevel3||"default"}mapResultsToAnalyticsDocument(){return[]}get responseTime(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.duration)||this.initialState.duration}get numberOfResults(){var e;return(null===(e=this.state.productRecommendations)||void 0===e?void 0:e.recommendations.length)||this.initialState.recommendations.length}}const Ja=li("analytics/productrecommendations/load",ci.Search,(e=>e.logRecommendationInterfaceLoad()),(e=>new Wa(e))),Ka=_t("productrecommendations/setId",(e=>Qt(e,{id:Nt}))),Za=_t("productrecommendations/setSku",(e=>Qt(e,{skus:new te({required:!0,min:1,each:new Z({emptyAllowed:!1})})}))),Xa=_t("productrecommendations/setBrand",(e=>Qt(e,{brand:new Z({required:!0,emptyAllowed:!0})}))),Ga=_t("productrecommendations/setCategory",(e=>Qt(e,{category:new Z({required:!0,emptyAllowed:!0})}))),es=_t("productrecommendations/setAdditionalFields",(e=>Qt(e,{additionalFields:new te({required:!0,each:new Z({emptyAllowed:!1})})}))),ts=_t("productrecommendations/setMaxNumberOfRecommendations",(e=>Qt(e,{number:new B({required:!0,max:50,min:1})}))),rs=Lt("productrecommendations/get",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const i=t(),o=(new Date).getTime(),a=await n.productRecommendations(is(i)),s=(new Date).getTime()-o;if(ue(a))return r(a.error);const u=i.productRecommendations.additionalFields||[];return{recommendations:a.success.results.map((e=>ns(e,{additionalFields:u}))),analyticsAction:Ja(),searchUid:a.success.searchUid,duration:s}})),ns=(e,{additionalFields:t})=>{const r=e.raw.ec_price,n=e.raw.ec_promo_price,i=e.raw.ec_in_stock;return{permanentid:e.raw.permanentid,clickUri:e.clickUri,ec_name:e.raw.ec_name,ec_brand:e.raw.ec_brand,ec_category:e.raw.ec_category,ec_price:r,ec_shortdesc:e.raw.ec_shortdesc,ec_thumbnails:e.raw.ec_thumbnails,ec_images:e.raw.ec_images,ec_promo_price:void 0===n||void 0!==r&&n>=r?void 0:n,ec_in_stock:void 0===i?void 0:"yes"===i.toLowerCase()||"true"===i.toLowerCase(),ec_rating:e.raw.ec_rating,additionalFields:t.reduce(((t,r)=>({...t,[r]:e.raw[r]})),{})}},is=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,...e.configuration.analytics.enabled&&{visitorId:si()},recommendation:e.productRecommendations.id,numberOfResults:e.productRecommendations.maxNumberOfRecommendations,fieldsToInclude:[...Ya,...e.productRecommendations.additionalFields||[]],mlParameters:{...e.productRecommendations.skus&&e.productRecommendations.skus.length>0&&{itemIds:e.productRecommendations.skus},...e.productRecommendations.filter.brand&&{brandFilter:e.productRecommendations.filter.brand},...e.productRecommendations.filter.category&&{categoryFilter:e.productRecommendations.filter.category}},actionsHistory:e.configuration.analytics.enabled?ui.getHistory():[],...e.context&&{context:e.context.contextValues},...e.searchHub&&{searchHub:e.searchHub}}),os=Mt({id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0},(e=>{e.addCase(Ka,((e,t)=>{e.id=t.payload.id})).addCase(Za,((e,t)=>{e.skus=t.payload.skus})).addCase(Xa,((e,t)=>{e.filter.brand=t.payload.brand})).addCase(Ga,((e,t)=>{e.filter.category=t.payload.category})).addCase(ts,((e,t)=>{e.maxNumberOfRecommendations=t.payload.number})).addCase(es,((e,t)=>{e.additionalFields=t.payload.additionalFields})).addCase(rs.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(rs.fulfilled,((e,t)=>{e.error=null,e.searchUid=t.payload.searchUid,e.recommendations=t.payload.recommendations,e.isLoading=!1})).addCase(rs.pending,(e=>{e.isLoading=!0}))})),as={id:Nt,query:Ut},ss=_t("querySet/register",(e=>Qt(e,as))),us=_t("querySet/update",(e=>Qt(e,as))),cs={id:Nt},ls=_t("querySuggest/register",(e=>Qt(e,{...cs,q:new Z,count:new B({min:0})}))),ds=_t("querySuggest/unregister",(e=>Qt(e,cs))),fs=_t("querySuggest/selectSuggestion",(e=>Qt(e,{...cs,expression:Ut}))),ps=_t("querySuggest/clear",(e=>Qt(e,cs))),hs=Lt("querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n,validatePayload:i}})=>{i(e,cs);const o=e.id,a=await n.querySuggest(gs(o,t()));return ue(a)?r({id:o,...a.error}):{id:o,...a.success}})),gs=(e,t)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl,count:t.querySuggest[e].count,q:t.querySuggest[e].q,locale:t.configuration.search.locale,actionsHistory:t.configuration.analytics.enabled?ui.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub}});Mt({},(e=>{e.addCase(ss,((e,t)=>{const{id:r,query:n}=t.payload;r in e||(e[r]=n)})).addCase(us,((e,t)=>{const{id:r,query:n}=t.payload;ys(e,r,n)})).addCase(fs,((e,t)=>{const{id:r,expression:n}=t.payload;ys(e,r,n)})).addCase(Si.fulfilled,((e,t)=>{const{queryExecuted:r}=t.payload;Object.keys(e).forEach((t=>e[t]=r))})).addCase(ur.fulfilled,((e,t)=>{if(t.payload)for(const[r,n]of Object.entries(t.payload.querySet))ys(e,r,n)}))}));const ys=(e,t,r)=>{t in e&&(e[t]=r)};Mt({},(e=>e.addCase(ls,((e,t)=>{e[t.payload.id]={id:"",completions:[],count:5,q:"",currentRequestId:"",error:null,partialQueries:[],...t.payload}})).addCase(ds,((e,t)=>{delete e[t.payload.id]})).addCase(hs.pending,((e,t)=>{e[t.meta.arg.id].currentRequestId=t.meta.requestId})).addCase(hs.fulfilled,((e,t)=>{var r;const n=t.meta.arg.id;if(t.meta.requestId===(null===(r=e[n])||void 0===r?void 0:r.currentRequestId)){const{q:r}=e[n];r&&e[n].partialQueries.push(r.replace(/;/,encodeURIComponent(";"))),e[n].completions=t.payload.completions}})).addCase(hs.rejected,((e,t)=>{e[t.payload.id].error=t.payload})).addCase(us,((e,t)=>{const{id:r,query:n}=t.payload;r in e&&(e[r].q=n)})).addCase(ps,((e,t)=>{const{id:r}=t.payload;e[r].q="",e[r].completions=[],e[r].partialQueries=[]})).addCase(fs,((e,t)=>{const{id:r,expression:n}=t.payload;e[r].q=n})))),Mt({q:"",enableQuerySyntax:!1},(e=>e.addCase(fi,((e,t)=>({...e,...t.payload}))).addCase(Er,((e,t)=>{e.q=t.payload})).addCase(fs,((e,t)=>{e.q=t.payload.expression})).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.query)&&void 0!==n?n:e})).addCase(fr,((e,t)=>{var r,n;e.q=null!==(r=t.payload.q)&&void 0!==r?r:e.q,e.enableQuerySyntax=null!==(n=t.payload.enableQuerySyntax)&&void 0!==n?n:e.enableQuerySyntax}))));const ms=()=>new G({values:{documentId:new G({values:{contentIdKey:new Z({required:!0,emptyAllowed:!1}),contentIdValue:new Z({required:!0,emptyAllowed:!1})}})},options:{required:!0}}),vs=_t("smartSnippet/expand"),bs=_t("smartSnippet/collapse"),ws=_t("smartSnippet/like"),Ss=_t("smartSnippet/dislike"),Os=_t("smartSnippet/related/expand",(e=>Qt(e,ms()))),Cs=_t("smartSnippet/related/collapse",(e=>Qt(e,ms()))),qs=(e,t)=>e.findIndex((e=>e.contentIdValue===t.contentIdValue&&e.contentIdKey===t.contentIdKey));Mt({liked:!1,disliked:!1,expanded:!1,relatedQuestions:[]},(e=>e.addCase(vs,(e=>{e.expanded=!0})).addCase(bs,(e=>{e.expanded=!1})).addCase(ws,(e=>{e.liked=!0,e.disliked=!1})).addCase(Ss,(e=>{e.liked=!1,e.disliked=!0})).addCase(Si.fulfilled,((e,t)=>{e.relatedQuestions=t.payload.response.questionAnswer.relatedQuestions.map((e=>({contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1})))})).addCase(Os,((e,t)=>{const r=qs(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!0)})).addCase(Cs,((e,t)=>{const r=qs(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!1)}))));const Es=li("analytics/recommendation/update",ci.Search,(e=>e.logRecommendationInterfaceLoad())),xs=_t("recommendation/set",(e=>Qt(e,{id:Nt}))),Is=Lt("recommendation/get",(async(e,{getState:t,rejectWithValue:r,extra:{searchAPIClient:n}})=>{const i=t(),o=(new Date).getTime(),a=await n.recommendations(As(i)),s=(new Date).getTime()-o;return ue(a)?r(a.error):{recommendations:a.success.results,analyticsAction:Es(),duration:s,searchUid:a.success.searchUid}})),As=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,recommendation:e.recommendation.id,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,actionsHistory:e.configuration.analytics.enabled?ui.getHistory():[],...e.advancedSearchQueries&&{aq:e.advancedSearchQueries.aq,cq:e.advancedSearchQueries.cq},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.context&&{context:e.context.contextValues},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude}});function Rs(e){return"notify"===e.type}function js(e){return"redirect"===e.type}function ks(e){return"query"===e.type}function Ps(e){return"execute"===e.type}Mt({duration:0,error:null,isLoading:!1,id:"Recommendation",recommendations:[],searchUid:""},(e=>{e.addCase(xs,((e,t)=>{e.id=t.payload.id})).addCase(Is.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(Is.fulfilled,((e,t)=>{e.error=null,e.recommendations=t.payload.recommendations,e.duration=t.payload.duration,e.isLoading=!1,e.searchUid=t.payload.searchUid})).addCase(Is.pending,(e=>{e.isLoading=!0}))}));class Ts{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){const e=this.response.preprocessingOutput.triggers.filter(js);return e.length?e[0].content:null}}const Fs=li("analytics/redirection",ci.Search,((e,t)=>{var r;if(null===(r=t.redirection)||void 0===r?void 0:r.redirectTo)return e.logTriggerRedirect({redirectedTo:t.redirection.redirectTo})})),_s=Lt("redirection/check",(async(e,{dispatch:t,getState:r,rejectWithValue:n,extra:{searchAPIClient:i,validatePayload:o}})=>{o(e,{defaultRedirectionUrl:new Z({emptyAllowed:!1,url:!0})});const a=await i.plan(Ms(r()));if(ue(a))return n(a.error);const s=new Ts(a.success).redirectionUrl;return s&&t(Fs()),s||e.defaultRedirectionUrl})),Ms=e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub}});Mt({redirectTo:null},(e=>e.addCase(_s.fulfilled,((e,t)=>{e.redirectTo=t.payload}))));const Vs=Lt("resultPreview/fetchResultContent",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{const i=function(e,t){var r;const{search:n,accessToken:i,organizationId:o}=e.configuration,a=(null===(r=e.query)||void 0===r?void 0:r.q)||"";return{url:n.apiBaseUrl,accessToken:i,organizationId:o,enableNavigation:!1,q:a,...t,requestedOutputSize:t.requestedOutputSize||0}}(r(),e),o=await t.searchAPIClient.html(i);return ue(o)?n(o.error):{content:o.success,uniqueId:e.uniqueId}}));Mt({uniqueId:"",content:"",isLoading:!1},(e=>{e.addCase(Vs.pending,(e=>{e.isLoading=!0})).addCase(Vs.fulfilled,((e,t)=>{const{content:r,uniqueId:n}=t.payload;e.content=r,e.uniqueId=n,e.isLoading=!1}))}));const $s=_t("searchHub/set",(e=>Qt(e,new Z({required:!0,emptyAllowed:!0})))),Ds=Mt("default",(e=>{e.addCase($s,((e,t)=>t.payload)).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.searchHub)&&void 0!==n?n:e})).addCase(Xt,((e,t)=>t.payload.searchHub||e))}));function Ls(e,t){e.error=t.payload?t.payload:null,e.isLoading=!1}function Ns(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function Us(e){e.isLoading=!0}Mt({response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[]},(e=>{e.addCase(Si.rejected,Ls),e.addCase(Oi.rejected,Ls),e.addCase(Si.fulfilled,((e,t)=>{Ns(e,t),e.results=t.payload.response.results})),e.addCase(Oi.fulfilled,((e,t)=>{Ns(e,t),e.results=[...e.results,...t.payload.response.results]})),e.addCase(Si.pending,Us),e.addCase(Oi.pending,Us)}));const zs={by:new class{constructor(e){this.config=e,this.value=new z(e)}validate(e){const t=this.value.validate(e);return null!==t?t:H(e)||Object.values(this.config.enum).find((t=>t===e))?null:"value is not in enum."}get default(){return this.value.default}get required(){return this.value.required}}({enum:hi,required:!0})},Hs=_t("sortCriteria/register",(e=>Bs(e))),Qs=_t("sortCriteria/update",(e=>Bs(e))),Bs=e=>re(e)?(e.forEach((e=>Qt(e,zs))),{payload:e}):Qt(e,zs);Mt(yi(),(e=>{e.addCase(Hs,((e,t)=>gi(t.payload))).addCase(Qs,((e,t)=>gi(t.payload))).addCase(ur.fulfilled,((e,t)=>{var r,n;return null!==(n=null===(r=t.payload)||void 0===r?void 0:r.sortCriteria)&&void 0!==n?n:e})).addCase(fr,((e,t)=>{var r;return null!==(r=t.payload.sortCriteria)&&void 0!==r?r:e}))}));Mt({redirectTo:"",query:"",execute:{functionName:"",params:[]},notification:""},(e=>e.addCase(Si.fulfilled,((e,t)=>{const r=t.payload.response.triggers.filter(js);e.redirectTo=r.length?r[0].content:"";const n=t.payload.response.triggers.filter(ks);e.query=n.length?n[0].content:"";const i=t.payload.response.triggers.filter(Ps);e.execute=i.length?{functionName:i[0].content.name,params:i[0].content.params}:{functionName:"",params:[]};const o=t.payload.response.triggers.filter(Rs);e.notification=o.length?o[0].content:""}))));const Ys=pr,Ws=br,Js=Ds,Ks=os;function Zs(e,t){let r=0;const n=function(e,t,r){var n,i,o;void 0===t&&(t=50),void 0===r&&(r={});var a=null!=(n=r.isImmediate)&&n,s=null!=(i=r.callback)&&i,u=r.maxWait,c=Date.now(),l=[];function d(){if(void 0!==u){var e=Date.now()-c;if(e+t>=u)return u-e}return t}var f=function(){var t=[].slice.call(arguments),r=this;return new Promise((function(n,i){var u=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,c=Date.now(),!a){var n=e.apply(r,t);s&&s(n),l.forEach((function(e){return(0,e.resolve)(n)})),l=[]}}),d()),u){var f=e.apply(r,t);return s&&s(f),n(f)}l.push({resolve:n,reject:i})}))};return f.cancel=function(e){void 0!==o&&clearTimeout(o),l.forEach((function(t){return(0,t.reject)(e)})),l=[]},f}((()=>r=0),500);return i=>o=>async a=>{if(!("function"==typeof a))return o(a);const s=await o(a);if(!function(e){var t;return(null===(t=e.error)||void 0===t?void 0:t.name)===(new k).name}(s))return s;if("function"!=typeof t)return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),s;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),s;r++,n();const u=await async function(e){try{return await e()}catch(e){return""}}(t);i.dispatch(Zt({accessToken:u})),i.dispatch(a)}}const Xs=e=>t=>r=>{var n,i;const o=null===(n=r.payload)||void 0===n?void 0:n.analyticsAction;void 0!==o&&(null===(i=r.payload)||void 0===i||delete i.analyticsAction);const a=t(r);return r.type===Si.fulfilled.type&&void 0===o&&console.error("No analytics action associated with search:",r),r.type===Is.fulfilled&&void 0===o&&console.error("No analytics action associated with recommendation:",r),r.type===rs.fulfilled&&void 0===o&&console.error("No analytics action associated with product recommendation:",r),void 0!==o&&e.dispatch(o),a},Gs={configuration:Ys,version:Or};function eu(e,t){const r=function(e,t){const{reducers:r}=e,n=function(e){const t={...e};return{get combinedReducer(){return gt(t)},add(e){Object.keys(e).filter((e=>!(e in t))).forEach((r=>t[r]=e[r]))}}}({...Gs,...r}),i=t.logger,o=function(e,t,r){const{preloadedState:n,configuration:i}=e,o=i.name||"coveo-headless",a=function(e,t){const{renewAccessToken:r}=e.configuration;return[Zs(t,r),ir(t),Xs].concat(e.middlewares||[])}(e,t.logger);return function({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:i}){return Ft({reducer:e,preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e,name:i},middleware:e=>{return[...r,...e({thunk:{extraArgument:n}}),(t=n.logger,e=>r=>n=>(t.debug({action:n,nextState:e.getState()},"Action dispatched: "+n.type),r(n)))];var t}})}({preloadedState:n,reducer:r.combinedReducer,middlewares:a,thunkExtraArguments:t,name:o})}(e,t,n);return{addReducers(e){n.add(e),o.replaceReducer(n.combinedReducer)},dispatch:o.dispatch,subscribe:o.subscribe,enableAnalytics(){o.dispatch(tr())},disableAnalytics(){o.dispatch(er())},get state(){return o.getState()},logger:i,store:o}}(e,t),{accessToken:n,organizationId:i,platformUrl:o,analytics:a}=e.configuration;if(r.dispatch(Zt({accessToken:n,organizationId:i,platformUrl:o})),a){const{analyticsClientMiddleware:e,...t}=a;r.dispatch(Gt(t))}return r}function tu(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}var ru=function(e,t,r){var n=r&&r.stringify||tu;if("object"==typeof e&&null!==e){var i=t.length+1;if(1===i)return e;var o=new Array(i);o[0]=n(e);for(var a=1;a<i;a++)o[a]=n(t[a]);return o.join(" ")}if("string"!=typeof e)return e;var s=t.length;if(0===s)return e;for(var u="",c=0,l=-1,d=e&&e.length||0,f=0;f<d;){if(37===e.charCodeAt(f)&&f+1<d){switch(l=l>-1?l:0,e.charCodeAt(f+1)){case 100:case 102:if(c>=s)break;if(l<f&&(u+=e.slice(l,f)),null==t[c])break;u+=Number(t[c]),l=f+=2;break;case 105:if(c>=s)break;if(l<f&&(u+=e.slice(l,f)),null==t[c])break;u+=Math.floor(Number(t[c])),l=f+=2;break;case 79:case 111:case 106:if(c>=s)break;if(l<f&&(u+=e.slice(l,f)),void 0===t[c])break;var p=typeof t[c];if("string"===p){u+="'"+t[c]+"'",l=f+2,f++;break}if("function"===p){u+=t[c].name||"<anonymous>",l=f+2,f++;break}u+=n(t[c]),l=f+2,f++;break;case 115:if(c>=s)break;l<f&&(u+=e.slice(l,f)),u+=String(t[c]),l=f+2,f++;break;case 37:l<f&&(u+=e.slice(l,f)),u+="%",l=f+2,f++,c--}++c}++f}if(-1===l)return e;l<d&&(u+=e.slice(l));return u};var nu=au;const iu=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},ou={mapHttpRequest:hu,mapHttpResponse:hu,wrapRequestSerializer:gu,wrapResponseSerializer:gu,wrapErrorSerializer:gu,req:hu,res:hu,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}};function au(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");const r=e.browser.write||iu;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=function(e,t){if(Array.isArray(e))return e.filter((function(e){return"!stdSerializers.err"!==e}));return!0===e&&Object.keys(t)}(e.browser.serialize,n);let o=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);"function"==typeof r&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),!1===e.enabled&&(e.level="silent");const a=e.level||"info",s=Object.create(r);s.log||(s.log=yu),Object.defineProperty(s,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(s,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,su(u,s,"error","log"),su(u,s,"fatal","error"),su(u,s,"warn","error"),su(u,s,"info","log"),su(u,s,"debug","log"),su(u,s,"trace","log")}});const u={transmit:t,serialize:i,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:pu(e)};return s.levels=au.levels,s.level=a,s.setMaxListeners=s.getMaxListeners=s.emit=s.addListener=s.on=s.prependListener=s.once=s.prependOnceListener=s.removeListener=s.removeAllListeners=s.listeners=s.listenerCount=s.eventNames=s.write=s.flush=yu,s.serializers=n,s._serialize=i,s._stdErrSerialize=o,s.child=function(r){if(!r)throw new Error("missing bindings for child Pino");const o=r.serializers;if(i&&o){var a=Object.assign({},n,o),s=!0===e.browser.serialize?Object.keys(a):i;delete r.serializers,cu([r],s,a,this._stdErrSerialize)}function u(e){this._childLevel=1+(0|e._childLevel),this.error=lu(e,r,"error"),this.fatal=lu(e,r,"fatal"),this.warn=lu(e,r,"warn"),this.info=lu(e,r,"info"),this.debug=lu(e,r,"debug"),this.trace=lu(e,r,"trace"),a&&(this.serializers=a,this._serialize=s),t&&(this._logEvent=fu([].concat(e._logEvent.bindings,r)))}return u.prototype=this,new u(this)},t&&(s._logEvent=fu()),s}function su(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?yu:i[r]?i[r]:iu[r]||iu[n]||yu,function(e,t,r){if(!e.transmit&&t[r]===yu)return;t[r]=(n=t[r],function(){const i=e.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===iu?iu:this;for(var s=0;s<o.length;s++)o[s]=arguments[s];if(e.serialize&&!e.asObject&&cu(o,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(a,uu(this,r,o,i)):n.apply(a,o),e.transmit){const n=e.transmit.level||t.level,a=au.levels.values[n],s=au.levels.values[r];if(s<a)return;du(this,{ts:i,methodLevel:r,methodValue:s,transmitLevel:n,transmitValue:au.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},o)}});var n}(e,t,r)}function uu(e,t,r,n){e._serialize&&cu(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let o=i[0];const a={};n&&(a.time=n),a.level=au.levels.values[t];let s=1+(0|e._childLevel);if(s<1&&(s=1),null!==o&&"object"==typeof o){for(;s--&&"object"==typeof i[0];)Object.assign(a,i.shift());o=i.length?ru(i.shift(),i):void 0}else"string"==typeof o&&(o=ru(i.shift(),i));return void 0!==o&&(a.msg=o),a}function cu(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=au.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(const n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function lu(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function du(e,t,r){const n=t.send,i=t.ts,o=t.methodLevel,a=t.methodValue,s=t.val,u=e._logEvent.bindings;cu(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return-1===u.indexOf(e)})),e._logEvent.level.label=o,e._logEvent.level.value=a,n(o,e._logEvent,s),e._logEvent=fu(u)}function fu(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function pu(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?mu:vu}function hu(){return{}}function gu(e){return e}function yu(){}function mu(){return!1}function vu(){return Date.now()}function bu(t,r){return{analyticsClientMiddleware:function(e){const{analytics:t}=e,r=(e,t)=>t;return(null==t?void 0:t.analyticsClientMiddleware)||r}(t),validatePayload:Ht,preprocessRequest:function(t){return t.preprocessRequest||e}(t),logger:r}}au.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},au.stdSerializers=ou,au.stdTimeFunctions=Object.assign({},{nullTime:mu,epochTime:vu,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}});const wu={organizationId:Nt,accessToken:Nt,platformUrl:new Z({required:!1,emptyAllowed:!1}),name:new Z({required:!1,emptyAllowed:!1}),analytics:new G({options:{required:!1},values:{enabled:new W({required:!1}),originLevel2:new Z({required:!1}),originLevel3:new Z({required:!1})}})};const Su=new U({...wu,searchHub:new Z({required:!1,emptyAllowed:!1})});function Ou(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",searchHub:"default"}}const Cu={searchHub:Js,productRecommendations:Ks};function qu(t){const r=function(e){return nu({name:"@coveo/headless",level:(null==e?void 0:e.level)||"warn",formatters:{log:null==e?void 0:e.logFormatter},browser:{transmit:{send:(null==e?void 0:e.browserPostLogHook)||(()=>{})}}})}(t.loggerOptions);!function(e,t){try{Su.validate(e)}catch(e){throw t.error(e,"Product Recommendation engine configuration error"),e}}(t.configuration,r);const n=function(t,r){return new ne({logger:r,preprocessRequest:t.preprocessRequest||e,postprocessSearchResponseMiddleware:de,postprocessFacetSearchResponseMiddleware:fe,postprocessQuerySuggestResponseMiddleware:pe})}(t.configuration,r),i={...bu(t.configuration,r),searchAPIClient:n},o=eu({...t,reducers:Cu},i),{searchHub:a}=t.configuration;return Q(a)||o.dispatch($s(a)),{...o,get state(){return o.state}}}function Eu(e){return e.addReducers({configuration:Ys}),{disableAnalytics:er,enableAnalytics:tr,setOriginLevel2:rr,setOriginLevel3:nr,updateAnalyticsConfiguration:Gt,updateBasicConfiguration:Zt}}function xu(e){return e.addReducers({productRecommendations:Ks}),{getProductRecommendations:rs,setProductRecommendationsAdditionalFields:es,setProductRecommendationsBrandFilter:Xa,setProductRecommendationsCategoryFilter:Ga,setProductRecommendationsMaxNumberOfRecommendations:ts,setProductRecommendationsRecommenderId:Ka,setProductRecommendationsSkus:Za}}function Iu(e){return e.addReducers({context:Ws}),{addContext:mr,removeContext:vr,setContext:yr}}function Au(e){return e.addReducers({searchHub:Js}),{setSearchHub:$s}}function Ru(e){let t;return{subscribe(r){return r(),t=JSON.stringify(this.state),e.subscribe((()=>{(e=>{try{const r=JSON.stringify(e),n=t!==r;return t=r,n}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}})(this.state)&&r()}))},get state(){return{}}}}const ju={additionalFields:new te({required:!1,each:new Z({emptyAllowed:!1})}),skus:new te({required:!1,each:new Z({emptyAllowed:!1})}),maxNumberOfRecommendations:new B({required:!1,max:50,min:1,default:5})},ku=new U({id:new Z({required:!0,emptyAllowed:!1}),...ju}),Pu=(e,t={})=>{!function(e){e.addReducers({productRecommendations:Ks,configuration:Ys})}(e);const r=Ru(e),{dispatch:n}=e,i=Bt(e,ku,t.options,"buildBaseProductRecommendationsList");return n(Ka({id:i.id})),n(ts({number:i.maxNumberOfRecommendations})),i.additionalFields&&n(es({additionalFields:i.additionalFields})),i.skus&&n(Za({skus:i.skus})),{...r,setSkus(e){n(Za({skus:e}))},refresh(){n(rs())},get state(){const{skus:t,maxNumberOfRecommendations:r,recommendations:n,error:i,isLoading:o}=e.state.productRecommendations;return{skus:t,maxNumberOfRecommendations:r,recommendations:n,error:i,isLoading:o}}}};const Tu=new U({sku:new Z({required:!0,emptyAllowed:!1}),maxNumberOfRecommendations:ju.maxNumberOfRecommendations,additionalFields:ju.additionalFields}),Fu=(e,t)=>{const r=Bt(e,Tu,t.options,"buildFrequentlyBoughtTogetherList"),n=Pu(e,{...t,options:{maxNumberOfRecommendations:r.maxNumberOfRecommendations,additionalFields:r.additionalFields,skus:[r.sku],id:"frequentBought"}}),{setSkus:i,...o}=n;return{...o,setSku(e){i([e])},get state(){const{skus:e,...t}=n.state;return{...t,sku:e[0]}}}},_u=new U({...ju});function Mu(e,t){const r=Bt(e,_u,t.options,"buildCartRecommendationsList");return Pu(e,{...t,options:{...r,id:"cart"}})}const Vu=new U({...ju}),$u=(e,t)=>{const r=Bt(e,Vu,t.options,"buildFrequentlyViewedTogetherList");return Pu(e,{...t,options:{...r,id:"frequentViewed"}})},Du=new U({maxNumberOfRecommendations:ju.maxNumberOfRecommendations,additionalFields:ju.additionalFields}),Lu=(e,t={})=>{const r=Bt(e,Du,t.options,"buildPopularBoughtRecommendationsList"),n=Pu(e,{...t,options:{...r,id:"popularBought"}}),{setSkus:i,...o}=n;return{...o,get state(){const{skus:e,...t}=n.state;return{...t}}}},Nu=new U({maxNumberOfRecommendations:ju.maxNumberOfRecommendations,additionalFields:ju.additionalFields});function Uu(e,t={}){const r=Bt(e,Nu,t.options,"buildPopularViewedRecommendationsList"),n=Pu(e,{...t,options:{...r,id:"popularViewed"}}),{setSkus:i,...o}=n;return{...o,get state(){const{skus:e,...t}=n.state;return{...t}}}}const zu=new U({maxNumberOfRecommendations:ju.maxNumberOfRecommendations,additionalFields:ju.additionalFields});function Hu(e,t){const r=Bt(e,zu,t.options,"buildUserInterestRecommendationsList"),n=Pu(e,{...t,options:{...r,id:"user"}}),{setSkus:i,...o}=n;return{...o,get state(){const{skus:e,...t}=n.state;return{...t}}}}function Qu(e){!function(e){e.addReducers({context:Ws})}(e);const t=Ru(e),{dispatch:r}=e;return{...t,get state(){return{values:e.state.context.contextValues}},set(e){r(yr(e))},add(e,t){r(mr({contextKey:e,contextValue:t}))},remove(e){r(vr(e))}}}export{Mu as buildCartRecommendationsList,Qu as buildContext,Ru as buildController,Fu as buildFrequentlyBoughtTogetherList,$u as buildFrequentlyViewedTogetherList,Lu as buildPopularBoughtRecommendationsList,Uu as buildPopularViewedRecommendationsList,qu as buildProductRecommendationEngine,Hu as buildUserInterestRecommendationsList,Ou as getSampleProductRecommendationEngineConfiguration,Eu as loadConfigurationActions,Iu as loadContextActions,xu as loadProductRecommendationsActions,Au as loadSearchHubActions};
//# sourceMappingURL=headless.esm.js.map
